<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>The molecular basis of parallel adaptation tohighland climate in domesticated maize</title>
<!--Generated on Sun Oct 20 10:22:29 2013 by LaTeXML (version 0.7.9alpha) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on Revised manuscript for .-->

<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"/>
<link rel="stylesheet" href="LaTeXML.css" type="text/css"/>
<link rel="stylesheet" href="ltx-article.css" type="text/css"/>
<link rel="stylesheet" href="plr-style.css" type="text/css"/>
<script src="LaTeXML-maybeMathjax.js" type="text/javascript"/>
<script src="adjust-svg.js" type="text/javascript"/>
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<div class="ltx_document">
<h1 class="ltx_title ltx_title_document">The molecular basis of parallel adaptation to
<br class="ltx_break"/>highland climate in domesticated maize</h1>
<div class="ltx_date ltx_role_creation">Revised manuscript for <em class="ltx_emph">Genetics</em>, October 20, 2013</div>

<div class="ltx_creator ltx_role_author">
<div class="ltx_personname"><span class="ltx_text ltx_font_bold ltx_font_small">Shohei Takuno<math xmlns="http://www.w3.org/1998/Math/MathML" id="m1" class="ltx_Math" alttext="{}^{\ast}" display="inline"><semantics><msup><mi/><mo mathsize="normal" mathvariant="normal">&#x2217;</mo></msup><annotation encoding="application/x-tex">{}^{\ast}</annotation></semantics></math>, Peter Ralph<math xmlns="http://www.w3.org/1998/Math/MathML" id="m2" class="ltx_Math" display="inline" alttext="{}^{{\dagger},{\ddagger}}"><semantics><msup><mi/><mrow><mo mathvariant="normal" mathsize="normal">&#x2020;</mo><mo mathvariant="bold" mathsize="small">,</mo><mo mathsize="normal" mathvariant="normal">&#x2021;</mo></mrow></msup><annotation encoding="application/x-tex">{}^{{\dagger},{\ddagger}}</annotation></semantics></math>, Sofiane Mezmouk<math xmlns="http://www.w3.org/1998/Math/MathML" id="m3" class="ltx_Math" alttext="{}^{\ast}" display="inline"><semantics><msup><mi/><mo mathsize="normal" mathvariant="normal">&#x2217;</mo></msup><annotation encoding="application/x-tex">{}^{\ast}</annotation></semantics></math>, Kelly Swarts<math xmlns="http://www.w3.org/1998/Math/MathML" id="m4" class="ltx_Math" alttext="{}^{\S}" display="inline"><semantics><msup><mi/><mi mathsize="normal" mathvariant="normal">&#xA7;</mi></msup><annotation encoding="application/x-tex">{}^{\S}</annotation></semantics></math>, Rob J. Elshire<math xmlns="http://www.w3.org/1998/Math/MathML" id="m5" class="ltx_Math" alttext="{}^{\S}" display="inline"><semantics><msup><mi/><mi mathsize="normal" mathvariant="normal">&#xA7;</mi></msup><annotation encoding="application/x-tex">{}^{\S}</annotation></semantics></math>, Jeffrey C. Glaubitz<math xmlns="http://www.w3.org/1998/Math/MathML" id="m6" class="ltx_Math" alttext="{}^{\S}" display="inline"><semantics><msup><mi/><mi mathsize="normal" mathvariant="normal">&#xA7;</mi></msup><annotation encoding="application/x-tex">{}^{\S}</annotation></semantics></math>,
<br class="ltx_break"/>Edward S. Buckler<math xmlns="http://www.w3.org/1998/Math/MathML" id="m7" class="ltx_Math" display="inline" alttext="{}^{\S,\ast\ast}"><semantics><msup><mi/><mrow><mi mathvariant="normal" mathsize="normal">&#xA7;</mi><mo mathsize="small" mathvariant="bold">,</mo><mo mathvariant="normal" mathsize="normal">&#x2217;</mo><mo mathvariant="bold" mathsize="small">&#x2063;</mo><mo mathsize="normal" mathvariant="normal">&#x2217;</mo></mrow></msup><annotation encoding="application/x-tex">{}^{\S,\ast\ast}</annotation></semantics></math>, Matthew B. Hufford<math xmlns="http://www.w3.org/1998/Math/MathML" id="m8" class="ltx_Math" display="inline" alttext="{}^{\ast,{\dagger}{\dagger}}"><semantics><msup><mi/><mrow><mo mathsize="normal" mathvariant="normal">&#x2217;</mo><mo mathsize="small" mathvariant="bold">,</mo><mo mathvariant="normal" mathsize="normal">&#x2020;</mo><mo mathsize="small" mathvariant="bold">&#x2063;</mo><mo mathsize="normal" mathvariant="normal">&#x2020;</mo></mrow></msup><annotation encoding="application/x-tex">{}^{\ast,{\dagger}{\dagger}}</annotation></semantics></math>, and Jeffrey Ross-Ibarra<math xmlns="http://www.w3.org/1998/Math/MathML" id="m9" class="ltx_Math" alttext="{}^{\ast,{\ddagger}{\ddagger},}" display="inline"><semantics><msup><mi/><mrow><mo mathsize="normal" mathvariant="normal">&#x2217;</mo><mo mathvariant="normal" mathsize="normal">,</mo><mo mathvariant="normal" mathsize="normal">&#x2021;</mo><mo mathsize="normal" mathvariant="normal">&#x2021;</mo><mo mathvariant="normal" mathsize="normal">,</mo></mrow></msup><annotation encoding="application/x-tex">{}^{\ast,{\ddagger}{\ddagger},}</annotation></semantics></math>
<br class="ltx_break"/><span class="ltx_text ltx_font_sansserif ltx_font_medium"><math xmlns="http://www.w3.org/1998/Math/MathML" id="m10" class="ltx_Math" alttext="{}^{\ast}" display="inline"><semantics><msup><mi/><mo mathvariant="normal" mathsize="normal">&#x2217;</mo></msup><annotation encoding="application/x-tex">{}^{\ast}</annotation></semantics></math>Department of Plant Sciences, University of California, Davis, California 95616, USA,
<br class="ltx_break"/><math xmlns="http://www.w3.org/1998/Math/MathML" id="m11" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics><msup><mi/><mo mathvariant="normal" mathsize="normal">&#x2020;</mo></msup><annotation encoding="application/x-tex">{}^{\dagger}</annotation></semantics></math>Department of Evolution and Ecology, University of California, Davis, California 95616, USA,
<br class="ltx_break"/><math xmlns="http://www.w3.org/1998/Math/MathML" id="m12" class="ltx_Math" display="inline" alttext="{}^{\ddagger}"><semantics><msup><mi/><mo mathvariant="normal" mathsize="normal">&#x2021;</mo></msup><annotation encoding="application/x-tex">{}^{\ddagger}</annotation></semantics></math>Molecular and Computational Biology, University of Southern California,  Los Angeles,California 90089-0371, USA,
<br class="ltx_break"/><math xmlns="http://www.w3.org/1998/Math/MathML" id="m13" class="ltx_Math" display="inline" alttext="{}^{\S}"><semantics><msup><mi/><mi mathsize="normal" mathvariant="normal">&#xA7;</mi></msup><annotation encoding="application/x-tex">{}^{\S}</annotation></semantics></math>Institute for Genomic Diversity, Cornell University, Ithaca, New York 14853-2703, USA,
<br class="ltx_break"/><math xmlns="http://www.w3.org/1998/Math/MathML" id="m14" class="ltx_Math" display="inline" alttext="{}^{\ast\ast}"><semantics><msup><mi/><mrow><mo mathsize="normal" mathvariant="normal">&#x2217;</mo><mo mathsize="small">&#x2063;</mo><mo mathvariant="normal" mathsize="normal">&#x2217;</mo></mrow></msup><annotation encoding="application/x-tex">{}^{\ast\ast}</annotation></semantics></math>US Department of Agriculture &#x2013; Agriculture Research Service (USDA-ARS) <span class="ltx_text" style="color:#FF0000;">address</span>,
<br class="ltx_break"/><math xmlns="http://www.w3.org/1998/Math/MathML" id="m15" class="ltx_Math" display="inline" alttext="{}^{{\dagger}{\dagger}}"><semantics><msup><mi/><mrow><mo mathsize="normal" mathvariant="normal">&#x2020;</mo><mo mathsize="small">&#x2063;</mo><mo mathsize="normal" mathvariant="normal">&#x2020;</mo></mrow></msup><annotation encoding="application/x-tex">{}^{{\dagger}{\dagger}}</annotation></semantics></math>Department of Ecology, Evolution, and Organismal Biology, Iowa State University, Ames, Iowa 50011, USA,
<br class="ltx_break"/><math xmlns="http://www.w3.org/1998/Math/MathML" id="m16" class="ltx_Math" alttext="{}^{{\ddagger}{\ddagger}}" display="inline"><semantics><msup><mi/><mrow><mo mathsize="normal" mathvariant="normal">&#x2021;</mo><mo mathsize="small">&#x2063;</mo><mo mathvariant="normal" mathsize="normal">&#x2021;</mo></mrow></msup><annotation encoding="application/x-tex">{}^{{\ddagger}{\ddagger}}</annotation></semantics></math>The Center for Population Biology and the Genome Center, University of California, Davis, California 95616 , USA
<br class="ltx_break"/></span></span>
</div><span class="ltx_text ltx_font_sansserif ltx_font_small">
Corresponding author:  Department of Plant Sciences, University of California, Davis, California 95616, USA.
E-mail: </span><span class="ltx_text ltx_font_sansserif ltx_font_small">rossibarra@ucdavis.edu</span>
</div>
<div class="ltx_abstract"><h6>Abstract</h6>
<p class="ltx_p">Parallel adaptation is defined as the independent evolution of multiple species/subpopulations to similar environments via adaptive mutations in the same locus.
We investigate here the molecular basis of maize adaptation to highland climates in Mexico and South America using genome-wide SNP data.
Taking advantage of archaeological data on the arrival of maize to the highlands, we infer demographic models for both populations, identifying evidence of a strong bottleneck and rapid expansion in South America.
We use these models to then identify loci showing an excess of differentiation as a means of identifying putative targets of natural selection, and compare our results to expectations from recently developed theory on parallel adaptation.
In spite of similar morphologies, we see limited evidence of selection on quantitative traits, and, consistent with predictions across a wide array of parameter space, we see few SNPs showing signs of parallel adaptation.
Instead, we show that selection appears to have predominantly acted on standing genetic variation, and that introgression from wild teosinte populations appears to have played a role in adaptation in Mexican maize.
We discuss the significance of these results in the context of the molecular basis of adaptation to new environments.</p>
</div>
<div id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Introduction</h2>

<div id="Sx1.p1" class="ltx_para">
<p class="ltx_p">Parallel adaptation is a process in which multiple species or populations independently adapt to distinct regions with similar environments via mutations at the same loci <cite class="ltx_cite"/>.
Evolutionary genetic analysis of a wide range of species has provided evidence for multiple pathways to parallel adaptation. One such route occurs when identical mutations arise independently and fix via natural selection in multiple populations. In humans, for example, malaria resistance due to mutations from Glu to Val at the sixth codon of the <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx1.p1.m1" class="ltx_Math" display="inline" alttext="\beta"><semantics><mi>&#x3B2;</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>-globin gene has arisen independently on multiple unique haplotypes  <cite class="ltx_cite"/>.  Parallel adaptation can also be achieved when different mutations arise within the same locus and produce similar phenotypic effects.  Grain fragrance in rice appears to have evolved along these lines, as populations across East Asia have similar fragrances resulting from at least eight distinct loss-of-function alleles in the  <em class="ltx_emph">BADH2</em> gene <cite class="ltx_cite"/>.  Finally, parallel adaptation may arise from natural selection acting on standing genetic variation in an ancestral population.  In the three-spined stickleback, natural selection has repeatedly acted to reduce armor plating in independent colonizations of freshwater environments.  In most cases, adaptation in these populations took advantage of standing variation at the <em class="ltx_emph">Eda</em> locus in marine populations <cite class="ltx_cite"/>.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p class="ltx_p">We still know relatively little, however, about how common it is for parallel phenotypic evolution to be driven by parallel genetic changes
or the relative frequencies of these different routes of parallel adaptation.
Domesticated maize (<em class="ltx_emph">Zea mays</em> ssp. <em class="ltx_emph">mays</em>) provides an excellent opportunity to investigate the molecular basis of parallel adaptation.  Maize was domesticated from the wild teosinte <em class="ltx_emph">Zea mays</em> ssp. <em class="ltx_emph">parviglumis</em> (hereafter <em class="ltx_emph">parviglumis</em>) in the lowlands of southwest Mexico <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx1.p2.m1" class="ltx_Math" alttext="\sim" display="inline"><semantics><mo>&#x223C;</mo><annotation encoding="application/x-tex">\sim</annotation></semantics></math>9,000 years before present (BP) <cite class="ltx_cite"/>. After domestication, maize spread rapidly across the Americas, reaching the lowlands of South America and the high altitudes of the Mexican Central Plateau by <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx1.p2.m2" class="ltx_Math" display="inline" alttext="\sim"><semantics><mo>&#x223C;</mo><annotation encoding="application/x-tex">\sim</annotation></semantics></math>6,000 BP <cite class="ltx_cite"/>, and the Andean highlands <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx1.p2.m3" class="ltx_Math" alttext="\sim" display="inline"><semantics><mo>&#x223C;</mo><annotation encoding="application/x-tex">\sim</annotation></semantics></math>2,000 years later <cite class="ltx_cite"/>.
The transition from lowland to highland habitats spanned similar environmental gradients in Mexico and South America (Figure&#xA0;S1) and presented a host of novel challenges that commonly, if not universally, accompany highland adaptation including reduced temperature, increased ultraviolet radiation, and reduced partial pressure of atmospheric gases <cite class="ltx_cite"/>.</p>
</div>
<div id="Sx1.p3" class="ltx_para">
<p class="ltx_p">Common garden experiments in Mexico reveal that highland maize has successfully adapted to highland conditions <cite class="ltx_cite"/>, and phenotypic comparisons between Mexican and South American populations are suggestive of parallel adaptation.  Landraces from both populations share a number of phenotypes not found in lowland populations, including dense macrohairs <cite class="ltx_cite"/>, stem pigmentation <cite class="ltx_cite"/>, and biochemical response to UV radiation <cite class="ltx_cite"/>. Genetic analyses of maize landraces from across the Americas indicate that the two highland populations are independently derived from their respective lowland populations <cite class="ltx_cite"/>, so observed patterns of phenotypic similarity are not simply due to recent shared ancestry.
</p>
</div>
<div id="Sx1.p4" class="ltx_para">
<p class="ltx_p">Although there are no wild relatives of maize in South America, the teosinte <em class="ltx_emph">Zea mays</em> ssp. <em class="ltx_emph">mexicana</em> (hereafter <em class="ltx_emph">mexicana</em>) is native to the highlands of central Mexico, where it is thought to have occurred since at least the last glacial maximum <cite class="ltx_cite"/>. Phenotypic differences between <em class="ltx_emph">mexicana</em> and <em class="ltx_emph">parviglumis</em> mirror those between highland and lowland maize <cite class="ltx_cite"/> and population genetic analyses of the two subspecies reveal evidence of natural selection associated with altitudinal differences between <em class="ltx_emph">mexicana</em> and <em class="ltx_emph">parviglumis</em> <cite class="ltx_cite"/>.  Landraces in the highlands of Mexico are often found in sympatry with  <em class="ltx_emph">mexicana</em>, and gene flow between the two is thought to have contributed to maize adaptation to the highlands <cite class="ltx_cite"/>.</p>
</div>
<div id="Sx1.p5" class="ltx_para">
<p class="ltx_p">In this paper we set out to address a number of questions regarding highland adaptation in maize: What is the genetic architecture of highland adaptation? Do maize populations in South America show evidence of parallel adaptation when compared with highland maize from Mexico? How do observed patterns of parallel adaptation compare to theoretical expectations?
We make use of SNP genotyping to characterize patterns of natural selection in highland maize and compare our results to expectations from theoretical models of parallel adaptation.  We find evidence supporting unique demographic histories in the highlands of Mexico and South America, a predominance of independent versus parallel adaptation, and contributions of standing variation and introgression from wild relatives to highland adaptation in maize.

</p>
</div>
<div id="Sx1.F1" class="ltx_figure"><object data="fig/Fig2.svg" id="Sx1.F1.g1" class="ltx_graphics ltx_centering" width="475" height="310" alt=""/>
<div class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure&#xA0;1: </span>(A) Sampling locations of landraces.  Red, blue, yellow and light blue dots represent Mexico lowland, Mexico highland, S. America lowland and S. America highland populations, respectively.  (B) Results of <span class="ltx_text ltx_font_sansserif">STRUCTURE</span> analysis of the maizeSNP50 SNPs with <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx1.F1.m3" class="ltx_Math" display="inline" alttext="K=2\sim 4"><semantics><mrow><mi>K</mi><mo>=</mo><mn>2</mn><mo>&#x223C;</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">K=2\sim 4</annotation></semantics></math>.  The top panel shows the altitude, ranging from 0 to 4,000 m on the <em class="ltx_emph">y</em>-axes.  The colors in <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx1.F1.m4" class="ltx_Math" alttext="K=4" display="inline"><semantics><mrow><mi>K</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">K=4</annotation></semantics></math> correspond to those in panel (A).    </div>
</div>
</div>
<div id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Materials and Methods</h2>

<div id="Sx2.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Materials and DNA extraction</h3>

<div id="Sx2.SSx1.p1" class="ltx_para">
<p class="ltx_p">We included one individual from each of 94 open-pollinated landrace maize accessions from high and low elevation sites in Mexico and South America (Table&#xA0;S1).  Accessions were provided by the USDA germplasm repository or kindly donated by Major Goodman (North Carolina State University).
Sampling locations are shown in Figure&#xA0;<a href="#Sx1.F1" title="Figure&#xA0;1 &#x2023; Introduction &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>A (see also Table&#xA0;S1).
Landraces sampled from altitudes <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx1.p1.m1" class="ltx_Math" alttext="&lt;" display="inline"><semantics><mo>&lt;</mo><annotation encoding="application/x-tex">&lt;</annotation></semantics></math>1,700 m were considered lowland, while accessions from <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx1.p1.m2" class="ltx_Math" display="inline" alttext="&gt;"><semantics><mo>&gt;</mo><annotation encoding="application/x-tex">&gt;</annotation></semantics></math>1,700 m were considered highland (Table&#xA0;S1).
Seeds were germinated on filter paper following fungicide treatment and grown in standard potting mix.  Leaf tips were harvested from plants at the five leaf stage.  Following storage at <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx1.p1.m3" class="ltx_Math" display="inline" alttext="-80{}^{\circ}"><semantics><mrow><mo>-</mo><mn>80</mn><msup><mi/><mo>&#x2218;</mo></msup></mrow><annotation encoding="application/x-tex">-80{}^{\circ}</annotation></semantics></math>C overnight, leaf tips were lyophilized for 48 hours.  Tissue was then homogenized with a Mini-Beadbeater-8 (BioSpec Products, Inc., Bartlesville, OK, USA).  DNA was extracted using a modified CTAB protocol <cite class="ltx_cite"/>.  The quality of DNA was ensured using methods described in <cite class="ltx_cite"/>.
</p>
</div>
</div>
<div id="Sx2.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">SNP data</h3>

<div id="Sx2.SSx2.p1" class="ltx_para">
<p class="ltx_p">We used the maize B73 genome sequence RefGen version 2 as a reference <cite class="ltx_cite"/>.
The filtered gene set (release 5b.60) was retrieved from MaizeSequence.org for SNP annotations.
We excluded genes annotated as transposable elements (84) and pseudogenes (323) from the filtered gene set, resulting in a total of 38,842 genes.
</p>
</div>
<div id="Sx2.SSx2.p2" class="ltx_para">
<p class="ltx_p">We generated two complementary SNP data sets for the sampled maize landraces.
The first set was generated using the Illumina MaizeSNP50 BeadChip platform, including 56,110
SNPs <cite class="ltx_cite"/>.  SNPs were clustered with the default algorithm of the GenomeStudio Genotyping Module v1.0 (Illumina Inc., San Diego, CA, USA).
Clustering for each SNP was then visually inspected and manually adjusted.
These data are referred to as &#x201D;MaizeSNP50&#x201D; hereafter.
MaizeSNP50 data have high reproducibility and a low proportion of missing data but are subject to ascertainment bias.
This array contains SNPs discovered in five ascertainment schemes <cite class="ltx_cite"/>; however, the vast majority of SNPs come from two panels: the Syngenta set (14,810 SNPs), derived from polymorphisms distinguishing the parents of the IBM population (the maize lines B73 and Mo17), and the Panzea set, including 40,594 SNPs identified during sequencing of the 25 parents of the NAM population.</p>
</div>
<div id="Sx2.SSx2.p3" class="ltx_para">
<p class="ltx_p">The second data set was generated utilizing high-throughput Illumina sequencing data in a method referred to as <span class="ltx_text" style="text-decoration:underline;">g</span>enotyping-<span class="ltx_text" style="text-decoration:underline;">b</span>y-<span class="ltx_text" style="text-decoration:underline;">s</span>equencing (GBS).  <span class="ltx_text" style="color:#FF0000;">Kelly is up for details.</span>
Average coverage was relatively low <span class="ltx_text" style="color:#FF0000;">(XXX)</span>, likely resulting in heterozygotes often being miscalled as homozygotes.  However, this data set is relatively free from ascertainment bias.
GBS data were obtained for a subset of 87 of the landrace accessions (Table&#xA0;S1).</p>
</div>
<div id="Sx2.SSx2.p4" class="ltx_para">
<p class="ltx_p">To assess data quality, we compared genotypes at the 7,197 SNPs that overlap between the MaizeSNP50 and GBS data sets.
Excluding missing data, we compared 229,937 genotypes.
While only 0.8% of 173,670 homozygous loci in the MaizeSNP50 data set differed from GBS genotypes, 88.6% of 56,267 MaizeSNP50 heterozygotes had different genotypes in the GBS data, being homozygous in nearly all cases.
Despite an extremely high heterozygote error rate, our GBS data should be informative given the high correlation in allele frequencies between data sets (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx2.p4.m1" class="ltx_Math" display="inline" alttext="r=0.89"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0.89</mn></mrow><annotation encoding="application/x-tex">r=0.89</annotation></semantics></math>; Figure&#xA0;SX <span class="ltx_text" style="color:#FF0000;">change after finishing intro and results</span>) and a lack of major allele or reference bias (data not shown).</p>
</div>
</div>
<div id="Sx2.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Structure analysis</h3>

<div id="Sx2.SSx3.p1" class="ltx_para">
<p class="ltx_p">We performed a <span class="ltx_text ltx_font_sansserif">STRUCTURE</span> analysis <cite class="ltx_cite"/> using  synonymous and noncoding SNPs from the MaizeSNP50 data.
We assumed free recombination between SNPs without missing data and randomly pruned SNPs closer than 10 kb (alternative distances were tried with nearly identical results).
We excluded SNPs in which the number of heterozygous individuals exceeded homozygotes and where the <em class="ltx_emph">P</em>-value for departure from Hardy-Weinberg Equilibrium (HWE) based on a <em class="ltx_emph">G</em>-test was smaller than 0.5% using all individuals.
Following these data thinning measures, 17,013 biallelic SNPs remained.
We conducted three replicate runs of <span class="ltx_text ltx_font_sansserif">STRUCTURE</span> using the correlated allele frequency model with admixture for <em class="ltx_emph">K</em> = 2<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx3.p1.m1" class="ltx_Math" alttext="\sim" display="inline"><semantics><mo>&#x223C;</mo><annotation encoding="application/x-tex">\sim</annotation></semantics></math>6 populations, a burn-in length of 50,000 iterations and a run length of 100,000 iterations.
Results across replicates were nearly identical.</p>
</div>
</div>
<div id="Sx2.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Demographic inference</h3>

<div id="Sx2.SSx4.p1" class="ltx_para">
<p class="ltx_p">We tested three demographic models in which maize was differentiated into high- and lowland populations subsequent to domestication (Figure&#xA0;<a href="#Sx2.F2" title="Figure&#xA0;2 &#x2023; Demographic inference &#x2023; Materials and Methods &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).
Observed joint frequency distributions (JFDs) were calculated using the GBS data set due to its lower level of ascertainment bias.
A subset of silent SNPs were utilized that had <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.p1.m1" class="ltx_Math" alttext="\geq 15" display="inline"><semantics><mrow><mi/><mo>&#x2265;</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">\geq 15</annotation></semantics></math> individuals without missing data in both low- and highland populations and did not violate HWE.
A HWE cut-off of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.p1.m2" class="ltx_Math" alttext="P&lt;0.005" display="inline"><semantics><mrow><mi>P</mi><mo>&lt;</mo><mn>0.005</mn></mrow><annotation encoding="application/x-tex">P&lt;0.005</annotation></semantics></math> was used for each subpopulation due to our under-calling of heterozygotes.
In total, we included 18,745 silent SNPs for the Mexican populations in Models IA and IB, 14,508 for the South American populations in Model I and 11,305 for the Mexican lowland population and the South American populations in Model II.
We obtained similar results under more or less stringent thresholds for significance (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.p1.m3" class="ltx_Math" display="inline" alttext="P&lt;0.05\sim 0.0005"><semantics><mrow><mi>P</mi><mo>&lt;</mo><mn>0.05</mn><mo>&#x223C;</mo><mn>0.0005</mn></mrow><annotation encoding="application/x-tex">P&lt;0.05\sim 0.0005</annotation></semantics></math>; data not shown), though the number of SNPs was very small at <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.p1.m4" class="ltx_Math" display="inline" alttext="P&lt;0.05"><semantics><mrow><mi>P</mi><mo>&lt;</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">P&lt;0.05</annotation></semantics></math>.
Demographic parameters were inferred using the software <span class="ltx_text ltx_font_sansserif">dadi</span> <cite class="ltx_cite"/>,
which uses a diffusion method to calculate an expected JFD
and evaluates the likelihood of the data using a multinomial assumption.</p>
</div>
<div id="Sx2.F2" class="ltx_figure"><object data="fig/Fig3.svg" id="Sx2.F2.g1" class="ltx_graphics ltx_centering" width="297" height="211" alt=""/>
<div class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure&#xA0;2: </span> Demographic models of maize low- and highland populations.  Parameters provided in bold were estimated in this study.  See text for details.
</div>
</div>
<div id="Sx2.SSx4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection"><span class="ltx_tag ltx_tag_subsubsection">0.0.1 </span>Model IA</h4>

<div id="Sx2.SSx4.SSS1.p1" class="ltx_para">
<p class="ltx_p">This model is applied to the Mexico and SA populations.
We assume the ancestral diploid population representing <em class="ltx_emph">parviglumis</em> follows a standard Wright-Fisher model with constant size.  The size of the ancestral population is denoted by <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m1" class="ltx_Math" alttext="N_{A}" display="inline"><semantics><msub><mi>N</mi><mi>A</mi></msub><annotation encoding="application/x-tex">N_{A}</annotation></semantics></math>.
At <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m2" class="ltx_Math" display="inline" alttext="t_{D}"><semantics><msub><mi>t</mi><mi>D</mi></msub><annotation encoding="application/x-tex">t_{D}</annotation></semantics></math> generations ago, the bottleneck event begins at domestication, and at <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m3" class="ltx_Math" alttext="t_{E}" display="inline"><semantics><msub><mi>t</mi><mi>E</mi></msub><annotation encoding="application/x-tex">t_{E}</annotation></semantics></math> generations ago, the bottleneck ends.  The population size and duration of the bottleneck are denoted by <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m4" class="ltx_Math" display="inline" alttext="N_{B}"><semantics><msub><mi>N</mi><mi>B</mi></msub><annotation encoding="application/x-tex">N_{B}</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m5" class="ltx_Math" alttext="t_{B}=t_{D}-t_{E}" display="inline"><semantics><mrow><msub><mi>t</mi><mi>B</mi></msub><mo>=</mo><mrow><msub><mi>t</mi><mi>D</mi></msub><mo>-</mo><msub><mi>t</mi><mi>E</mi></msub></mrow></mrow><annotation encoding="application/x-tex">t_{B}=t_{D}-t_{E}</annotation></semantics></math>, respectively.  The population size recovers to <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m6" class="ltx_Math" display="inline" alttext="N_{C}=\alpha N_{A}"><semantics><mrow><msub><mi>N</mi><mi>C</mi></msub><mo>=</mo><mrow><mi>&#x3B1;</mi><mo>&#x2062;</mo><msub><mi>N</mi><mi>A</mi></msub></mrow></mrow><annotation encoding="application/x-tex">N_{C}=\alpha N_{A}</annotation></semantics></math> in the lowlands.
Then, the highland population is differentiated from the lowland population at <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m7" class="ltx_Math" alttext="t_{F}" display="inline"><semantics><msub><mi>t</mi><mi>F</mi></msub><annotation encoding="application/x-tex">t_{F}</annotation></semantics></math> generations ago.  The size of the low- and highland populations at time <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m8" class="ltx_Math" display="inline" alttext="t_{F}"><semantics><msub><mi>t</mi><mi>F</mi></msub><annotation encoding="application/x-tex">t_{F}</annotation></semantics></math> is determined by a parameter, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m9" class="ltx_Math" display="inline" alttext="\beta"><semantics><mi>&#x3B2;</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math> such that the population is divided by <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m10" class="ltx_Math" display="inline" alttext="\beta N_{C}"><semantics><mrow><mi>&#x3B2;</mi><mo>&#x2062;</mo><msub><mi>N</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">\beta N_{C}</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m11" class="ltx_Math" display="inline" alttext="(1-\beta)N_{C}"><semantics><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mi>&#x3B2;</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><msub><mi>N</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">(1-\beta)N_{C}</annotation></semantics></math>.
We assume that the population size in the lowlands is constant but that the highland population experiences exponential expansion after divergence: its current population size is <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m12" class="ltx_Math" display="inline" alttext="\gamma"><semantics><mi>&#x3B3;</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math> times larger than that at <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS1.p1.m13" class="ltx_Math" alttext="t_{F}" display="inline"><semantics><msub><mi>t</mi><mi>F</mi></msub><annotation encoding="application/x-tex">t_{F}</annotation></semantics></math>.  
<br class="ltx_break"/></p>
</div>
</div>
<div id="Sx2.SSx4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection"><span class="ltx_tag ltx_tag_subsubsection">0.0.2 </span>Model IB</h4>

<div id="Sx2.SSx4.SSS2.p1" class="ltx_para">
<p class="ltx_p">We expand Model IA for the Mexico populations.  We incorporate admixture from <em class="ltx_emph">mexicana</em> to the highland Mexican maize population.  The time of differentiation between <em class="ltx_emph">parviglumis</em> and <em class="ltx_emph">mexicana</em> occurs at <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS2.p1.m1" class="ltx_Math" display="inline" alttext="t_{mex}"><semantics><msub><mi>t</mi><mrow><mi>m</mi><mo>&#x2062;</mo><mi>e</mi><mo>&#x2062;</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">t_{mex}</annotation></semantics></math> generations ago.  The size of the <em class="ltx_emph">mexicana</em> population is denoted by <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS2.p1.m2" class="ltx_Math" display="inline" alttext="N_{mex}"><semantics><msub><mi>N</mi><mrow><mi>m</mi><mo>&#x2062;</mo><mi>e</mi><mo>&#x2062;</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">N_{mex}</annotation></semantics></math> and this size is assumed to be constant.  At <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS2.p1.m3" class="ltx_Math" alttext="t_{F}" display="inline"><semantics><msub><mi>t</mi><mi>F</mi></msub><annotation encoding="application/x-tex">t_{F}</annotation></semantics></math> generations ago, the Mexico highland population is derived from the Mexico lowland population and admixture with <em class="ltx_emph">mexicana</em>.  The proportion of admixture with <em class="ltx_emph">mexicana</em> is denoted by <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS2.p1.m4" class="ltx_Math" alttext="P_{mex}" display="inline"><semantics><msub><mi>P</mi><mrow><mi>m</mi><mo>&#x2062;</mo><mi>e</mi><mo>&#x2062;</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">P_{mex}</annotation></semantics></math>.  
<br class="ltx_break"/></p>
</div>
</div>
<div id="Sx2.SSx4.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection"><span class="ltx_tag ltx_tag_subsubsection">0.0.3 </span>Model II</h4>

<div id="Sx2.SSx4.SSS3.p1" class="ltx_para">
<p class="ltx_p">The final model is for the Mexico lowland, SA lowland and SA highland populations.  This model was used for simulating SNPs with ascertainment bias (see below).  At time <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p1.m1" class="ltx_Math" display="inline" alttext="t_{F}"><semantics><msub><mi>t</mi><mi>F</mi></msub><annotation encoding="application/x-tex">t_{F}</annotation></semantics></math>, the Mexico and SA lowland populations are differentiated, and the sizes of populations after splitting are determined by <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p1.m2" class="ltx_Math" display="inline" alttext="\beta_{1}"><semantics><msub><mi>&#x3B2;</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\beta_{1}</annotation></semantics></math>.  At time <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p1.m3" class="ltx_Math" display="inline" alttext="t_{G}"><semantics><msub><mi>t</mi><mi>G</mi></msub><annotation encoding="application/x-tex">t_{G}</annotation></semantics></math>, SA lowland and highland populations are differentiated, and the sizes of populations at this time are determined by <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p1.m4" class="ltx_Math" alttext="\beta_{2}" display="inline"><semantics><msub><mi>&#x3B2;</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\beta_{2}</annotation></semantics></math>.  As in Model IA, the SA highland population is assumed to experience population growth with the parameter, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p1.m5" class="ltx_Math" display="inline" alttext="\gamma"><semantics><mi>&#x3B3;</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>.
<br class="ltx_break"/></p>
</div>
<div id="Sx2.F3" class="ltx_figure"><object data="fig/Fig4.svg" id="Sx2.F3.g1" class="ltx_graphics ltx_centering" width="297" height="341" alt=""/>
<div class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure&#xA0;3: </span>Observed and expected joint distributions of minor allele frequencies in low- and highland populations in (A) Mexico and (B) S. America. </div>
</div>
<div id="Sx2.SSx4.SSS3.p2" class="ltx_para">
<p class="ltx_p">Estimates of a number of our model parameters were available from previous work.
<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m1" class="ltx_Math" alttext="N_{A}" display="inline"><semantics><msub><mi>N</mi><mi>A</mi></msub><annotation encoding="application/x-tex">N_{A}</annotation></semantics></math> was determined using estimates of the composite parameter <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m2" class="ltx_Math" alttext="4N_{A}\mu" display="inline"><semantics><mrow><mn>4</mn><mo>&#x2062;</mo><msub><mi>N</mi><mi>A</mi></msub><mo>&#x2062;</mo><mi>&#x3BC;</mi></mrow><annotation encoding="application/x-tex">4N_{A}\mu</annotation></semantics></math> and a separate estimate of mutation rate, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m3" class="ltx_Math" alttext="\mu" display="inline"><semantics><mi>&#x3BC;</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>, per site per generation.  <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m4" class="ltx_Math" alttext="4N_{A}\mu" display="inline"><semantics><mrow><mn>4</mn><mo>&#x2062;</mo><msub><mi>N</mi><mi>A</mi></msub><mo>&#x2062;</mo><mi>&#x3BC;</mi></mrow><annotation encoding="application/x-tex">4N_{A}\mu</annotation></semantics></math> was estimated in <em class="ltx_emph">parviglumis</em> to be <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m5" class="ltx_Math" alttext="\sim" display="inline"><semantics><mo>&#x223C;</mo><annotation encoding="application/x-tex">\sim</annotation></semantics></math>0.018  <cite class="ltx_cite"/>.
The mutation rate in maize has been estimated to be <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m6" class="ltx_Math" alttext="2.9\sim 3.3\times 10^{-8}" display="inline"><semantics><mrow><mn>2.9</mn><mo>&#x223C;</mo><mrow><mn>3.3</mn><mo>&#xD7;</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>8</mn></mrow></msup></mrow></mrow><annotation encoding="application/x-tex">2.9\sim 3.3\times 10^{-8}</annotation></semantics></math>, so we assume <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m7" class="ltx_Math" display="inline" alttext="\mu=3\times 10^{-8}"><semantics><mrow><mi>&#x3BC;</mi><mo>=</mo><mrow><mn>3</mn><mo>&#xD7;</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>8</mn></mrow></msup></mrow></mrow><annotation encoding="application/x-tex">\mu=3\times 10^{-8}</annotation></semantics></math> <cite class="ltx_cite"/>.
Thus, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m8" class="ltx_Math" display="inline" alttext="N_{A}"><semantics><msub><mi>N</mi><mi>A</mi></msub><annotation encoding="application/x-tex">N_{A}</annotation></semantics></math> was set to <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m9" class="ltx_Math" display="inline" alttext="0.018/4/(3\times 10^{-8})=150,000"><semantics><mrow><mrow><mn>0.018</mn><mo>/</mo><mn>4</mn><mo>/</mo><mrow><mo>(</mo><mrow><mn>3</mn><mo>&#xD7;</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>8</mn></mrow></msup></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mn>150</mn><mo>,</mo><mn>000</mn></mrow></mrow><annotation encoding="application/x-tex">0.018/4/(3\times 10^{-8})=150,000</annotation></semantics></math>.
The severity of the domestication bottleneck is represented by <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m10" class="ltx_Math" display="inline" alttext="k=N_{B}/t_{B}"><semantics><mrow><mi>k</mi><mo>=</mo><mrow><msub><mi>N</mi><mi>B</mi></msub><mo>/</mo><msub><mi>t</mi><mi>B</mi></msub></mrow></mrow><annotation encoding="application/x-tex">k=N_{B}/t_{B}</annotation></semantics></math> <cite class="ltx_cite"/>, and following <cite class="ltx_cite"/> we assumed <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m11" class="ltx_Math" alttext="k=2.45" display="inline"><semantics><mrow><mi>k</mi><mo>=</mo><mn>2.45</mn></mrow><annotation encoding="application/x-tex">k=2.45</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m12" class="ltx_Math" display="inline" alttext="t_{B}=1,000"><semantics><mrow><msub><mi>t</mi><mi>B</mi></msub><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mn>000</mn></mrow></mrow><annotation encoding="application/x-tex">t_{B}=1,000</annotation></semantics></math> generations.
Taking into account archaeological evidence <cite class="ltx_cite"/>, we assume <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m13" class="ltx_Math" display="inline" alttext="t_{D}=9,000"><semantics><mrow><msub><mi>t</mi><mi>D</mi></msub><mo>=</mo><mrow><mn>9</mn><mo>,</mo><mn>000</mn></mrow></mrow><annotation encoding="application/x-tex">t_{D}=9,000</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m14" class="ltx_Math" alttext="t_{E}=8,000" display="inline"><semantics><mrow><msub><mi>t</mi><mi>E</mi></msub><mo>=</mo><mrow><mn>8</mn><mo>,</mo><mn>000</mn></mrow></mrow><annotation encoding="application/x-tex">t_{E}=8,000</annotation></semantics></math>.
We further assumed <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m15" class="ltx_Math" display="inline" alttext="t_{F}=6,000"><semantics><mrow><msub><mi>t</mi><mi>F</mi></msub><mo>=</mo><mrow><mn>6</mn><mo>,</mo><mn>000</mn></mrow></mrow><annotation encoding="application/x-tex">t_{F}=6,000</annotation></semantics></math> for Mexican populations in Models IA and II <cite class="ltx_cite"/>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m16" class="ltx_Math" alttext="t_{F}=4,000" display="inline"><semantics><mrow><msub><mi>t</mi><mi>F</mi></msub><mo>=</mo><mrow><mn>4</mn><mo>,</mo><mn>000</mn></mrow></mrow><annotation encoding="application/x-tex">t_{F}=4,000</annotation></semantics></math> for South American populations in Model lI <cite class="ltx_cite"/>, and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m17" class="ltx_Math" alttext="t_{mex}=60,000" display="inline"><semantics><mrow><msub><mi>t</mi><mrow><mi>m</mi><mo>&#x2062;</mo><mi>e</mi><mo>&#x2062;</mo><mi>x</mi></mrow></msub><mo>=</mo><mrow><mn>60</mn><mo>,</mo><mn>000</mn></mrow></mrow><annotation encoding="application/x-tex">t_{mex}=60,000</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m18" class="ltx_Math" display="inline" alttext="N_{mex}=160,000"><semantics><mrow><msub><mi>N</mi><mrow><mi>m</mi><mo>&#x2062;</mo><mi>e</mi><mo>&#x2062;</mo><mi>x</mi></mrow></msub><mo>=</mo><mrow><mn>160</mn><mo>,</mo><mn>000</mn></mrow></mrow><annotation encoding="application/x-tex">N_{mex}=160,000</annotation></semantics></math> <cite class="ltx_cite"/>, and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m19" class="ltx_Math" alttext="P_{mex}=0.2" display="inline"><semantics><mrow><msub><mi>P</mi><mrow><mi>m</mi><mo>&#x2062;</mo><mi>e</mi><mo>&#x2062;</mo><mi>x</mi></mrow></msub><mo>=</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">P_{mex}=0.2</annotation></semantics></math> <cite class="ltx_cite"/> for Model IB.
For both Models IA and IB, we inferred three parameters (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m20" class="ltx_Math" display="inline" alttext="\alpha"><semantics><mi>&#x3B1;</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m21" class="ltx_Math" display="inline" alttext="\beta"><semantics><mi>&#x3B2;</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m22" class="ltx_Math" alttext="\gamma" display="inline"><semantics><mi>&#x3B3;</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>), and, for Model II, we fixed <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m23" class="ltx_Math" display="inline" alttext="t_{F}=6,000"><semantics><mrow><msub><mi>t</mi><mi>F</mi></msub><mo>=</mo><mrow><mn>6</mn><mo>,</mo><mn>000</mn></mrow></mrow><annotation encoding="application/x-tex">t_{F}=6,000</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m24" class="ltx_Math" alttext="t_{G}=4,000" display="inline"><semantics><mrow><msub><mi>t</mi><mi>G</mi></msub><mo>=</mo><mrow><mn>4</mn><mo>,</mo><mn>000</mn></mrow></mrow><annotation encoding="application/x-tex">t_{G}=4,000</annotation></semantics></math> <cite class="ltx_cite"/> and estimated the remaining four parameters (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m25" class="ltx_Math" display="inline" alttext="\alpha"><semantics><mi>&#x3B1;</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m26" class="ltx_Math" alttext="\beta_{1}" display="inline"><semantics><msub><mi>&#x3B2;</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\beta_{1}</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m27" class="ltx_Math" alttext="\beta_{2}" display="inline"><semantics><msub><mi>&#x3B2;</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\beta_{2}</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx4.SSS3.p2.m28" class="ltx_Math" display="inline" alttext="\gamma"><semantics><mi>&#x3B3;</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>).</p>
</div>
</div>
</div>
<div id="Sx2.SSx5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Differentiation between low- and highland populations</h3>

<div id="Sx2.SSx5.p1" class="ltx_para">
<p class="ltx_p">We used our inferred demographic model to generate a null distribution of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx5.p1.m1" class="ltx_Math" alttext="F_{ST}" display="inline"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> via simulation using the software <span class="ltx_text ltx_font_sansserif">ms</span> <cite class="ltx_cite"/>.
The command line options for <span class="ltx_text ltx_font_sansserif">ms</span> are provided in Table&#xA0;S4.  Generating the null distribution of differentiation for the MaizeSNP50 data requires accounting for ascertainment bias. Evaluation of genetic clustering in our data (not shown) coincides with previous work <cite class="ltx_cite"/> in suggesting that the two lines most important in the ascertainment panel are most closely related to Mexican lowland maize.
We thus added two additional individuals to the Mexican lowland population and generated our null distribution using only SNPs for which the two individuals had different alleles. For model IA in South America we added two individuals at time <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx5.p1.m2" class="ltx_Math" display="inline" alttext="t_{F}"><semantics><msub><mi>t</mi><mi>F</mi></msub><annotation encoding="application/x-tex">t_{F}</annotation></semantics></math> to the ancestral population of the South American low- and highland populations because the Mexican lowland population was not incorporated into this model. For each combination of sample sizes in low- and highland populations, we generated <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx5.p1.m3" class="ltx_Math" display="inline" alttext="10^{7}"><semantics><msup><mn>10</mn><mn>7</mn></msup><annotation encoding="application/x-tex">10^{7}</annotation></semantics></math> <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx5.p1.m4" class="ltx_Math" alttext="F_{ST}" display="inline"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> values and used these as a null distribution in order to evaluate our data.   We calculated <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx5.p1.m5" class="ltx_Math" alttext="F_{ST}" display="inline"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> values for all SNPs that had <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx5.p1.m6" class="ltx_Math" alttext="\geq 10" display="inline"><semantics><mrow><mi/><mo>&#x2265;</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\geq 10</annotation></semantics></math> individuals with no missing data in all four populations and showed no departure from HWE at the 0.5% (GBS) or 5% (MaizeSNP50) level.</p>
</div>
</div>
<div id="Sx2.SSx6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Haplotype scoring test</h3>

<div id="Sx2.SSx6.p1" class="ltx_para">
<p class="ltx_p">We performed a <span class="ltx_text" style="text-decoration:underline;">p</span>airwise <span class="ltx_text" style="text-decoration:underline;">h</span>aplotype <span class="ltx_text" style="text-decoration:underline;">s</span>coring (PHS) test to detect further evidence of selection, following <cite class="ltx_cite"/>.
To conduct this test, we first imputed and phased the combined SNP data (both GBS and MaizeSNP50) using the <span class="ltx_text ltx_font_sansserif">fastphase</span> software version 1.4.0 <cite class="ltx_cite"/>.
As a reference for phasing, we used data (excluding heterozygous SNPs) from an Americas-wide sample of 23 partially inbred landraces that were included in the Hapmap v2 data set  <cite class="ltx_cite"/>.
<span class="ltx_text ltx_font_sansserif">fastphase</span> was run with default parameter settings.  PHS was calculated for an allele <em class="ltx_emph">A</em> at position <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p1.m1" class="ltx_Math" alttext="x" display="inline"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> by</p>
</div>
<div id="Sx2.SSx6.p2" class="ltx_para">
<table id="Sx2.E1" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.E1.m1" class="ltx_Math" alttext="\begin{array}[]{l}\displaystyle{PHS_{x_{A}}=\sum^{p-1}_{i=1}\sum^{p}_{j=i+1}Z_%&#10;{ijx}/\Bigl(\begin{array}[]{c}p\\&#10;2\\&#10;\end{array}\Bigr)-\sum^{n-1}_{i=1}\sum^{n}_{j=i+1}Z_{ijx}/\Bigl(\begin{array}[%&#10;]{c}n\\&#10;2\\&#10;\end{array}\Bigr)}\end{array}\textrm{,}" display="block"><semantics><mrow><mtable rowspacing="0.2ex" columnspacing="0.4em"><mtr><mtd columnalign="left"><mrow><mrow><mi>P</mi><mo>&#x2062;</mo><mi>H</mi><mo>&#x2062;</mo><msub><mi>S</mi><msub><mi>x</mi><mi>A</mi></msub></msub></mrow><mo>=</mo><mrow><mrow><munderover><mo movablelimits="false">&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><munderover><mo movablelimits="false">&#x2211;</mo><mrow><mi>j</mi><mo>=</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></mrow><mi>p</mi></munderover><mrow><msub><mi>Z</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi><mo>&#x2062;</mo><mi>x</mi></mrow></msub><mo>/</mo><mrow><mo>(</mo><mtable rowspacing="0.2ex" columnspacing="0.4em"><mtr><mtd columnalign="center"><mi>p</mi></mtd></mtr><mtr><mtd columnalign="center"><mn>2</mn></mtd></mtr></mtable><mo>)</mo></mrow></mrow></mrow></mrow><mo>-</mo><mrow><munderover><mo movablelimits="false">&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><munderover><mo movablelimits="false">&#x2211;</mo><mrow><mi>j</mi><mo>=</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></mrow><mi>n</mi></munderover><mrow><msub><mi>Z</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi><mo>&#x2062;</mo><mi>x</mi></mrow></msub><mo>/</mo><mrow><mo>(</mo><mtable rowspacing="0.2ex" columnspacing="0.4em"><mtr><mtd columnalign="center"><mi>n</mi></mtd></mtr><mtr><mtd columnalign="center"><mn>2</mn></mtd></mtr></mtable><mo>)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><mo>&#x2062;</mo><mtext>,</mtext></mrow><annotation encoding="application/x-tex">\begin{array}[]{l}\displaystyle{PHS_{x_{A}}=\sum^{p-1}_{i=1}\sum^{p}_{j=i+1}Z_%
{ijx}/\Bigl(\begin{array}[]{c}p\\
2\\
\end{array}\Bigr)-\sum^{n-1}_{i=1}\sum^{n}_{j=i+1}Z_{ijx}/\Bigl(\begin{array}[%
]{c}n\\
2\\
\end{array}\Bigr)}\end{array}\textrm{,}</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(1)</span></td></tr>
</table>
</div>
<div id="Sx2.SSx6.p3" class="ltx_para">
<p class="ltx_p">where <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p3.m1" class="ltx_Math" alttext="n" display="inline"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> is sample size of haploids, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p3.m2" class="ltx_Math" alttext="p" display="inline"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>  is the number of haploids carrying the allele <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p3.m3" class="ltx_Math" alttext="A" display="inline"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> at position <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p3.m4" class="ltx_Math" display="inline" alttext="x"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>, and</p>
</div>
<div id="Sx2.SSx6.p4" class="ltx_para">
<table id="Sx2.E2" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_align_center"><math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.E2.m1" class="ltx_Math" alttext="\begin{array}[]{l}\displaystyle{Z_{ijx}=\frac{d_{ijx}-\bar{d_{ij}}}{\sigma_{ij%&#10;}}}\end{array}\textrm{,}" display="block"><semantics><mrow><mtable rowspacing="0.2ex" columnspacing="0.4em"><mtr><mtd columnalign="left"><mrow><msub><mi>Z</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi><mo>&#x2062;</mo><mi>x</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>d</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi><mo>&#x2062;</mo><mi>x</mi></mrow></msub><mo>-</mo><mover accent="true"><msub><mi>d</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi></mrow></msub><mo>&#xAF;</mo></mover></mrow><msub><mi>&#x3C3;</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi></mrow></msub></mfrac></mrow></mtd></mtr></mtable><mo>&#x2062;</mo><mtext>,</mtext></mrow><annotation encoding="application/x-tex">\begin{array}[]{l}\displaystyle{Z_{ijx}=\frac{d_{ijx}-\bar{d_{ij}}}{\sigma_{ij%
}}}\end{array}\textrm{,}</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(2)</span></td></tr>
</table>
</div>
<div id="Sx2.SSx6.p5" class="ltx_para">
<p class="ltx_p">where <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m1" class="ltx_Math" alttext="d_{ijx}" display="inline"><semantics><msub><mi>d</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi><mo>&#x2062;</mo><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">d_{ijx}</annotation></semantics></math> is the genetic distance over which individuals <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m2" class="ltx_Math" alttext="i" display="inline"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m3" class="ltx_Math" display="inline" alttext="j"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math> are identical surrounding position <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m4" class="ltx_Math" display="inline" alttext="x"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m5" class="ltx_Math" alttext="\bar{d_{ij}}" display="inline"><semantics><mover accent="true"><msub><mi>d</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi></mrow></msub><mo>&#xAF;</mo></mover><annotation encoding="application/x-tex">\bar{d_{ij}}</annotation></semantics></math> is the genome-wide mean of distances over which individuals are identical, and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m6" class="ltx_Math" alttext="\sigma_{ij}" display="inline"><semantics><msub><mi>&#x3C3;</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\sigma_{ij}</annotation></semantics></math> is the standard deviation of the distribution of distances.
The <em class="ltx_emph">P</em>-value for an allele <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m7" class="ltx_Math" alttext="A" display="inline"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> with frequency <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m8" class="ltx_Math" alttext="p" display="inline"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math> at position <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m9" class="ltx_Math" alttext="x" display="inline"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> was calculated such that Pr(<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m10" class="ltx_Math" alttext="PHS_{xA}\leq PHS_{null|p}" display="inline"><semantics><mrow><mrow><mi>P</mi><mo>&#x2062;</mo><mi>H</mi><mo>&#x2062;</mo><msub><mi>S</mi><mrow><mi>x</mi><mo>&#x2062;</mo><mi>A</mi></mrow></msub></mrow><mo>&#x2264;</mo><mrow><mi>P</mi><mo>&#x2062;</mo><mi>H</mi><mo>&#x2062;</mo><msub><mi>S</mi><mrow><mi>n</mi><mi>u</mi><mi>l</mi><mi>l</mi><mo>|</mo><mi>p</mi></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">PHS_{xA}\leq PHS_{null|p}</annotation></semantics></math>), where <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m11" class="ltx_Math" alttext="PHS_{null|p}" display="inline"><semantics><mrow><mi>P</mi><mo>&#x2062;</mo><mi>H</mi><mo>&#x2062;</mo><msub><mi>S</mi><mrow><mi>n</mi><mi>u</mi><mi>l</mi><mi>l</mi><mo>|</mo><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">PHS_{null|p}</annotation></semantics></math> are the PHS values for all alleles with frequency <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m12" class="ltx_Math" alttext="p" display="inline"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math> across the genome.
<span class="ltx_text" style="color:#990099;"><em class="ltx_emph ltx_font_script">(Do you mean that the <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m13" class="ltx_Math" alttext="P" display="inline"><semantics><mi mathcolor="#990099" mathsize="normal">P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>-value for allele <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx6.p5.m14" class="ltx_Math" display="inline" alttext="x"><semantics><mi mathcolor="#990099" mathsize="normal">x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> is the proportion of alleles of the same frequency genome-wide that have a larger PHS value? (and, should be PHS, not PHA?))</em></span> 
<span class="ltx_text" style="color:#FF0000;">You are right. PHA is a typo.  Corrected.</span></p>
</div>
<div id="Sx2.SSx6.p6" class="ltx_para">
<p class="ltx_p">Genetic distances were obtained from the IBM population <cite class="ltx_cite"/>.
While genetic positions were initially only available for the MaizeSNP50 data set, we fit genetic (cM) and physical (bp) distances to a tenth degree polynomial curve, and calculated cM for all SNPs.
</p>
</div>
<div id="Sx2.F4" class="ltx_figure"><object data="fig/Fig5.svg" id="Sx2.F4.g1" class="ltx_graphics ltx_centering" width="267" height="499" alt=""/>
<div class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure&#xA0;4: </span>Observed and expected distributions of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.F4.m4" class="ltx_Math" display="inline" alttext="F_{ST}"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> values in GBS (A) and MaizeSNP50 data (B).  The <em class="ltx_emph">x</em>-axes represent <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.F4.m5" class="ltx_Math" alttext="F_{ST}" display="inline"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> values.  The <em class="ltx_emph">y</em>-axes represent the frequency of SNPs with <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.F4.m6" class="ltx_Math" alttext="F_{ST}" display="inline"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> values within a bin of 0.05 size.  Red dots and solid lines indicate observed and expected distributions.
</div>
</div>
</div>
<div id="Sx2.SSx7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Theoretical evaluation of parallel adaptation </h3>

<div id="Sx2.SSx7.p1" class="ltx_para">
<p class="ltx_p">We suggest below that many of the high-<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p1.m1" class="ltx_Math" alttext="F_{ST}" display="inline"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> alleles are locally adaptive,
and the degree of coincidence between highland regions informs us about
whether these adaptations occurred in parallel,
or if alleles were transmitted between the two by migration.
To see if the abundance and degree of coincidence is consistent with what is known about the population history of maize,
we evaluated the rate at which we expect an allele that provides a selective advantage at higher altitude
to arise by new mutation in a highland region (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p1.m2" class="ltx_Math" display="inline" alttext="\lambda_{\text{mut}}"><semantics><msub><mi>&#x3BB;</mi><mtext>mut</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{mut}}</annotation></semantics></math>),
and the rate at which such an allele already present in the Mexican highlands
would transit the intervening lowlands and fix in the Andean highlands (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p1.m3" class="ltx_Math" display="inline" alttext="\lambda_{\text{mig}}"><semantics><msub><mi>&#x3BB;</mi><mtext>mig</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{mig}}</annotation></semantics></math>).
In each case we assume alleles adapted in the highlands are slightly deleterious at lower altitude.  This assumption is consistent with empirical findings in reciprocal transplants of highland and lowland maize in Mexico <cite class="ltx_cite"/>.
These numbers depend most strongly on the population density,
the selection coefficient,
and the rate at which seed is transported long distances and replanted.
We evaluated these rates using new and existing theory, and validated by simulation.
</p>
</div>
<div id="Sx2.SSx7.p2" class="ltx_para">
<p class="ltx_p">To calculate the rate at which new mutations appear and fix in a highland population, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p2.m1" class="ltx_Math" display="inline" alttext="\lambda_{\text{mut}}"><semantics><msub><mi>&#x3BB;</mi><mtext>mut</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{mut}}</annotation></semantics></math>,
we multiplied the total population size of the highlands by the mutation rate per generation
=======
In each case we assume alleles adapted in the highlands are slightly deleterious at lower altitude (but see later discussion).
This assumption is consistent with empirical findings in reciprocal transplants of highland and lowland maize in Mexico <cite class="ltx_cite">()</cite>.
These numbers depend most strongly on the population density,
the selection coefficient,
and the rate at which seed is transported long distances and replanted.
Here we describe the mathematical details;
readers may skip to the results without loss of continuity.</p>
</div>
<div id="Sx2.SSx7.p3" class="ltx_para">
<p class="ltx_p">To do this,
we followed <cite class="ltx_cite"/> in constructing a detailed demographic model for domesticated maize.
<span class="ltx_text" style="color:#990099;"><em class="ltx_emph ltx_font_script">(this is long-ish?  could perhaps summarize this more/better?)</em></span> 
Fields of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p3.m1" class="ltx_Math" alttext="N=10^{5}" display="inline"><semantics><mrow><mi>N</mi><mo>=</mo><msup><mn>10</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">N=10^{5}</annotation></semantics></math> plants are replanted each year from <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p3.m2" class="ltx_Math" display="inline" alttext="N_{f}=561"><semantics><mrow><msub><mi>N</mi><mi>f</mi></msub><mo>=</mo><mn>561</mn></mrow><annotation encoding="application/x-tex">N_{f}=561</annotation></semantics></math> ears,
either from completely new stock (with probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p3.m3" class="ltx_Math" alttext="p_{e}=0.068" display="inline"><semantics><mrow><msub><mi>p</mi><mi>e</mi></msub><mo>=</mo><mn>0.068</mn></mrow><annotation encoding="application/x-tex">p_{e}=0.068</annotation></semantics></math>),
from partially new stock (a proportion <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p3.m4" class="ltx_Math" alttext="r_{m}=0.2" display="inline"><semantics><mrow><msub><mi>r</mi><mi>m</mi></msub><mo>=</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">r_{m}=0.2</annotation></semantics></math> with probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p3.m5" class="ltx_Math" alttext="p_{m}=0.02" display="inline"><semantics><mrow><msub><mi>p</mi><mi>m</mi></msub><mo>=</mo><mn>0.02</mn></mrow><annotation encoding="application/x-tex">p_{m}=0.02</annotation></semantics></math>),
or entirely from the same field otherwise.
Each plant is seed parent to all kernels of its own ears, but can be pollen parent to kernels in many other ears;
a proportion <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p3.m6" class="ltx_Math" alttext="m_{g}=0.0083" display="inline"><semantics><mrow><msub><mi>m</mi><mi>g</mi></msub><mo>=</mo><mn>0.0083</mn></mrow><annotation encoding="application/x-tex">m_{g}=0.0083</annotation></semantics></math> of the pollen-parent kernels are in other fields.
Wild-type plants have an average of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p3.m7" class="ltx_Math" alttext="\mu_{E}=3" display="inline"><semantics><mrow><msub><mi>&#x3BC;</mi><mi>E</mi></msub><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\mu_{E}=3</annotation></semantics></math> ears per plant, and ears have an average of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p3.m8" class="ltx_Math" display="inline" alttext="N/N_{f}"><semantics><mrow><mi>N</mi><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">N/N_{f}</annotation></semantics></math> kernels;
each of these numbers are Poisson distributed.
The mean number of pollen-parent kernels, and the mean number of kernels per ear,
is assumed to be <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p3.m9" class="ltx_Math" display="inline" alttext="(1+s_{b})"><semantics><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><msub><mi>s</mi><mi>b</mi></msub></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">(1+s_{b})</annotation></semantics></math> times larger for individuals heterozygous for the selected allele.
Migration is mediated by seed exchange &#x2013;
when fields are replanted, the seed is chosen from a random distance away with mean <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p3.m10" class="ltx_Math" alttext="\sigma_{s}=50" display="inline"><semantics><mrow><msub><mi>&#x3C3;</mi><mi>s</mi></msub><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">\sigma_{s}=50</annotation></semantics></math>km,
but plants only pollinate other plants belonging to the same village (distance 0).
Each individual can have offspring in three categories: local seed, local pollen, and migrant seed;
the mean numbers of each of these are determined by the condition that the population is stable
(so wild-type, diploid individuals have on average 2 offspring)
except that heterozygotes have on average <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p3.m11" class="ltx_Math" display="inline" alttext="(1+s_{b})"><semantics><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><msub><mi>s</mi><mi>b</mi></msub></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">(1+s_{b})</annotation></semantics></math> offspring that carry the selected allele.
Each ear has a small chance of being chosen for replanting,
so the number of ears replanted of a given individual is Poisson,
and assuming that pollen is well-mixed, the number of pollen-parent kernels is Poisson as well.
Each of these numbers of offspring has a mean that depends on whether the field is replanted with new stock,
and whether ears are chosen from this field to replant other fields,
so the total number of offspring is actually a mixture of Poissons;
these means, and more details of the computations, are found in Appendix <a href="#S1" title="1 Details of the demographic model &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="Sx2.SSx7.p4" class="ltx_para">
<p class="ltx_p"><em class="ltx_emph ltx_font_script" style="color:#990099;">(got a better term than &#x201C;pollen-parent kernels&#x201D;??)</em></p>
</div>
<div id="Sx2.SSx7.p5" class="ltx_para">
<p class="ltx_p">At these parameter values, we compute that the variance in number of offspring, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p5.m1" class="ltx_Math" display="inline" alttext="\xi^{2}"><semantics><msup><mi>&#x3BE;</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\xi^{2}</annotation></semantics></math>, is between 20 (for wild-type) and 30 (for <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p5.m2" class="ltx_Math" display="inline" alttext="s_{b}=0.1"><semantics><mrow><msub><mi>s</mi><mi>b</mi></msub><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">s_{b}=0.1</annotation></semantics></math>),
and the dispersal distance (mean distance between parent and offspring)
is <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p5.m3" class="ltx_Math" alttext="\sigma=1.8" display="inline"><semantics><mrow><mi>&#x3C3;</mi><mo>=</mo><mn>1.8</mn></mrow><annotation encoding="application/x-tex">\sigma=1.8</annotation></semantics></math>km.</p>
</div>
<div id="Sx2.SSx7.p6" class="ltx_para">
<p class="ltx_p">The rate at which new mutations appear and fix in a highland population, which we denote <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p6.m1" class="ltx_Math" display="inline" alttext="\lambda_{\text{mut}}"><semantics><msub><mi>&#x3BB;</mi><mtext>mut</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{mut}}</annotation></semantics></math>,
is equal to the total population size of the highlands, multiplied by the mutation rate per generation
and by the chance that a single such mutation successfully fixes
(i.e.&#xA0;is not lost to drift).
The latter probability, that a single new mutant allele providing benefit <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p6.m2" class="ltx_Math" alttext="s_{b}" display="inline"><semantics><msub><mi>s</mi><mi>b</mi></msub><annotation encoding="application/x-tex">s_{b}</annotation></semantics></math> to heterozygotes at high elevation
will fix locally in the high elevation population,
is approximately <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p6.m3" class="ltx_Math" display="inline" alttext="2s_{b}"><semantics><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">2s_{b}</annotation></semantics></math> divided by the variance in offspring number <cite class="ltx_cite">()</cite>.
The calculation above is not quite correct, as it neglects migration across the altitudinal gradient,
but exact numerical calculation of the chance of fixation of a mutation as a function of the location where it first appears
indicates that the approximation is quite good (see figure <a href="#S1.F6" title="Figure&#xA0;6 &#x2023; 1.5 Results &#x2023; 1 Details of the demographic model &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>);
for theoretical treatment see <cite class="ltx_cite"/> or <cite class="ltx_cite"/>.</p>
</div>
<div id="Sx2.SSx7.p7" class="ltx_para">
<p class="ltx_p">Concretely, the probability that a new mutation destined for fixation
will arise in a patch of high-elevation habitat of area <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p7.m1" class="ltx_Math" display="inline" alttext="A"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> in a given generation
is a function of the density of maize per unit area <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p7.m2" class="ltx_Math" alttext="\rho" display="inline"><semantics><mi>&#x3C1;</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>,
the selective benefit <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p7.m3" class="ltx_Math" alttext="s_{b}" display="inline"><semantics><msub><mi>s</mi><mi>b</mi></msub><annotation encoding="application/x-tex">s_{b}</annotation></semantics></math> it provides,
the mutation rate <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p7.m4" class="ltx_Math" alttext="\mu" display="inline"><semantics><mi>&#x3BC;</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>,
and the variance in offspring number <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p7.m5" class="ltx_Math" alttext="\xi^{2}" display="inline"><semantics><msup><mi>&#x3BE;</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\xi^{2}</annotation></semantics></math>.
In terms of these parameters, the rate of appearance is</p>
<table id="S4.EGx1" class="ltx_equationgroup ltx_eqn_align">

<tr id="Sx2.E3" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"><math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.E3.m1" class="ltx_Math" alttext="\displaystyle\lambda_{\text{mut}}=\frac{2\mu\rho As_{b}}{\xi^{2}}." display="inline"><semantics><mrow><mrow><msub><mi>&#x3BB;</mi><mtext>mut</mtext></msub><mo>=</mo><mstyle displaystyle="true"><mfrac><mrow><mn>2</mn><mo>&#x2062;</mo><mi>&#x3BC;</mi><mo>&#x2062;</mo><mi>&#x3C1;</mi><mo>&#x2062;</mo><mi>A</mi><mo>&#x2062;</mo><msub><mi>s</mi><mi>b</mi></msub></mrow><msup><mi>&#x3BE;</mi><mn>2</mn></msup></mfrac></mstyle></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\displaystyle\lambda_{\text{mut}}=\frac{2\mu\rho As_{b}}{\xi^{2}}.</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(3)</span></td></tr>
</table>
</div>
<div id="Sx2.SSx7.p8" class="ltx_para">
<p class="ltx_p">A corresponding expression for the chance that an allele moves from one highland population to another is harder to intuit,
and is addressed in more depth in <cite class="ltx_cite">()</cite>.
If an allele is beneficial at high elevation, and fixed in the Mexican highlands,
but deleterious at low elevations,
then it will be present at low frequency in nearby lowland populations,
maintained at migration-selection balance <cite class="ltx_cite">()</cite>.
This equilibrium frequency decays exponentially with distance,
so that the highland allele is present at distance <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m1" class="ltx_Math" display="inline" alttext="R"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math> from the highlands at frequency <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m2" class="ltx_Math" display="inline" alttext="C\exp(-R\sqrt{2s_{m}}/\sigma)"><semantics><mrow><mi>C</mi><mo>&#x2062;</mo><mrow><mi>exp</mi><mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>-</mo><mrow><mrow><mi>R</mi><mo>&#x2062;</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>m</mi></msub></mrow></msqrt></mrow><mo>/</mo><mi>&#x3C3;</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">C\exp(-R\sqrt{2s_{m}}/\sigma)</annotation></semantics></math>,
where <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m3" class="ltx_Math" alttext="s_{m}" display="inline"><semantics><msub><mi>s</mi><mi>m</mi></msub><annotation encoding="application/x-tex">s_{m}</annotation></semantics></math> is the deleterious selection coefficient for the allele in low elevation,
<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m4" class="ltx_Math" alttext="\sigma" display="inline"><semantics><mi>&#x3C3;</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math> is the mean dispersal distance,
and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m5" class="ltx_Math" display="inline" alttext="C"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math> is a constant depending on geography (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m6" class="ltx_Math" display="inline" alttext="C\approx 1/2"><semantics><mrow><mi>C</mi><mo>&#x2248;</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow><annotation encoding="application/x-tex">C\approx 1/2</annotation></semantics></math> is close).
Multiplying this frequency by a population size gets the predicted number (average density across a large number of generations) of individuals carrying the allele in that population.
Therefore, in a lowland population of size <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m7" class="ltx_Math" alttext="N" display="inline"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math> at distance <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m8" class="ltx_Math" display="inline" alttext="R"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math> from the highlands,
<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m9" class="ltx_Math" display="inline" alttext="(N/2)\exp(-R\sqrt{2s_{m}}/\sigma)"><semantics><mrow><mrow><mo>(</mo><mrow><mi>N</mi><mo>/</mo><mn>2</mn></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mi>exp</mi><mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>-</mo><mrow><mrow><mi>R</mi><mo>&#x2062;</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>m</mi></msub></mrow></msqrt></mrow><mo>/</mo><mi>&#x3C3;</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">(N/2)\exp(-R\sqrt{2s_{m}}/\sigma)</annotation></semantics></math> is equal to the probability that there are any highland alleles present,
multiplied by the expected number of these, given that there are some present.
Since the latter is at least 1,
the chance there are any present in a given generation is no more than <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m10" class="ltx_Math" alttext="(N/2)\exp(-R\sqrt{2s_{m}}/\sigma)" display="inline"><semantics><mrow><mrow><mo>(</mo><mrow><mi>N</mi><mo>/</mo><mn>2</mn></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mi>exp</mi><mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>-</mo><mrow><mrow><mi>R</mi><mo>&#x2062;</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>m</mi></msub></mrow></msqrt></mrow><mo>/</mo><mi>&#x3C3;</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">(N/2)\exp(-R\sqrt{2s_{m}}/\sigma)</annotation></semantics></math>,
and so this puts an upper bound on <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m11" class="ltx_Math" alttext="\lambda_{\text{mig}}" display="inline"><semantics><msub><mi>&#x3BB;</mi><mtext>mig</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{mig}}</annotation></semantics></math>.
Therefore, we would need to wait <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m12" class="ltx_Math" display="inline" alttext="T_{\text{mig}}=(2/N)\exp(R\sqrt{2s_{m}}/\sigma)"><semantics><mrow><msub><mi>T</mi><mtext>mig</mtext></msub><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mn>2</mn><mo>/</mo><mi>N</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mi>exp</mi><mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mrow><mi>R</mi><mo>&#x2062;</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>m</mi></msub></mrow></msqrt></mrow><mo>/</mo><mi>&#x3C3;</mi></mrow><mo>)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">T_{\text{mig}}=(2/N)\exp(R\sqrt{2s_{m}}/\sigma)</annotation></semantics></math> generations
for a rare such excursion to occur.
In other words, we can bound the rate of migration by</p>
<table id="S4.EGx2" class="ltx_equationgroup ltx_eqn_align">

<tr id="Sx2.E4" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"><math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.E4.m1" class="ltx_Math" display="inline" alttext="\displaystyle\lambda_{\text{mig}}\leq(N/2)\exp(-R\sqrt{2s_{m}}/\sigma),"><semantics><mrow><mrow><msub><mi>&#x3BB;</mi><mtext>mig</mtext></msub><mo>&#x2264;</mo><mrow><mrow><mo>(</mo><mrow><mi>N</mi><mo>/</mo><mn>2</mn></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mi>exp</mi><mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>-</mo><mrow><mrow><mi>R</mi><mo>&#x2062;</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>m</mi></msub></mrow></msqrt></mrow><mo>/</mo><mi>&#x3C3;</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\displaystyle\lambda_{\text{mig}}\leq(N/2)\exp(-R\sqrt{2s_{m}}/\sigma),</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(4)</span></td></tr>
</table>
<p class="ltx_p">with <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m13" class="ltx_Math" alttext="N" display="inline"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math> the total size of the unadapted highland population,
and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m14" class="ltx_Math" alttext="R" display="inline"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math> the distance from the adapted to the yet-unadapted highland populations.
This also omits the probability that such an allele fixes (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p8.m15" class="ltx_Math" display="inline" alttext="\approx 2s_{b}/\xi^{2}"><semantics><mrow><mi/><mo>&#x2248;</mo><mrow><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>b</mi></msub></mrow><mo>/</mo><msup><mi>&#x3BE;</mi><mn>2</mn></msup></mrow></mrow><annotation encoding="application/x-tex">\approx 2s_{b}/\xi^{2}</annotation></semantics></math>),
but since such alleles arrive by migration, this omission is unlikely a large effect and is conservative.</p>
</div>
<div id="Sx2.SSx7.p9" class="ltx_para">
<p class="ltx_p">To obtain specific predictions,
we then computed <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p9.m1" class="ltx_Math" alttext="\lambda_{\text{mut}}" display="inline"><semantics><msub><mi>&#x3BB;</mi><mtext>mut</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{mut}}</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx2.SSx7.p9.m2" class="ltx_Math" alttext="\lambda_{\text{mig}}" display="inline"><semantics><msub><mi>&#x3BB;</mi><mtext>mig</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{mig}}</annotation></semantics></math> at various parameter values.
We also checked these with simulations and more detailed computations,
described in the Appendix.</p>
</div>
</div>
</div>
<div id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Results and Discussion</h2>

<div id="Sx3.T1" class="ltx_table">
<div class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table&#xA0;1: </span>Silent site <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.T1.m2" class="ltx_Math" alttext="F_{ST}" display="inline"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> from GBS SNPs &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</div>
<p class="ltx_p ltx_align_center">[-2mm]

<table class="ltx_tabular">
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_border_t"/>
<th class="ltx_td ltx_border_t"/>
<th class="ltx_td ltx_border_t"/>
<th class="ltx_td ltx_border_t"/>
<th class="ltx_td ltx_border_t"/>
<th class="ltx_td ltx_border_t"/>
<th class="ltx_td ltx_border_t"/>
<th class="ltx_td ltx_border_t"/>
<td class="ltx_td ltx_border_t"/></tr>
<tr class="ltx_tr">
<th class="ltx_td"/>
<th class="ltx_td"/>
<th class="ltx_td ltx_align_center" colspan="2" align="center"><span class="ltx_text ltx_font_sansserif">Mexico</span></th>
<th class="ltx_td ltx_align_center" colspan="2" align="center"><span class="ltx_text ltx_font_sansserif">South America</span></th>
<th class="ltx_td"/>
<th class="ltx_td"/>
<td class="ltx_td"/></tr>
<tr class="ltx_tr">
<th class="ltx_td"/>
<th class="ltx_td"/>
<th class="ltx_td ltx_align_center" align="center"><span class="ltx_text ltx_font_sansserif">Lowlands</span></th>
<th class="ltx_td ltx_align_center" align="center"><span class="ltx_text ltx_font_sansserif">Highlands</span></th>
<th class="ltx_td ltx_align_center" align="center"><span class="ltx_text ltx_font_sansserif">Lowlands</span></th>
<th class="ltx_td ltx_align_center" align="center"><span class="ltx_text ltx_font_sansserif">Highlands</span></th>
<th class="ltx_td"/>
<th class="ltx_td"/>
<td class="ltx_td"/></tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_border_t"/>
<th class="ltx_td ltx_border_t"/>
<td class="ltx_td ltx_border_t"/>
<td class="ltx_td ltx_border_t"/>
<td class="ltx_td ltx_border_t"/>
<td class="ltx_td ltx_border_t"/>
<td class="ltx_td ltx_border_t"/>
<td class="ltx_td ltx_border_t"/>
<td class="ltx_td ltx_border_t"/></tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left" align="left"><span class="ltx_text ltx_font_sansserif">Mexico</span></th>
<th class="ltx_td ltx_align_left" align="left"><span class="ltx_text ltx_font_sansserif">Lowlands</span></th>
<td class="ltx_td ltx_align_center" align="center"><span class="ltx_text ltx_font_sansserif">&#x2013;</span></td>
<td class="ltx_td"/>
<td class="ltx_td"/>
<td class="ltx_td"/>
<td class="ltx_td"/>
<td class="ltx_td"/>
<td class="ltx_td"/></tr>
<tr class="ltx_tr">
<th class="ltx_td"/>
<th class="ltx_td ltx_align_left" align="left"><span class="ltx_text ltx_font_sansserif">Highlands</span></th>
<td class="ltx_td ltx_align_center" align="center"><span class="ltx_text ltx_font_sansserif">0.0244</span></td>
<td class="ltx_td ltx_align_center" align="center"><span class="ltx_text ltx_font_sansserif">&#x2013;</span></td>
<td class="ltx_td"/>
<td class="ltx_td"/>
<td class="ltx_td"/>
<td class="ltx_td"/>
<td class="ltx_td"/></tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left" align="left"><span class="ltx_text ltx_font_sansserif">SA</span></th>
<th class="ltx_td ltx_align_left" align="left"><span class="ltx_text ltx_font_sansserif">Lowlands</span></th>
<td class="ltx_td ltx_align_center" align="center"><span class="ltx_text ltx_font_sansserif">0.0227</span></td>
<td class="ltx_td ltx_align_center" align="center"><span class="ltx_text ltx_font_sansserif">0.0343</span></td>
<td class="ltx_td ltx_align_center" align="center"><span class="ltx_text ltx_font_sansserif">&#x2013;</span></td>
<td class="ltx_td"/>
<td class="ltx_td"/>
<td class="ltx_td"/>
<td class="ltx_td"/></tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_border_b"/>
<th class="ltx_td ltx_align_left ltx_border_b" align="left"><span class="ltx_text ltx_font_sansserif">Highlands</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" align="center"><span class="ltx_text ltx_font_sansserif">0.0466</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" align="center"><span class="ltx_text ltx_font_sansserif">0.0534</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" align="center"><span class="ltx_text ltx_font_sansserif">0.0442</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" align="center"><span class="ltx_text ltx_font_sansserif">&#x2013;</span></td>
<td class="ltx_td ltx_border_b"/>
<td class="ltx_td ltx_border_b"/>
<td class="ltx_td ltx_border_b"/></tr>
</tbody>
</table><span class="ltx_text ltx_font_sansserif"/></p>
</div>
<div id="Sx3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Samples and data</h3>

<div id="Sx3.SSx1.p1" class="ltx_para">
<p class="ltx_p">We generated a large set of SNPs in 94 maize accessions that were sampled from the four populations we defined: highland and lowland populations in both Mexico and S. America (Table&#xA0;S1; see Materials and Methods).
The SNPs were generated by the two high-throughput methods: <span class="ltx_text" style="text-decoration:underline;">g</span>enotyping-<span class="ltx_text" style="text-decoration:underline;">b</span>y-<span class="ltx_text" style="text-decoration:underline;">s</span>equencing (GBS) method and MaizeSNP50 Beadchip platform (see Materials and Methods).
We hereafter refer to the two SNP data sets as &#x201D;GBS&#x201D; and &#x201C;MaizeSNP50&#x201D;.
In total, we obtained 91,779 SNPs after filtering by Hardy-Weinberg criteria with sample size <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx1.p1.m1" class="ltx_Math" display="inline" alttext="\geq 10"><semantics><mrow><mi/><mo>&#x2265;</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\geq 10</annotation></semantics></math> in all the four populations (see Materials and Methods), 67,828 and 23,951 of which were generated by GBS and MaizeSNP50, respectively.
We performed population genomic analyses using these data sets to reveal the molecular basis of parallel highland adaptation in maize.</p>
</div>
<div id="Sx3.SSx1.p2" class="ltx_para">
<p class="ltx_p">Our sample included 94 maize landraces from four distinct regions in the Americas: the lowlands of Mexico/Guatemala (n=24) and northern South America (n=23) and the highlands of the Mexican Central Plateau (n=24) and the Andes (n=23). Samples were genotyped using the MaizeSNP50 Beadchip platform (n=94) and a method referred to as <span class="ltx_text" style="text-decoration:underline;">g</span>enotyping-<span class="ltx_text" style="text-decoration:underline;">b</span>y-<span class="ltx_text" style="text-decoration:underline;">s</span>equencing (GBS; n=87).</p>
</div>
</div>
<div id="Sx3.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Population structure</h3>

<div id="Sx3.SSx2.p1" class="ltx_para">
<p class="ltx_p">We performed a <span class="ltx_text ltx_font_sansserif">STRUCTURE</span> analysis <cite class="ltx_cite"/> of our landrace sample, varying the number of groups from <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx2.p1.m1" class="ltx_Math" display="inline" alttext="K=2\sim 6"><semantics><mrow><mi>K</mi><mo>=</mo><mn>2</mn><mo>&#x223C;</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">K=2\sim 6</annotation></semantics></math> (Figure&#xA0;<a href="#Sx1.F1" title="Figure&#xA0;1 &#x2023; Introduction &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, Figure&#xA0;S3).
Most landraces were assigned to groups consistent with <em class="ltx_emph">a priori</em> population definitions, but admixture between highland and lowland populations was evident at intermediate elevations (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx2.p1.m2" class="ltx_Math" display="inline" alttext="\sim 1700"><semantics><mrow><mi/><mo>&#x223C;</mo><mn>1700</mn></mrow><annotation encoding="application/x-tex">\sim 1700</annotation></semantics></math>m).  Consistent with previously described scenarios for maize diffusion <cite class="ltx_cite"/>, we find evidence of shared ancestry between lowland Mexican maize and both Mexican highland and S. American lowland populations.  Pairwise <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx2.p1.m3" class="ltx_Math" display="inline" alttext="F_{ST}"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> among populations reveals low overall differentiation (Table ), and the higher <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx2.p1.m4" class="ltx_Math" display="inline" alttext="F_{ST}"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> values observed in S. America are consistent with decreased admixture seen in STRUCTURE.  Archaeological evidence supports a more recent colonization of the highlands in S. America  <cite class="ltx_cite"/>, suggesting that the observed differentiation may be the result of a stronger  bottleneck during colonization of the S. American highlands.
</p>
</div>
</div>
<div id="Sx3.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Population differentiation under inferred demography</h3>

<div id="Sx3.SSx3.p1" class="ltx_para">
<p class="ltx_p">To provide a null expectation for allele frequency differentiation, we used the joint site frequency distribution (JFD) of lowland and highland populations to estimate parameters of two demographic models (Figure&#xA0;<a href="#Sx2.F2" title="Figure&#xA0;2 &#x2023; Demographic inference &#x2023; Materials and Methods &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>; see Materials and Methods for details) using the maximum likelihood method implemented in <span class="ltx_text ltx_font_sansserif">dadi</span> <cite class="ltx_cite">()</cite>.
Estimated parameter values are listed in Table&#xA0;<span class="ltx_ref ltx_ref_self">LABEL:param</span>;
while the observed and expected JFDs were quite similar for both models,
residuals indicated an excess of rare variants in the observed JFDs in all cases (Figure&#xA0;<a href="#Sx2.F3" title="Figure&#xA0;3 &#x2023; 0.0.3 Model II &#x2023; Demographic inference &#x2023; Materials and Methods &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
Under both models IA and IB,  we found expansion in the highland population in Mexico to be unlikely, but a strong bottleneck followed by population expansion is supported in S. American maize in both models IA and II.
The likelihood value of model IB was higher than the likelihood of model IA by 850 units of log-likelihood (Table&#xA0;<span class="ltx_ref ltx_ref_self">LABEL:param</span>),
consistent with analyses suggesting that introgression from <span class="ltx_text ltx_font_italic">mexicana</span> played a significant role during the spread of maize into the Mexican highlands <cite class="ltx_cite">()</cite>.</p>
</div>
<div id="Sx3.SSx3.p2" class="ltx_para">
<p class="ltx_p">In addition to the parameters listed in Figure&#xA0;<a href="#Sx2.F2" title="Figure&#xA0;2 &#x2023; Demographic inference &#x2023; Materials and Methods &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we investigated the impact of varying the domestication bottleneck size (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx3.p2.m1" class="ltx_Math" alttext="N_{B}" display="inline"><semantics><msub><mi>N</mi><mi>B</mi></msub><annotation encoding="application/x-tex">N_{B}</annotation></semantics></math>).
Surprisingly, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx3.p2.m2" class="ltx_Math" display="inline" alttext="N_{B}"><semantics><msub><mi>N</mi><mi>B</mi></msub><annotation encoding="application/x-tex">N_{B}</annotation></semantics></math> was estimated to be equal to <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx3.p2.m3" class="ltx_Math" display="inline" alttext="N_{C}"><semantics><msub><mi>N</mi><mi>C</mi></msub><annotation encoding="application/x-tex">N_{C}</annotation></semantics></math>, the population size at the end of the bottleneck, and the likelihood of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx3.p2.m4" class="ltx_Math" alttext="N_{B}&lt;N_{C}" display="inline"><semantics><mrow><msub><mi>N</mi><mi>B</mi></msub><mo>&lt;</mo><msub><mi>N</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">N_{B}&lt;N_{C}</annotation></semantics></math> was much smaller than for alternative parameterizations (Table&#xA0;<span class="ltx_ref ltx_ref_self">LABEL:param</span>, Table&#xA0;S2)</p>
</div>
<div id="Sx3.SSx3.p3" class="ltx_para">
<p class="ltx_p">This result appears to contradict earlier work using sequences from coding regions to infer a maize domestication bottleneck <cite class="ltx_cite"/>.  One explanation for this discrepancy may be the action of purifying selection in coding regions, which could act to retard the recovery of diversity and lead to estimates of a stronger bottleneck <cite class="ltx_cite"/>.  Consistent with <cite class="ltx_cite"/>, our genome-wide SNP data show an excess of rare variants relative to expectations under <cite class="ltx_cite"/>&#x2019;s bottleneck model (Figure&#xA0;<a href="#Sx2.F3" title="Figure&#xA0;3 &#x2023; 0.0.3 Model II &#x2023; Demographic inference &#x2023; Materials and Methods &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), suggesting a domestication model involving a weaker bottleneck or more rapid population growth.
</p>
</div>
<div id="Sx3.SSx3.p4" class="ltx_para">
<p class="ltx_p">Comparing our empirical <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx3.p4.m1" class="ltx_Math" alttext="F_{ST}" display="inline"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> values to the null expectation simulated under our demographic models allowed us to identify significantly differentiated SNPs between low- and highland populations. In all cases, observed <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx3.p4.m2" class="ltx_Math" display="inline" alttext="F_{ST}"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> values were quite similar to those generated under our null models (Figure&#xA0;<a href="#Sx2.F4" title="Figure&#xA0;4 &#x2023; Haplotype scoring test &#x2023; Materials and Methods &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>A), and model choice &#x2013; including the parameterization of the domestication bottleneck &#x2013; had little impact on the distribution of estimated p-values (Figure&#xA0;S4). We chose <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx3.p4.m3" class="ltx_Math" display="inline" alttext="P&lt;0.01"><semantics><mrow><mi>P</mi><mo>&lt;</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">P&lt;0.01</annotation></semantics></math> as an arbitrary cut-off for significant differentiation between low- and highland populations, and identified 1,040 SNPs in Mexico (1,040/76,989=0.0135) and 756 SNPs in South America (756/63,160=0.0120) as outliers.</p>
</div>
<div id="Sx3.F5" class="ltx_figure"><object data="fig/Fig6.svg" id="Sx3.F5.g1" class="ltx_graphics ltx_centering" width="238" height="238" alt=""/>
<div class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure&#xA0;5: </span>Scatter plot of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.F5.m11" class="ltx_Math" alttext="F_{ST}" display="inline"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math><math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.F5.m12" class="ltx_Math" display="inline" alttext="P"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>-values in Mexico (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.F5.m13" class="ltx_Math" display="inline" alttext="P_{M}"><semantics><msub><mi>P</mi><mi>M</mi></msub><annotation encoding="application/x-tex">P_{M}</annotation></semantics></math> on <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.F5.m14" class="ltx_Math" display="inline" alttext="x"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>-axes) and South America (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.F5.m15" class="ltx_Math" alttext="P_{S}" display="inline"><semantics><msub><mi>P</mi><mi>S</mi></msub><annotation encoding="application/x-tex">P_{S}</annotation></semantics></math> on <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.F5.m16" class="ltx_Math" display="inline" alttext="y"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>-axes).  <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.F5.m17" class="ltx_Math" alttext="P_{M}" display="inline"><semantics><msub><mi>P</mi><mi>M</mi></msub><annotation encoding="application/x-tex">P_{M}</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.F5.m18" class="ltx_Math" alttext="P_{S}" display="inline"><semantics><msub><mi>P</mi><mi>S</mi></msub><annotation encoding="application/x-tex">P_{S}</annotation></semantics></math> are scaled by <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.F5.m19" class="ltx_Math" display="inline" alttext="-\log_{10}"><semantics><mrow><mo>-</mo><msub><mi>log</mi><mn>10</mn></msub></mrow><annotation encoding="application/x-tex">-\log_{10}</annotation></semantics></math>.
<span class="ltx_text" style="color:#990099;"><em class="ltx_emph ltx_font_script">(I think you mean these are <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.F5.m20" class="ltx_Math" display="inline" alttext="-\log_{10}P"><semantics><mrow><mo mathcolor="#990099" mathsize="normal">-</mo><mrow><msub><mi mathcolor="#990099" mathsize="normal">log</mi><mn mathcolor="#990099" mathsize="normal">10</mn></msub><mo mathsize="small" mathcolor="#990099">&#x2061;</mo><mi mathsize="normal" mathcolor="#990099">P</mi></mrow></mrow><annotation encoding="application/x-tex">-\log_{10}P</annotation></semantics></math>-values?)</em></span> 
<span class="ltx_text" style="color:#FF0000;">yes</span>
<span class="ltx_text" style="color:#990099;"><em class="ltx_emph ltx_font_script">(It might be nice to label this figure with the numbers in the text, so we can see how many SNPs fall in each category.)</em></span> 
<span class="ltx_text" style="color:#FF0000;">you mean the numbers of SNPs? How about this?</span>
Red, blue, orange and gray dots represents SNPs showing significance in both Mexico and S. America, only in Mexico, only in S. America, respectively (see text for details).
The number of SNPs in each category is shown in the same color of dots.</div>
</div>
</div>
<div id="Sx3.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Patterns of adaptation</h3>

<div id="Sx3.SSx4.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection"><span class="ltx_tag ltx_tag_subsubsection">0.0.4 </span>Adaptation via mutation versus standing variation</h4>

<div id="Sx3.SSx4.SSS4.p1" class="ltx_para">
<p class="ltx_p">In order to characterize patterns of adaptation, we first determined whether  SNPs showing high differentiation between the lowlands and the highlands arose primarily through new mutations or standing genetic variation.
We found that these putatively adaptive variants in both Mexico and South America tended to segregate in lowland populations more often than other SNPs (84.6% vs. 74.8% in Mexico, Fisher&#x2019;s exact test (FET) <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS4.p1.m1" class="ltx_Math" display="inline" alttext="P&lt;10^{-11}"><semantics><mrow><mi>P</mi><mo>&lt;</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>11</mn></mrow></msup></mrow><annotation encoding="application/x-tex">P&lt;10^{-11}</annotation></semantics></math> and 87.3% vs 81.8% in South America,  <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS4.p1.m2" class="ltx_Math" alttext="P&lt;10^{-3}" display="inline"><semantics><mrow><mi>P</mi><mo>&lt;</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">P&lt;10^{-3}</annotation></semantics></math>).
<span class="ltx_text" style="color:#990099;"><em class="ltx_emph ltx_font_script">(&#x201C;segregate in&#x201D; &#x2013; are these percentages of SNPs that are polymorphic (as opposed to fixed for either allele) in the relevant population?)</em></span> 
<span class="ltx_text" style="color:#FF0000;">yes</span>
We extended this analysis to standing variation in <em class="ltx_emph">parviglumis</em> by retrieving SNP data from 14 <em class="ltx_emph">parviglumis</em> inbred lines included in the Hapmap v2 data set, using only SNPs with <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS4.p1.m3" class="ltx_Math" display="inline" alttext="n\geq 10"><semantics><mrow><mi>n</mi><mo>&#x2265;</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n\geq 10</annotation></semantics></math> <cite class="ltx_cite"/>.
Again we found that putatively adaptive variants were more likely to be polymorphic in <em class="ltx_emph">parviglumis</em> (81.1% vs. 72.1% in Mexico, FET <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS4.p1.m4" class="ltx_Math" alttext="P&lt;10^{-6}" display="inline"><semantics><mrow><mi>P</mi><mo>&lt;</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>6</mn></mrow></msup></mrow><annotation encoding="application/x-tex">P&lt;10^{-6}</annotation></semantics></math> and 81.2% vs 72.7% in South America,  <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS4.p1.m5" class="ltx_Math" alttext="P&lt;10^{-4}" display="inline"><semantics><mrow><mi>P</mi><mo>&lt;</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">P&lt;10^{-4}</annotation></semantics></math>).
</p>
</div>
<div id="Sx3.SSx4.SSS4.p2" class="ltx_para">
<p class="ltx_p">These results suggest that maize adaptation to high altitudes has largely made use of standing genetic variation.
Recently, examples of adaptation from standing variation have been increased <cite class="ltx_cite"/>]Barrett_2008_18006185,Messer_2013_24075201, and
genome scan studies indicated that soft sweeps are plentiful in model organisms, Drosophila <cite class="ltx_cite"/> and human <cite class="ltx_cite"/>.
Our result is consistent with this view.
In the case of maize, it may not be surprising because the divergence events between low- and highland populations occurred very recently <cite class="ltx_cite"/>.
Adaptation vis <em class="ltx_emph">de novo</em> mutations requires a longer waiting time until new beneficial mutations are arisen.
Theoretically, the situation of maize would be consistent with standing variation scenario.
Selection from standing variation are common when scaled mutation rate, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS4.p2.m1" class="ltx_Math" display="inline" alttext="\Theta\geq 1"><semantics><mrow><mi mathvariant="normal">&#x398;</mi><mo>&#x2265;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\Theta\geq 1</annotation></semantics></math> and/or scaled selection coefficient (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS4.p2.m2" class="ltx_Math" alttext="Ns" display="inline"><semantics><mrow><mi>N</mi><mo>&#x2062;</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">Ns</annotation></semantics></math>) is enough large <cite class="ltx_cite"/>.
Maize should have large <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS4.p2.m3" class="ltx_Math" alttext="\Theta" display="inline"><semantics><mi mathvariant="normal">&#x398;</mi><annotation encoding="application/x-tex">\Theta</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS4.p2.m4" class="ltx_Math" display="inline" alttext="Ns"><semantics><mrow><mi>N</mi><mo>&#x2062;</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">Ns</annotation></semantics></math> because a long term effective population size is relatively large (synonymous nucleotide diversity = 0.014, <cite class="ltx_cite"/>]Tenaillon_2004_15014173,Wright_2005_15919994,Ross-Ibarra_2009_19153259).
The target size of mutations is also important; selection from standing variation occurs frequently as the target size is large.
No one knows the target size of maize&#x2026;</p>
</div>
<div id="Sx3.SSx4.SSS4.p3" class="ltx_para">
<p class="ltx_p">Because linkage disequilibrium in maize decays rapidly <cite class="ltx_cite"/> as in our data (Figure&#xA0;S7), it is plausible that a number of hard sweeps &#x2013; strong selection on new mutations &#x2013; would be missed by our data, but several lines of evidence suggest to us that this is unlikely.
</p>
</div>
</div>
<div id="Sx3.SSx4.SSS5" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection"><span class="ltx_tag ltx_tag_subsubsection">0.0.5 </span>Highland versus lowland adaptation</h4>

<div id="Sx3.SSx4.SSS5.p1" class="ltx_para">
<p class="ltx_p">Given the historical spread of maize from an origin in the lowlands, it is tempting to assume that significant population differentiation should be primarily due to an increase in frequency of adaptive alleles in the highlands.
To test this hypothesis, we sought to identify the adaptive allele at each locus using comparisons between Mexico and S. America as well as to <em class="ltx_emph">parviglumis</em> (Text&#xA0;S1).</p>
</div>
<div id="Sx3.SSx4.SSS5.p2" class="ltx_para">
<p class="ltx_p">Consistent with predictions, we infer that differentiation at 67.5% (414) and 75.9% (453) of SNPs in Mexico and S. America is due to adaptation in the highlands, with only 32.5% and 24.1% of SNPs inferred to be due to lowland adaptation after excluding the SNPs with ambiguous patterns (probably due to recombination).
The majority of these SNPs show patterns of haplotype variation consistent with our inference (Table&#xA0;S3).</p>
</div>
</div>
<div id="Sx3.SSx4.SSS6" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection"><span class="ltx_tag ltx_tag_subsubsection">0.0.6 </span>Adaptation through introgression</h4>

<div id="Sx3.SSx4.SSS6.p1" class="ltx_para">
<p class="ltx_p">A marked difference between highland adaptation of maize in Mexico and South America is the potential for adaptation through introgression from wild relatives.  While maize in Mexico grows in sympatry with both the lowland taxon <span class="ltx_text ltx_font_italic">parviglumis</span> and the highland taxon <span class="ltx_text ltx_font_italic">mexicana</span>, maize in South America is outside the range of wild <span class="ltx_text ltx_font_italic">Zea</span> species.
<cite class="ltx_cite">()</cite> recently assessed the potential for local adaptation in <span class="ltx_text ltx_font_italic">parviglumis</span> and <span class="ltx_text ltx_font_italic">mexicana</span> populations, characterizing differentiation between these subspecies using an Fst-outlier approach.
We observed a significant excess of overlap between our putatively adaptive SNPs in Mexican maize and those identified in the <cite class="ltx_cite">()</cite> analysis (Table&#xA0;<span class="ltx_ref ltx_ref_self">LABEL:tanja</span>; <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS6.p1.m1" class="ltx_Math" alttext="P&lt;0.01" display="inline"><semantics><mrow><mi>P</mi><mo>&lt;</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">P&lt;0.01</annotation></semantics></math> by FET). Similar to that paper, we also find that SNPs with significant <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS6.p1.m2" class="ltx_Math" alttext="F_{ST}" display="inline"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS6.p1.m3" class="ltx_Math" alttext="P" display="inline"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>-values are enriched in intergenic regions compared to non-sigificiant SNPs (51.3% vs. 44.2%; FET <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS6.p1.m4" class="ltx_Math" display="inline" alttext="P&lt;10^{-8}"><semantics><mrow><mi>P</mi><mo>&lt;</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">P&lt;10^{-8}</annotation></semantics></math>). Significant overlap was also observed between signficant SNPs in South America and teosinte (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS6.p1.m5" class="ltx_Math" alttext="P&lt;0.01" display="inline"><semantics><mrow><mi>P</mi><mo>&lt;</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">P&lt;0.01</annotation></semantics></math>), but the proportion of SNPs was lower than observed in Mexico.  These data suggest that adaptations in Mexican maize may have been obtained through gene flow with wild relatives.  To more fully explore this hypothesis we evaluated our data in light of introgression identified by <cite class="ltx_cite">()</cite> from <span class="ltx_text ltx_font_italic">mexicana</span> into maize in the Mexico highlands.
The proportion of significant SNPs in introgressed regions in Mexico is significantly higher than found in South America (FET <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS6.p1.m6" class="ltx_Math" alttext="P\ll 0.001" display="inline"><semantics><mrow><mi>P</mi><mo>&#x226A;</mo><mn>0.001</mn></mrow><annotation encoding="application/x-tex">P\ll 0.001</annotation></semantics></math>).
Outside introgressed regions, the Mexican and South American populations did not show marked differences in the proportion of significant SNPs (Fisher&#x2019;s exact test, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS6.p1.m7" class="ltx_Math" display="inline" alttext="P&gt;0.7"><semantics><mrow><mi>P</mi><mo>&gt;</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">P&gt;0.7</annotation></semantics></math>). These results combined with those from <cite class="ltx_cite">()</cite> suggest that SNPs in introgressed regions have indeed been under selection.</p>
</div>
</div>
<div id="Sx3.SSx4.SSS7" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection"><span class="ltx_tag ltx_tag_subsubsection">0.0.7 </span>No evidence for parallel adaptation</h4>

<div id="Sx3.SSx4.SSS7.p1" class="ltx_para">
<p class="ltx_p">While maize adaptation in Mexico and South America are likely distinguished by unique histories of gene flow with wild relatives, the potential remains for parallel adaptation in these two regions.
SNPs showing significant differentiation between low- and highland populations in both Mexico and South America are likely candidates for parallel adaptation.
We identify 56 SNPs with <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m1" class="ltx_Math" alttext="F_{ST}" display="inline"><semantics><msub><mi>F</mi><mrow><mi>S</mi><mo>&#x2062;</mo><mi>T</mi></mrow></msub><annotation encoding="application/x-tex">F_{ST}</annotation></semantics></math> p-values in Mexico (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m2" class="ltx_Math" display="inline" alttext="P_{M}"><semantics><msub><mi>P</mi><mi>M</mi></msub><annotation encoding="application/x-tex">P_{M}</annotation></semantics></math>) and South America (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m3" class="ltx_Math" display="inline" alttext="P_{S}"><semantics><msub><mi>P</mi><mi>S</mi></msub><annotation encoding="application/x-tex">P_{S}</annotation></semantics></math>) both <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m4" class="ltx_Math" alttext="&lt;0.01" display="inline"><semantics><mrow><mi/><mo>&lt;</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">&lt;0.01</annotation></semantics></math>.
This number  was significantly larger than the random expectation (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m5" class="ltx_Math" display="inline" alttext="48,370\times 0.01\times 0.01\approx 4.8"><semantics><mrow><mrow><mn>48</mn><mo>,</mo><mrow><mn>370</mn><mo>&#xD7;</mo><mn>0.01</mn><mo>&#xD7;</mo><mn>0.01</mn></mrow></mrow><mo>&#x2248;</mo><mn>4.8</mn></mrow><annotation encoding="application/x-tex">48,370\times 0.01\times 0.01\approx 4.8</annotation></semantics></math>; <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m6" class="ltx_Math" display="inline" alttext="\chi^{2}"><semantics><msup><mi>&#x3C7;</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^{2}</annotation></semantics></math>-test, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m7" class="ltx_Math" alttext="P\ll 0.001" display="inline"><semantics><mrow><mi>P</mi><mo>&#x226A;</mo><mn>0.001</mn></mrow><annotation encoding="application/x-tex">P\ll 0.001</annotation></semantics></math>).  Furthermore, the distribution of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m8" class="ltx_Math" display="inline" alttext="P_{M}"><semantics><msub><mi>P</mi><mi>M</mi></msub><annotation encoding="application/x-tex">P_{M}</annotation></semantics></math> in the 712 SNPs with <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m9" class="ltx_Math" alttext="P_{S}&lt;0.01" display="inline"><semantics><mrow><msub><mi>P</mi><mi>S</mi></msub><mo>&lt;</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">P_{S}&lt;0.01</annotation></semantics></math> was highly skewed toward zero (Figure&#xA0;S7A), and a similar tendency was observed in <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m10" class="ltx_Math" alttext="P_{S}" display="inline"><semantics><msub><mi>P</mi><mi>S</mi></msub><annotation encoding="application/x-tex">P_{S}</annotation></semantics></math> given <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m11" class="ltx_Math" display="inline" alttext="P_{M}&lt;0.01"><semantics><mrow><msub><mi>P</mi><mi>M</mi></msub><mo>&lt;</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">P_{M}&lt;0.01</annotation></semantics></math> (935 SNPs; Figure&#xA0;S7AB).  Thus, we converted the <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m12" class="ltx_Math" alttext="P" display="inline"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>-values in one population given <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m13" class="ltx_Math" alttext="P&lt;0.01" display="inline"><semantics><mrow><mi>P</mi><mo>&lt;</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">P&lt;0.01</annotation></semantics></math> in the other population into <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m14" class="ltx_Math" display="inline" alttext="q"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>-values.
At a false discovery rate of 0.2 we found 117 SNPs with <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m15" class="ltx_Math" alttext="P_{M}&lt;0.01\cap P_{S}&lt;0.0169" display="inline"><semantics><mrow><msub><mi>P</mi><mi>M</mi></msub><mo>&lt;</mo><mrow><mn>0.01</mn><mo>&#x2229;</mo><msub><mi>P</mi><mi>S</mi></msub></mrow><mo>&lt;</mo><mn>0.0169</mn></mrow><annotation encoding="application/x-tex">P_{M}&lt;0.01\cap P_{S}&lt;0.0169</annotation></semantics></math> or <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m16" class="ltx_Math" display="inline" alttext="P_{M}&lt;0.0247\cap P_{S}&lt;0.01"><semantics><mrow><msub><mi>P</mi><mi>M</mi></msub><mo>&lt;</mo><mrow><mn>0.0247</mn><mo>&#x2229;</mo><msub><mi>P</mi><mi>S</mi></msub></mrow><mo>&lt;</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">P_{M}&lt;0.0247\cap P_{S}&lt;0.01</annotation></semantics></math>, and these SNPs were considered our candidates for parallel adaptation.
We found 959 SNPs showing significant population differentiation only in Mexico (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m17" class="ltx_Math" alttext="P_{M}&lt;0.01\cap P_{S}&gt;0.0169" display="inline"><semantics><mrow><msub><mi>P</mi><mi>M</mi></msub><mo>&#x2062;</mo><mrow><mo>&lt;</mo><mrow><mn>0.01</mn><mo>&#x2229;</mo><msub><mi>P</mi><mi>S</mi></msub></mrow><mo>&gt;</mo></mrow><mo>&#x2062;</mo><mn>0.0169</mn></mrow><annotation encoding="application/x-tex">P_{M}&lt;0.01\cap P_{S}&gt;0.0169</annotation></semantics></math>) and 664 SNPs only in South America  (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m18" class="ltx_Math" alttext="P_{M}&gt;0.0247\cap P_{S}&lt;0.01" display="inline"><semantics><mrow><msub><mi>P</mi><mi>M</mi></msub><mo>&gt;</mo><mrow><mn>0.0247</mn><mo>&#x2229;</mo><msub><mi>P</mi><mi>S</mi></msub></mrow><mo>&lt;</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">P_{M}&gt;0.0247\cap P_{S}&lt;0.01</annotation></semantics></math>).  The scatter plot of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m19" class="ltx_Math" display="inline" alttext="P_{M}"><semantics><msub><mi>P</mi><mi>M</mi></msub><annotation encoding="application/x-tex">P_{M}</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m20" class="ltx_Math" display="inline" alttext="P_{S}"><semantics><msub><mi>P</mi><mi>S</mi></msub><annotation encoding="application/x-tex">P_{S}</annotation></semantics></math> is shown in Figure&#xA0;<a href="#Sx3.F5" title="Figure&#xA0;5 &#x2023; Population differentiation under inferred demography &#x2023; Results and Discussion &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
For a subset of 67 of the SNPs showing putative evidence of parallel adaptation we also had data from <span class="ltx_text ltx_font_italic">parviglumis</span> and were able to infer based on patterns of segregation whether these SNPs were potentially adaptive under lowland or highland conditions.  Surprisingly, SNPs identified as targets of parallel adaptation in Mexico and South America more frequently show segregation patterns consistent with lowland adaptation (62 SNPs) than highland adaptation (5 SNPs).
In addition to evaluating parallel adaptation at the SNP level, we investigated how often different SNPs in the same gene may have been targeted by selection. To search for this pattern, we define a &#x201D;genetic unit&#x201D; or GU as all SNPs within 10kb of a transcript.  SNPs in an miRNA or second transcript within 10kb of the transcript of interest were excluded.
We classified SNPs showing significance in Mexico, South America or in both regions into 1,277 GUs.
Of these, 95 GUs contained at least one SNP with a pattern of differentiation suggesting parallel adaptation, whereas only 12 GUs contained both Mexico-specific and SA-specific significant SNPs.
Overall, fewer GUs showed evidence of parallel adaptation than expected by chance (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx4.SSS7.p1.m21" class="ltx_Math" display="inline" alttext="P&lt;10^{-5}"><semantics><mrow><mi>P</mi><mo>&lt;</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">P&lt;10^{-5}</annotation></semantics></math>), with more than 700 and 470 GUs showing Mexico-specific and SA-specific significant SNPs, respectively.
Despite similar phenotypes and environments, we thus see little evidence for parallel adaptation at either the SNP or the gene (GU) level.
This contrasts with data from humans <cite class="ltx_cite">()</cite> showing frequent evidence of selection on the same genes in multiple pairs of tropical and temperate human populations.
</p>
</div>
</div>
</div>
<div id="Sx3.SSx5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Comparison to theory</h3>

<div id="Sx3.SSx5.p1" class="ltx_para">
<p class="ltx_p">For a final point of comparison,
we assessed the degree of parallelism expected under a spatially explicit population genetic model.
We estimate the (maize) population density <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m1" class="ltx_Math" alttext="\rho" display="inline"><semantics><mi>&#x3C1;</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math> of the highlands to be around
(0.5 people/km<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m2" class="ltx_Math" display="inline" alttext="{}^{2}"><semantics><msup><mi/><mn>2</mn></msup><annotation encoding="application/x-tex">{}^{2}</annotation></semantics></math>) <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m3" class="ltx_Math" display="inline" alttext="\times"><semantics><mo>&#xD7;</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math> (0.5 ha field/person) <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m4" class="ltx_Math" alttext="\times" display="inline"><semantics><mo>&#xD7;</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math> (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m5" class="ltx_Math" alttext="2\times 10^{4}" display="inline"><semantics><mrow><mn>2</mn><mo>&#xD7;</mo><msup><mn>10</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">2\times 10^{4}</annotation></semantics></math> plants per field ha) <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m6" class="ltx_Math" alttext="=" display="inline"><semantics><mo>=</mo><annotation encoding="application/x-tex">=</annotation></semantics></math> 5,000 plants per km<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m7" class="ltx_Math" alttext="{}^{2}" display="inline"><semantics><msup><mi/><mn>2</mn></msup><annotation encoding="application/x-tex">{}^{2}</annotation></semantics></math>.
The area of the Andean highlands is around <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m8" class="ltx_Math" alttext="A=500\text{km}^{2}" display="inline"><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mn>500</mn><mo>&#x2062;</mo><msup><mtext>km</mtext><mn>2</mn></msup></mrow></mrow><annotation encoding="application/x-tex">A=500\text{km}^{2}</annotation></semantics></math>, leading to a total population of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m9" class="ltx_Math" alttext="A\rho=2.5\times 10^{6}" display="inline"><semantics><mrow><mrow><mi>A</mi><mo>&#x2062;</mo><mi>&#x3C1;</mi></mrow><mo>=</mo><mrow><mn>2.5</mn><mo>&#xD7;</mo><msup><mn>10</mn><mn>6</mn></msup></mrow></mrow><annotation encoding="application/x-tex">A\rho=2.5\times 10^{6}</annotation></semantics></math>.
Combined with an offspring variance of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m10" class="ltx_Math" display="inline" alttext="\xi^{2}=30"><semantics><mrow><msup><mi>&#x3BE;</mi><mn>2</mn></msup><mo>=</mo><mn>30</mn></mrow><annotation encoding="application/x-tex">\xi^{2}=30</annotation></semantics></math>,
we can compute the rate <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m11" class="ltx_Math" display="inline" alttext="\lambda_{\text{mut}}"><semantics><msub><mi>&#x3BB;</mi><mtext>mut</mtext></msub><annotation encoding="application/x-tex">\lambda_{\text{mut}}</annotation></semantics></math> at which newly adapted alleles arise in the population.
We observe that even if there is strong selection for an allele at high elevation (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m12" class="ltx_Math" alttext="s_{b}=0.1" display="inline"><semantics><mrow><msub><mi>s</mi><mi>b</mi></msub><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">s_{b}=0.1</annotation></semantics></math>),
a single-base mutation with mutation rate <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m13" class="ltx_Math" alttext="\mu=10^{-8}" display="inline"><semantics><mrow><mi>&#x3BC;</mi><mo>=</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mu=10^{-8}</annotation></semantics></math> would still take at least 6,000 generations to appear and fix.
On the other hand, a kilobase-sized target with mutation rate <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m14" class="ltx_Math" alttext="\mu=10^{-5}" display="inline"><semantics><mrow><mi>&#x3BC;</mi><mo>=</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mu=10^{-5}</annotation></semantics></math>
with this selection coefficient would appear and begin to fix in only 6 generations,
while more weakly selected alleles with <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m15" class="ltx_Math" alttext="s_{b}" display="inline"><semantics><msub><mi>s</mi><mi>b</mi></msub><annotation encoding="application/x-tex">s_{b}</annotation></semantics></math> of <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m16" class="ltx_Math" display="inline" alttext="10^{-2}"><semantics><msup><mn>10</mn><mrow><mo>-</mo><mn>2</mn></mrow></msup><annotation encoding="application/x-tex">10^{-2}</annotation></semantics></math> or <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m17" class="ltx_Math" display="inline" alttext="10^{-3}"><semantics><msup><mn>10</mn><mrow><mo>-</mo><mn>3</mn></mrow></msup><annotation encoding="application/x-tex">10^{-3}</annotation></semantics></math> would take hundreds or thousands of generations, respectively.
(Note that the time scales linearly with the selection coefficient: at these values <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p1.m18" class="ltx_Math" display="inline" alttext="T_{\text{mut}}=1/\lambda_{\text{mut}}\approx\mu s_{b}\times 1.6\times 10^{5}"><semantics><mrow><msub><mi>T</mi><mtext>mut</mtext></msub><mo>=</mo><mrow><mn>1</mn><mo>/</mo><msub><mi>&#x3BB;</mi><mtext>mut</mtext></msub></mrow><mo>&#x2248;</mo><mrow><mrow><mi>&#x3BC;</mi><mo>&#x2062;</mo><msub><mi>s</mi><mi>b</mi></msub></mrow><mo>&#xD7;</mo><mn>1.6</mn><mo>&#xD7;</mo><msup><mn>10</mn><mn>5</mn></msup></mrow></mrow><annotation encoding="application/x-tex">T_{\text{mut}}=1/\lambda_{\text{mut}}\approx\mu s_{b}\times 1.6\times 10^{5}</annotation></semantics></math>.)
Therefore, we might expect to see parallel changes of similar effect at the level of genes (e.g.&#xA0;disabling mutations),
but would not expect to see adaptive SNPs that arise through independent mutation in the two populations.</p>
</div>
<div id="Sx3.SSx5.p2" class="ltx_para">
<p class="ltx_p">Parallel SNP changes seem unlikely from new mutation;
what about gene flow between the highlands?
From the demographic model above
we have estimated that <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m1" class="ltx_Math" display="inline" alttext="\sigma\approx 1.8"><semantics><mrow><mi>&#x3C3;</mi><mo>&#x2248;</mo><mn>1.8</mn></mrow><annotation encoding="application/x-tex">\sigma\approx 1.8</annotation></semantics></math> kilometers per generation,
so with <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m2" class="ltx_Math" display="inline" alttext="10^{-1}\geq s_{m}\geq 10^{-4}"><semantics><mrow><msup><mn>10</mn><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>&#x2265;</mo><msub><mi>s</mi><mi>m</mi></msub><mo>&#x2265;</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">10^{-1}\geq s_{m}\geq 10^{-4}</annotation></semantics></math> the distance <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m3" class="ltx_Math" display="inline" alttext="\sigma/\sqrt{2s_{m}}"><semantics><mrow><mi>&#x3C3;</mi><mo>/</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>m</mi></msub></mrow></msqrt></mrow><annotation encoding="application/x-tex">\sigma/\sqrt{2s_{m}}</annotation></semantics></math> over which the frequency of
a highland-adaptive, lowland-deleterious allele decays into the lowlands
is still short: between 4 and 150 kilometers.
Since the Mexican and Andean highlands are around 4,000 km apart,
the time needed for a rare allele, with selective cost <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m4" class="ltx_Math" display="inline" alttext="s_{m}=10^{-3}"><semantics><mrow><msub><mi>s</mi><mi>m</mi></msub><mo>=</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">s_{m}=10^{-3}</annotation></semantics></math> in the lowlands, to transit between the two highlands
is <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m5" class="ltx_Math" alttext="T_{\text{mig}}\approx 5\times 10^{34}" display="inline"><semantics><mrow><msub><mi>T</mi><mtext>mig</mtext></msub><mo>&#x2248;</mo><mrow><mn>5</mn><mo>&#xD7;</mo><msup><mn>10</mn><mn>34</mn></msup></mrow></mrow><annotation encoding="application/x-tex">T_{\text{mig}}\approx 5\times 10^{34}</annotation></semantics></math> generations.
In other words, from these calculations it is almost impossible that an allele that is deleterious at low elevation with <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m6" class="ltx_Math" alttext="s_{m}=10^{-3}" display="inline"><semantics><mrow><msub><mi>s</mi><mi>m</mi></msub><mo>=</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">s_{m}=10^{-3}</annotation></semantics></math>
would ever transit from the Mexican to the Andean highlands.
If the selection against the allele is even weaker (<math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m7" class="ltx_Math" alttext="s_{m}=10^{-4}" display="inline"><semantics><mrow><msub><mi>s</mi><mi>m</mi></msub><mo>=</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">s_{m}=10^{-4}</annotation></semantics></math>) it is still expected to take <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m8" class="ltx_Math" alttext="T_{\text{mig}}=1.8\times 10^{8}" display="inline"><semantics><mrow><msub><mi>T</mi><mtext>mig</mtext></msub><mo>=</mo><mrow><mn>1.8</mn><mo>&#xD7;</mo><msup><mn>10</mn><mn>8</mn></msup></mrow></mrow><annotation encoding="application/x-tex">T_{\text{mig}}=1.8\times 10^{8}</annotation></semantics></math> generations.
However, shorter distances could be transited by very weakly deleterious alleles &#x2013;
if the distance between highland patches <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m9" class="ltx_Math" display="inline" alttext="R"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math> is 1,000 km (or if <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m10" class="ltx_Math" alttext="\sigma" display="inline"><semantics><mi>&#x3C3;</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math> is four times larger)
then with <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m11" class="ltx_Math" display="inline" alttext="s_{m}=10^{-4}"><semantics><mrow><msub><mi>s</mi><mi>m</mi></msub><mo>=</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">s_{m}=10^{-4}</annotation></semantics></math> the time <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m12" class="ltx_Math" display="inline" alttext="T_{\text{mig}}"><semantics><msub><mi>T</mi><mtext>mig</mtext></msub><annotation encoding="application/x-tex">T_{\text{mig}}</annotation></semantics></math> is about 1.6 generations &#x2013;
so, adaptation by migration is certain in the known timeframe of maize diffusion.
This is strongly dependent on the magnitude of the deleterious selection coefficient: for example,
with <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m13" class="ltx_Math" display="inline" alttext="s_{m}=10^{-3}"><semantics><mrow><msub><mi>s</mi><mi>m</mi></msub><mo>=</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">s_{m}=10^{-3}</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m14" class="ltx_Math" display="inline" alttext="T_{\text{mig}}"><semantics><msub><mi>T</mi><mtext>mig</mtext></msub><annotation encoding="application/x-tex">T_{\text{mig}}</annotation></semantics></math> is <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p2.m15" class="ltx_Math" alttext="2.3\times 10^{6}" display="inline"><semantics><mrow><mn>2.3</mn><mo>&#xD7;</mo><msup><mn>10</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">2.3\times 10^{6}</annotation></semantics></math> generations.</p>
</div>
<div id="Sx3.SSx5.p3" class="ltx_para">
<p class="ltx_p">This suggests that even when highland-adaptive mutations are weakly deleterious in the lowlands,
gene flow will not result in shared adaptations.
The situation where these are neutral in the lowlands is more difficult to model,
but we can make some informed guesses.
Maize in the Andean highlands, say, would have inherited a lowland-neutral, highland-adapted allele from the Mexican highlands
if some of the ancestral lineages along which the modern Andean plants have inherited at that locus trace back to the Mexican highlands
at some point since the appearance of the allele in Mexico.
If the allele is neutral in the lowlands, we can treat this as a neutral process,
using the framework of coalescent theory <cite class="ltx_cite">()</cite>.
To do this, we need to follow <em class="ltx_emph">all</em> of the <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m1" class="ltx_Math" display="inline" alttext="N\approx 2.5\times 10^{6}"><semantics><mrow><mi>N</mi><mo>&#x2248;</mo><mrow><mn>2.5</mn><mo>&#xD7;</mo><msup><mn>10</mn><mn>6</mn></msup></mrow></mrow><annotation encoding="application/x-tex">N\approx 2.5\times 10^{6}</annotation></semantics></math> lineages backwards; these quickly coalesce to fewer <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m2" class="ltx_Math" alttext="m" display="inline"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math> lineages
in approximately <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m3" class="ltx_Math" display="inline" alttext="\sum_{k=m}^{N}\frac{2N}{\xi^{2}k(k+1)}\approx 1.25\times 10^{5}/m"><semantics><mrow><mrow><msubsup><mo>&#x2211;</mo><mrow><mi>k</mi><mo>=</mo><mi>m</mi></mrow><mi>N</mi></msubsup><mfrac><mrow><mn>2</mn><mo>&#x2062;</mo><mi>N</mi></mrow><mrow><msup><mi>&#x3BE;</mi><mn>2</mn></msup><mo>&#x2062;</mo><mi>k</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow></mfrac></mrow><mo>&#x2248;</mo><mrow><mrow><mn>1.25</mn><mo>&#xD7;</mo><msup><mn>10</mn><mn>5</mn></msup></mrow><mo>/</mo><mi>m</mi></mrow></mrow><annotation encoding="application/x-tex">\sum_{k=m}^{N}\frac{2N}{\xi^{2}k(k+1)}\approx 1.25\times 10^{5}/m</annotation></semantics></math> generations,
leaving about 1000 lineages after 100 generations that are spread over a larger area.
The displacement of a lineage after <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m4" class="ltx_Math" display="inline" alttext="m"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math> generations has variance <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m5" class="ltx_Math" alttext="m\sigma^{2}" display="inline"><semantics><mrow><mi>m</mi><mo>&#x2062;</mo><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">m\sigma^{2}</annotation></semantics></math> and is approximately Gaussian.
If we assume that <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m6" class="ltx_Math" display="inline" alttext="n"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> lineages are independent, and <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m7" class="ltx_Math" display="inline" alttext="Z_{n}"><semantics><msub><mi>Z</mi><mi>n</mi></msub><annotation encoding="application/x-tex">Z_{n}</annotation></semantics></math> is the distance to the furthest lineage,
then <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m8" class="ltx_Math" alttext="\mathbb{P}\{Z_{n}/\sqrt{m\sigma^{2}}\leq x/\sqrt{2\log n}+\sqrt{2\log n}-(1/2)%&#10;(\log\log n+\log 4\pi)/\sqrt{2\log n}\}\approx\exp(-e^{-x})" display="inline"><semantics><mrow><mi>&#x2119;</mi><mrow><mo>{</mo><msub><mi>Z</mi><mi>n</mi></msub><mo>/</mo><msqrt><mrow><mi>m</mi><mo>&#x2062;</mo><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow></msqrt><mo>&#x2264;</mo><mi>x</mi><mo>/</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><mrow><mi>log</mi><mo>&#x2061;</mo><mi>n</mi></mrow></mrow></msqrt><mo>+</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><mrow><mi>log</mi><mo>&#x2061;</mo><mi>n</mi></mrow></mrow></msqrt><mo>-</mo><mrow><mo>(</mo><mn>1</mn><mo>/</mo><mn>2</mn><mo>)</mo></mrow><mrow><mo>(</mo><mi>log</mi><mi>log</mi><mi>n</mi><mo>+</mo><mi>log</mi><mn>4</mn><mi>&#x3C0;</mi><mo>)</mo></mrow><mo>/</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><mrow><mi>log</mi><mo>&#x2061;</mo><mi>n</mi></mrow></mrow></msqrt><mo>}</mo></mrow><mo>&#x2248;</mo><mi>exp</mi><mrow><mo>(</mo><mo>-</mo><msup><mi>e</mi><mrow><mo>-</mo><mi>x</mi></mrow></msup><mo>)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{P}\{Z_{n}/\sqrt{m\sigma^{2}}\leq x/\sqrt{2\log n}+\sqrt{2\log n}-(1/2)%
(\log\log n+\log 4\pi)/\sqrt{2\log n}\}\approx\exp(-e^{-x})</annotation></semantics></math>
<cite class="ltx_cite">()</cite>.
With <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m9" class="ltx_Math" alttext="n=1000" display="inline"><semantics><mrow><mi>n</mi><mo>=</mo><mn>1000</mn></mrow><annotation encoding="application/x-tex">n=1000</annotation></semantics></math>, the typical distance to the furthest displacement after <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m10" class="ltx_Math" alttext="m=1000" display="inline"><semantics><mrow><mi>m</mi><mo>=</mo><mn>1000</mn></mrow><annotation encoding="application/x-tex">m=1000</annotation></semantics></math> generations is <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m11" class="ltx_Math" display="inline" alttext="\sqrt{2\sigma^{2}m\log n}212"><semantics><mrow><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><msup><mi>&#x3C3;</mi><mn>2</mn></msup><mo>&#x2062;</mo><mi>m</mi><mo>&#x2062;</mo><mrow><mi>log</mi><mo>&#x2061;</mo><mi>n</mi></mrow></mrow></msqrt><mo>&#x2062;</mo><mn>212</mn></mrow><annotation encoding="application/x-tex">\sqrt{2\sigma^{2}m\log n}212</annotation></semantics></math>km;
after <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m12" class="ltx_Math" alttext="m=6000" display="inline"><semantics><mrow><mi>m</mi><mo>=</mo><mn>6000</mn></mrow><annotation encoding="application/x-tex">m=6000</annotation></semantics></math> generations it is <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m13" class="ltx_Math" display="inline" alttext="\approx 518"><semantics><mrow><mi/><mo>&#x2248;</mo><mn>518</mn></mrow><annotation encoding="application/x-tex">\approx 518</annotation></semantics></math>km.
In either case, the chance that the maximum is larger than 1,000km after 6,000 generations is well less than <math xmlns="http://www.w3.org/1998/Math/MathML" id="Sx3.SSx5.p3.m14" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics><msup><mn>10</mn><mrow><mo>-</mo><mn>4</mn></mrow></msup><annotation encoding="application/x-tex">10^{-4}</annotation></semantics></math>.
Of course, this is under an equilibrium population model; and maize reached the Andean highlands only around 4,000 years ago.
Nonetheless, this suggests that even highland-adapted allele that are merely neutral in the lowlands
would have difficulty moving between the Mexican and Andean highlands in a few thousand generations.</p>
</div>
<div id="Sx3.SSx5.p4" class="ltx_para">
<p class="ltx_p">Based on our spatially explicit population genetic model,
parallel adaptation involving identical nucleotide changes is quite unlikely under either scenarios of independent mutation
or transit of Central America by undirected (diffusive) sharing of seed.
However, independent mutations could be expected in kilobase-sized targets,
suggesting there might be signal for genes that share adaptive changes.
These conclusions could change if we drastically underestimate the rate of very-long-distance sharing of seed,
e.g.&#xA0;if sharing across hundreds of kilometers was common at some point.</p>
</div>
</div>
</div>
<div id="Sx4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conclusions</h2>

<div id="Sx4.p1" class="ltx_para">
<p class="ltx_p">1. We successfully inferred demography and detected the candidates of adaptive loci to highland climates in Mexico and South America by utilizing GBS and 55-k chip.</p>
</div>
<div id="Sx4.p2" class="ltx_para">
<p class="ltx_p">2. The main conclusion is parallel adaptation is rare in maize highland adaptation.</p>
</div><span class="ltx_ERROR undefined">{acknowledgments}</span>
<div id="Sx4.p3" class="ltx_para">
<p class="ltx_p">We appreciate the helpful comments of P. Morrell and the members of Ross-Ibarra lab and Coop labs.
</p>
</div>
</div>
<div id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

</div><span class="ltx_ERROR undefined">\suppl</span>
<div id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section"><span class="ltx_tag ltx_tag_section">1 </span>Details of the demographic model</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p">Throughout we use in many ways the <span class="ltx_text ltx_font_italic">branching process approximation</span> &#x2013;
if an allele is locally rare, then for at least a few generations,
the fates of each offspring are nearly independent.
So, if the allele is locally deleterious, the total numbers of that allele behave as a subcritical branching process,
destined for ultimate extinction.
On the other hand, if the allele is advantageous,
it will either die out or become locally common, with its fate determined in the first few generations.
If the number of offspring of an individual with this allele is the random variable <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m1" class="ltx_Math" alttext="X" display="inline"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>,
with mean <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m2" class="ltx_Math" alttext="\mathbb{E}[X]=1+s" display="inline"><semantics><mrow><mrow><mi>&#x1D53C;</mi><mo>&#x2062;</mo><mrow><mo>[</mo><mi>X</mi><mo>]</mo></mrow></mrow><mo>=</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[X]=1+s</annotation></semantics></math> (selective advantage <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m3" class="ltx_Math" alttext="s&gt;0" display="inline"><semantics><mrow><mi>s</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">s&gt;0</annotation></semantics></math>), variance <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m4" class="ltx_Math" display="inline" alttext="\mathop{\mbox{Var}}[X]=\xi^{2}"><semantics><mrow><mrow><mtext>Var</mtext><mrow><mo>[</mo><mi>X</mi><mo>]</mo></mrow></mrow><mo>=</mo><msup><mi>&#x3BE;</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathop{\mbox{Var}}[X]=\xi^{2}</annotation></semantics></math>, and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m5" class="ltx_Math" display="inline" alttext="\mathbb{P}\{X=0\}&gt;0"><semantics><mrow><mi>&#x2119;</mi><mrow><mo>{</mo><mi>X</mi><mo>=</mo><mn>0</mn><mo>}</mo></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbb{P}\{X=0\}&gt;0</annotation></semantics></math> (some chance of leaving no offspring),
then the probability of local nonextinction <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m6" class="ltx_Math" alttext="p_{*}" display="inline"><semantics><msub><mi>p</mi><mo>*</mo></msub><annotation encoding="application/x-tex">p_{*}</annotation></semantics></math> is approximately <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m7" class="ltx_Math" alttext="p_{*}\approx 2s/\xi^{2}" display="inline"><semantics><mrow><msub><mi>p</mi><mo>*</mo></msub><mo>&#x2248;</mo><mrow><mrow><mn>2</mn><mo>&#x2062;</mo><mi>s</mi></mrow><mo>/</mo><msup><mi>&#x3BE;</mi><mn>2</mn></msup></mrow></mrow><annotation encoding="application/x-tex">p_{*}\approx 2s/\xi^{2}</annotation></semantics></math> to second order in <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m8" class="ltx_Math" display="inline" alttext="s"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>.
The precise value can be found by defining the generating function <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m9" class="ltx_Math" display="inline" alttext="\Phi(u)=\mathbb{E}[u^{X}]"><semantics><mrow><mrow><mi mathvariant="normal">&#x3A6;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mi>u</mi><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mi>&#x1D53C;</mi><mo>&#x2062;</mo><mrow><mo>[</mo><msup><mi>u</mi><mi>X</mi></msup><mo>]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\Phi(u)=\mathbb{E}[u^{X}]</annotation></semantics></math>;
the probability of local nonextinction <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m10" class="ltx_Math" alttext="p_{*}" display="inline"><semantics><msub><mi>p</mi><mo>*</mo></msub><annotation encoding="application/x-tex">p_{*}</annotation></semantics></math> is the minimal solution to <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m11" class="ltx_Math" alttext="\Phi(1-u)=1-u" display="inline"><semantics><mrow><mrow><mi mathvariant="normal">&#x3A6;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mi>u</mi></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mn>1</mn><mo>-</mo><mi>u</mi></mrow></mrow><annotation encoding="application/x-tex">\Phi(1-u)=1-u</annotation></semantics></math>.
(This can be seen because: <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m12" class="ltx_Math" display="inline" alttext="1-p_{*}"><semantics><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mo>*</mo></msub></mrow><annotation encoding="application/x-tex">1-p_{*}</annotation></semantics></math> is the probability that an individual&#x2019;s family dies out;
this is equal to the probability that the families of all that individuals&#x2019; children die out;
since each child&#x2019;s family behaves independently, if the individual has <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m13" class="ltx_Math" alttext="x" display="inline"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math> offspring, this is equal to <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m14" class="ltx_Math" alttext="(1-p_{*})^{x}" display="inline"><semantics><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mo>*</mo></msub></mrow><mo>)</mo></mrow><mi>x</mi></msup><annotation encoding="application/x-tex">(1-p_{*})^{x}</annotation></semantics></math>;
and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p1.m15" class="ltx_Math" alttext="\Phi(1-p_{*})=\mathbb{E}[(1-p_{*})^{X}]" display="inline"><semantics><mrow><mrow><mi mathvariant="normal">&#x3A6;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mo>*</mo></msub></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mi>&#x1D53C;</mi><mo>&#x2062;</mo><mrow><mo>[</mo><msup><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mo>*</mo></msub></mrow><mo>)</mo></mrow><mi>X</mi></msup><mo>]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\Phi(1-p_{*})=\mathbb{E}[(1-p_{*})^{X}]</annotation></semantics></math>.)</p>
</div>
<div id="S1.p2" class="ltx_para">
<p class="ltx_p">If the selective advantage (<math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p2.m1" class="ltx_Math" alttext="s" display="inline"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>) depends on geographic location,
a similar fact holds: index spatial location by <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p2.m2" class="ltx_Math" display="inline" alttext="i\in 1,\ldots,n"><semantics><mrow><mi>i</mi><mo>&#x2208;</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="normal">&#x2026;</mi><mo>,</mo><mi>n</mi></mrow></mrow><annotation encoding="application/x-tex">i\in 1,\ldots,n</annotation></semantics></math>,
and for <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p2.m3" class="ltx_Math" display="inline" alttext="u=(u_{1},u_{2},\ldots,u_{n})"><semantics><mrow><mi>u</mi><mo>=</mo><mrow><mo>(</mo><mrow><msub><mi>u</mi><mn>1</mn></msub><mo>,</mo><msub><mi>u</mi><mn>2</mn></msub><mo>,</mo><mi mathvariant="normal">&#x2026;</mi><mo>,</mo><msub><mi>u</mi><mi>n</mi></msub></mrow><mo>)</mo></mrow></mrow><annotation encoding="application/x-tex">u=(u_{1},u_{2},\ldots,u_{n})</annotation></semantics></math> define the functions <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p2.m4" class="ltx_Math" alttext="\Phi_{i}(u)=\mathbb{E}[\prod_{j}u_{j}^{X_{ij}}]" display="inline"><semantics><mrow><mrow><msub><mi mathvariant="normal">&#x3A6;</mi><mi>i</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mi>u</mi><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mi>&#x1D53C;</mi><mo>&#x2062;</mo><mrow><mo>[</mo><mrow><msub><mo>&#x220F;</mo><mi>j</mi></msub><msubsup><mi>u</mi><mi>j</mi><msub><mi>X</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi></mrow></msub></msubsup></mrow><mo>]</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\Phi_{i}(u)=\mathbb{E}[\prod_{j}u_{j}^{X_{ij}}]</annotation></semantics></math>,
where <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p2.m5" class="ltx_Math" display="inline" alttext="X_{ij}"><semantics><msub><mi>X</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">X_{ij}</annotation></semantics></math> is the (random) number of offspring that an individual at <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p2.m6" class="ltx_Math" alttext="i" display="inline"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> produces at location <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p2.m7" class="ltx_Math" display="inline" alttext="j"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.
Then <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p2.m8" class="ltx_Math" display="inline" alttext="p_{*}=(p_{*1},\ldots,p_{*n})"><semantics><mrow><msub><mi>p</mi><mo>*</mo></msub><mo>=</mo><mrow><mo>(</mo><mrow><msub><mi>p</mi><mrow><mi/><mo>*</mo><mn>1</mn></mrow></msub><mo>,</mo><mi mathvariant="normal">&#x2026;</mi><mo>,</mo><msub><mi>p</mi><mrow><mi/><mo>*</mo><mi>n</mi></mrow></msub></mrow><mo>)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{*}=(p_{*1},\ldots,p_{*n})</annotation></semantics></math>, the vector of probabilities that a new mutation at each location eventually fixes,
is the minimal solution to <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p2.m9" class="ltx_Math" display="inline" alttext="\Phi(1-p_{*})=1-p_{*}"><semantics><mrow><mrow><mi mathvariant="normal">&#x3A6;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mo>*</mo></msub></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mo>*</mo></msub></mrow></mrow><annotation encoding="application/x-tex">\Phi(1-p_{*})=1-p_{*}</annotation></semantics></math>,
i.e.&#xA0;<math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p2.m10" class="ltx_Math" alttext="\Phi_{i}(1-p_{*})=1-p_{*i}" display="inline"><semantics><mrow><mrow><msub><mi mathvariant="normal">&#x3A6;</mi><mi>i</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mo>*</mo></msub></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mrow><mi/><mo>*</mo><mi>i</mi></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">\Phi_{i}(1-p_{*})=1-p_{*i}</annotation></semantics></math>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p class="ltx_p">Here we consider a linear habitat, so that the selection coefficient at location <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p3.m1" class="ltx_Math" display="inline" alttext="\ell_{i}"><semantics><msub><mi mathvariant="normal">&#x2113;</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\ell_{i}</annotation></semantics></math> is <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p3.m2" class="ltx_Math" alttext="s_{i}=\min(s_{b},\max(-s_{d},\alpha\ell_{i}))" display="inline"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mrow><mo>min</mo><mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mi>s</mi><mi>b</mi></msub><mo>,</mo><mrow><mo>max</mo><mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mrow><mo>-</mo><msub><mi>s</mi><mi>d</mi></msub></mrow><mo>,</mo><mrow><mi>&#x3B1;</mi><mo>&#x2062;</mo><msub><mi mathvariant="normal">&#x2113;</mi><mi>i</mi></msub></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">s_{i}=\min(s_{b},\max(-s_{d},\alpha\ell_{i}))</annotation></semantics></math>.
There does not seem to be a nice analytic expression for <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p3.m3" class="ltx_Math" display="inline" alttext="p_{*}"><semantics><msub><mi>p</mi><mo>*</mo></msub><annotation encoding="application/x-tex">p_{*}</annotation></semantics></math> in this case,
but since <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p3.m4" class="ltx_Math" display="inline" alttext="1-p_{*}"><semantics><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mo>*</mo></msub></mrow><annotation encoding="application/x-tex">1-p_{*}</annotation></semantics></math> is a fixed point of <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p3.m5" class="ltx_Math" alttext="\Phi" display="inline"><semantics><mi mathvariant="normal">&#x3A6;</mi><annotation encoding="application/x-tex">\Phi</annotation></semantics></math>, the solution can be found by iteration:
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p3.m6" class="ltx_Math" display="inline" alttext="1-p_{*}=\lim_{n\to\infty}\Phi^{n}(u)"><semantics><mrow><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mo>*</mo></msub></mrow><mo>=</mo><mrow><msub><mo>lim</mo><mrow><mi>n</mi><mo>&#x2192;</mo><mi mathvariant="normal">&#x221E;</mi></mrow></msub><mo>&#x2061;</mo><mrow><msup><mi mathvariant="normal">&#x3A6;</mi><mi>n</mi></msup><mo>&#x2062;</mo><mrow><mo>(</mo><mi>u</mi><mo>)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">1-p_{*}=\lim_{n\to\infty}\Phi^{n}(u)</annotation></semantics></math> for an appropriate starting point <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.p3.m7" class="ltx_Math" alttext="u" display="inline"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>.</p>
</div>
<div id="S1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">1.1 </span>Maize model</h3>

<div id="S1.SS1.p1" class="ltx_para">
<p class="ltx_p">Specifically, the migration and reproduction dynamics we use are as follows.
On a large scale,
fields of <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m1" class="ltx_Math" alttext="N" display="inline"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math> plants are replanted each year from <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m2" class="ltx_Math" alttext="N_{f}" display="inline"><semantics><msub><mi>N</mi><mi>f</mi></msub><annotation encoding="application/x-tex">N_{f}</annotation></semantics></math> ears,
either from completely new stock (with probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m3" class="ltx_Math" display="inline" alttext="p_{e}"><semantics><msub><mi>p</mi><mi>e</mi></msub><annotation encoding="application/x-tex">p_{e}</annotation></semantics></math>),
from partially new stock (a proportion <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m4" class="ltx_Math" display="inline" alttext="r_{m}"><semantics><msub><mi>r</mi><mi>m</mi></msub><annotation encoding="application/x-tex">r_{m}</annotation></semantics></math> with probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m5" class="ltx_Math" alttext="p_{m}" display="inline"><semantics><msub><mi>p</mi><mi>m</mi></msub><annotation encoding="application/x-tex">p_{m}</annotation></semantics></math>),
or entirely from the same field.
Plants have an average of <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m6" class="ltx_Math" alttext="\mu_{E}" display="inline"><semantics><msub><mi>&#x3BC;</mi><mi>E</mi></msub><annotation encoding="application/x-tex">\mu_{E}</annotation></semantics></math> ears per plant, and ears have an average of <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m7" class="ltx_Math" alttext="N/N_{f}" display="inline"><semantics><mrow><mi>N</mi><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">N/N_{f}</annotation></semantics></math> kernels;
so a plant has on average <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m8" class="ltx_Math" display="inline" alttext="\mu_{E}N/N_{f}"><semantics><mrow><mrow><msub><mi>&#x3BC;</mi><mi>E</mi></msub><mo>&#x2062;</mo><mi>N</mi></mrow><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">\mu_{E}N/N_{f}</annotation></semantics></math> kernels, and a field has on average <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m9" class="ltx_Math" display="inline" alttext="\mu_{E}N"><semantics><mrow><msub><mi>&#x3BC;</mi><mi>E</mi></msub><mo>&#x2062;</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">\mu_{E}N</annotation></semantics></math> ears and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m10" class="ltx_Math" display="inline" alttext="\mu_{E}N^{2}/N_{f}"><semantics><mrow><mrow><msub><mi>&#x3BC;</mi><mi>E</mi></msub><mo>&#x2062;</mo><msup><mi>N</mi><mn>2</mn></msup></mrow><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">\mu_{E}N^{2}/N_{f}</annotation></semantics></math> kernels.
We suppose that a plant with the selected allele is pollen parent to <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m11" class="ltx_Math" alttext="(1+s)\mu_{E}N/N_{f}" display="inline"><semantics><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><msub><mi>&#x3BC;</mi><mi>E</mi></msub><mo>&#x2062;</mo><mi>N</mi></mrow><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">(1+s)\mu_{E}N/N_{f}</annotation></semantics></math> kernels,
and also seed parent to <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m12" class="ltx_Math" alttext="(1+s)\mu_{E}N/N_{f}" display="inline"><semantics><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><msub><mi>&#x3BC;</mi><mi>E</mi></msub><mo>&#x2062;</mo><mi>N</mi></mrow><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">(1+s)\mu_{E}N/N_{f}</annotation></semantics></math> kernels, still in <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m13" class="ltx_Math" display="inline" alttext="\mu_{E}"><semantics><msub><mi>&#x3BC;</mi><mi>E</mi></msub><annotation encoding="application/x-tex">\mu_{E}</annotation></semantics></math> ears.
The number of offspring a plant has depends on how many of its offspring kernels get replanted.
Some proportion <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m14" class="ltx_Math" display="inline" alttext="m_{g}"><semantics><msub><mi>m</mi><mi>g</mi></msub><annotation encoding="application/x-tex">m_{g}</annotation></semantics></math> of the pollen-parent kernels are in other fields, and may be replanted;
but with probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m15" class="ltx_Math" display="inline" alttext="p_{e}"><semantics><msub><mi>p</mi><mi>e</mi></msub><annotation encoding="application/x-tex">p_{e}</annotation></semantics></math> no other kernels (i.e.&#xA0;those in the same field) are replanted.
Otherwise, with probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m16" class="ltx_Math" display="inline" alttext="1-p_{m}"><semantics><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">1-p_{m}</annotation></semantics></math> the farmer chooses <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m17" class="ltx_Math" display="inline" alttext="N_{f}"><semantics><msub><mi>N</mi><mi>f</mi></msub><annotation encoding="application/x-tex">N_{f}</annotation></semantics></math> of the ears from this field to replant
(or, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m18" class="ltx_Math" alttext="(1-r_{m})N_{f}" display="inline"><semantics><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>r</mi><mi>m</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">(1-r_{m})N_{f}</annotation></semantics></math> of them, with probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m19" class="ltx_Math" alttext="p_{m}" display="inline"><semantics><msub><mi>p</mi><mi>m</mi></msub><annotation encoding="application/x-tex">p_{m}</annotation></semantics></math>);
this results in a mean number <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m20" class="ltx_Math" alttext="N_{f}/N" display="inline"><semantics><mrow><msub><mi>N</mi><mi>f</mi></msub><mo>/</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">N_{f}/N</annotation></semantics></math> (or, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m21" class="ltx_Math" display="inline" alttext="(1-r_{m})N_{f}/N"><semantics><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>r</mi><mi>m</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><mo>/</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">(1-r_{m})N_{f}/N</annotation></semantics></math>) of the plant&#x2019;s ears of seed children being chosen,
and a mean number <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m22" class="ltx_Math" alttext="1+s" display="inline"><semantics><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">1+s</annotation></semantics></math> of the plant&#x2019;s pollen children kernels being chosen.
Furthermore, the field is used to completely (or partially) replant another&#x2019;s field with chance <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m23" class="ltx_Math" display="inline" alttext="p_{e}/(1-p_{e})"><semantics><mrow><msub><mi>p</mi><mi>e</mi></msub><mo>/</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{e}/(1-p_{e})</annotation></semantics></math> (or <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m24" class="ltx_Math" display="inline" alttext="p_{m}"><semantics><msub><mi>p</mi><mi>m</mi></msub><annotation encoding="application/x-tex">p_{m}</annotation></semantics></math>);
resulting in another <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m25" class="ltx_Math" alttext="N_{f}/N" display="inline"><semantics><mrow><msub><mi>N</mi><mi>f</mi></msub><mo>/</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">N_{f}/N</annotation></semantics></math> (or <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m26" class="ltx_Math" alttext="r_{m}N_{f}/N" display="inline"><semantics><mrow><mrow><msub><mi>r</mi><mi>m</mi></msub><mo>&#x2062;</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><mo>/</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">r_{m}N_{f}/N</annotation></semantics></math>) ears and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m27" class="ltx_Math" alttext="1+s" display="inline"><semantics><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">1+s</annotation></semantics></math> (or <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p1.m28" class="ltx_Math" display="inline" alttext="r_{m}(1+s)"><semantics><mrow><msub><mi>r</mi><mi>m</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow></mrow><annotation encoding="application/x-tex">r_{m}(1+s)</annotation></semantics></math>) pollen children being replanted elsewhere.
Here we have assumed that pollen is well-mixed within a field,
and that the selected allele is locally rare.
Finally, we must divide all these offspring numbers by 2,
since we look at the offspring carrying a particular haplotype, not of the diploid plant&#x2019;s genome.</p>
</div>
<div id="S1.SS1.p2" class="ltx_para">
<p class="ltx_p">The above gives mean values; to get a probability model we assume that every count in sight is Poisson.
In other words, we suppose that the number of pollen children is Poisson with random mean <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m1" class="ltx_Math" alttext="\lambda_{P}" display="inline"><semantics><msub><mi>&#x3BB;</mi><mi>P</mi></msub><annotation encoding="application/x-tex">\lambda_{P}</annotation></semantics></math>,
and the number of seed children is a mixture of <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m2" class="ltx_Math" alttext="K" display="inline"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math> independent Poissons with mean <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m3" class="ltx_Math" display="inline" alttext="(1+s)N/N_{f}"><semantics><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mi>N</mi></mrow><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">(1+s)N/N_{f}</annotation></semantics></math> each,
where <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m4" class="ltx_Math" alttext="K" display="inline"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math> is the random number of ears chosen to replant, which is itself Poisson with mean <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m5" class="ltx_Math" alttext="\mu_{K}" display="inline"><semantics><msub><mi>&#x3BC;</mi><mi>K</mi></msub><annotation encoding="application/x-tex">\mu_{K}</annotation></semantics></math>.
By Poisson additivity, the numbers of local and migrant offspring are Poisson,
with means <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m6" class="ltx_Math" alttext="\lambda_{P}=\lambda_{PL}+\lambda_{PM}" display="inline"><semantics><mrow><msub><mi>&#x3BB;</mi><mi>P</mi></msub><mo>=</mo><mrow><msub><mi>&#x3BB;</mi><mrow><mi>P</mi><mo>&#x2062;</mo><mi>L</mi></mrow></msub><mo>+</mo><msub><mi>&#x3BB;</mi><mrow><mi>P</mi><mo>&#x2062;</mo><mi>M</mi></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">\lambda_{P}=\lambda_{PL}+\lambda_{PM}</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m7" class="ltx_Math" alttext="\mu_{K}=\mu_{KL}+\mu_{KM}" display="inline"><semantics><mrow><msub><mi>&#x3BC;</mi><mi>K</mi></msub><mo>=</mo><mrow><msub><mi>&#x3BC;</mi><mrow><mi>K</mi><mo>&#x2062;</mo><mi>L</mi></mrow></msub><mo>+</mo><msub><mi>&#x3BC;</mi><mrow><mi>K</mi><mo>&#x2062;</mo><mi>M</mi></mrow></msub></mrow></mrow><annotation encoding="application/x-tex">\mu_{K}=\mu_{KL}+\mu_{KM}</annotation></semantics></math> respectively.
With probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m8" class="ltx_Math" alttext="p_{e}" display="inline"><semantics><msub><mi>p</mi><mi>e</mi></msub><annotation encoding="application/x-tex">p_{e}</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m9" class="ltx_Math" alttext="\lambda_{PM}=m_{g}(1+s)" display="inline"><semantics><mrow><msub><mi>&#x3BB;</mi><mrow><mi>P</mi><mo>&#x2062;</mo><mi>M</mi></mrow></msub><mo>=</mo><mrow><msub><mi>m</mi><mi>g</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\lambda_{PM}=m_{g}(1+s)</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m10" class="ltx_Math" display="inline" alttext="\mu_{K}=\lambda_{PL}=0"><semantics><mrow><msub><mi>&#x3BC;</mi><mi>K</mi></msub><mo>=</mo><msub><mi>&#x3BB;</mi><mrow><mi>P</mi><mo>&#x2062;</mo><mi>L</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu_{K}=\lambda_{PL}=0</annotation></semantics></math>.
Otherwise, with probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m11" class="ltx_Math" display="inline" alttext="(1-p_{e})(1-p_{m})"><semantics><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>m</mi></msub></mrow><mo>)</mo></mrow></mrow><annotation encoding="application/x-tex">(1-p_{e})(1-p_{m})</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m12" class="ltx_Math" alttext="\mu_{KL}=N_{f}/N" display="inline"><semantics><mrow><msub><mi>&#x3BC;</mi><mrow><mi>K</mi><mo>&#x2062;</mo><mi>L</mi></mrow></msub><mo>=</mo><mrow><msub><mi>N</mi><mi>f</mi></msub><mo>/</mo><mi>N</mi></mrow></mrow><annotation encoding="application/x-tex">\mu_{KL}=N_{f}/N</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m13" class="ltx_Math" alttext="\lambda_{PL}=(1+s)(1-m_{g})" display="inline"><semantics><mrow><msub><mi>&#x3BB;</mi><mrow><mi>P</mi><mo>&#x2062;</mo><mi>L</mi></mrow></msub><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\lambda_{PL}=(1+s)(1-m_{g})</annotation></semantics></math>;
and with probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m14" class="ltx_Math" display="inline" alttext="(1-p_{e})p_{m}"><semantics><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><msub><mi>p</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">(1-p_{e})p_{m}</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m15" class="ltx_Math" alttext="\mu_{KL}=(1-r_{m})N_{f}/N" display="inline"><semantics><mrow><msub><mi>&#x3BC;</mi><mrow><mi>K</mi><mo>&#x2062;</mo><mi>L</mi></mrow></msub><mo>=</mo><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>r</mi><mi>m</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><mo>/</mo><mi>N</mi></mrow></mrow><annotation encoding="application/x-tex">\mu_{KL}=(1-r_{m})N_{f}/N</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m16" class="ltx_Math" display="inline" alttext="\lambda_{PL}=(1-r_{m})(1+s)(1-m_{g})"><semantics><mrow><msub><mi>&#x3BB;</mi><mrow><mi>P</mi><mo>&#x2062;</mo><mi>L</mi></mrow></msub><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>r</mi><mi>m</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\lambda_{PL}=(1-r_{m})(1+s)(1-m_{g})</annotation></semantics></math>.
The migrant means are,
with probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m17" class="ltx_Math" display="inline" alttext="(1-p_{e})p_{e}/(1-p_{e})=p_{e}"><semantics><mrow><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>/</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>=</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">(1-p_{e})p_{e}/(1-p_{e})=p_{e}</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m18" class="ltx_Math" display="inline" alttext="\mu_{KM}=N_{f}/N"><semantics><mrow><msub><mi>&#x3BC;</mi><mrow><mi>K</mi><mo>&#x2062;</mo><mi>M</mi></mrow></msub><mo>=</mo><mrow><msub><mi>N</mi><mi>f</mi></msub><mo>/</mo><mi>N</mi></mrow></mrow><annotation encoding="application/x-tex">\mu_{KM}=N_{f}/N</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m19" class="ltx_Math" alttext="\lambda_{PM}=1+s" display="inline"><semantics><mrow><msub><mi>&#x3BB;</mi><mrow><mi>P</mi><mo>&#x2062;</mo><mi>M</mi></mrow></msub><mo>=</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow></mrow><annotation encoding="application/x-tex">\lambda_{PM}=1+s</annotation></semantics></math>;
while with probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m20" class="ltx_Math" alttext="(1-p_{e})p_{m}" display="inline"><semantics><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><msub><mi>p</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">(1-p_{e})p_{m}</annotation></semantics></math>, <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m21" class="ltx_Math" display="inline" alttext="\mu_{KM}=r_{m}N_{f}/N"><semantics><mrow><msub><mi>&#x3BC;</mi><mrow><mi>K</mi><mo>&#x2062;</mo><mi>M</mi></mrow></msub><mo>=</mo><mrow><mrow><msub><mi>r</mi><mi>m</mi></msub><mo>&#x2062;</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><mo>/</mo><mi>N</mi></mrow></mrow><annotation encoding="application/x-tex">\mu_{KM}=r_{m}N_{f}/N</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m22" class="ltx_Math" alttext="\lambda_{PM}=(1+s)(r_{m}(1-m_{g})+m_{g})" display="inline"><semantics><mrow><msub><mi>&#x3BB;</mi><mrow><mi>P</mi><mo>&#x2062;</mo><mi>M</mi></mrow></msub><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mrow><msub><mi>r</mi><mi>m</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>+</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\lambda_{PM}=(1+s)(r_{m}(1-m_{g})+m_{g})</annotation></semantics></math>,
and otherwise <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m23" class="ltx_Math" display="inline" alttext="\mu_{KM}=0"><semantics><mrow><msub><mi>&#x3BC;</mi><mrow><mi>K</mi><mo>&#x2062;</mo><mi>M</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu_{KM}=0</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS1.p2.m24" class="ltx_Math" display="inline" alttext="\lambda_{PM}=m_{g}(1+s)"><semantics><mrow><msub><mi>&#x3BB;</mi><mrow><mi>P</mi><mo>&#x2062;</mo><mi>M</mi></mrow></msub><mo>=</mo><mrow><msub><mi>m</mi><mi>g</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\lambda_{PM}=m_{g}(1+s)</annotation></semantics></math>.</p>
</div>
<div id="S1.T2" class="ltx_table">
<table class="ltx_tabular ltx_centering">
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_t" align="center">complete seed stock replacement prob</td>
<td class="ltx_td ltx_align_left ltx_border_t" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m1" class="ltx_Math" display="inline" alttext="p_{e}"><semantics><msub><mi>p</mi><mi>e</mi></msub><annotation encoding="application/x-tex">p_{e}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" align="left">0.068</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">pollen migration rate</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m2" class="ltx_Math" display="inline" alttext="m_{g}"><semantics><msub><mi>m</mi><mi>g</mi></msub><annotation encoding="application/x-tex">m_{g}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">0.0083</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">number of plants per field</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m3" class="ltx_Math" display="inline" alttext="N"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m4" class="ltx_Math" display="inline" alttext="10^{5}"><semantics><msup><mn>10</mn><mn>5</mn></msup><annotation encoding="application/x-tex">10^{5}</annotation></semantics></math></td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">number of ears used to replant</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m5" class="ltx_Math" display="inline" alttext="N_{f}"><semantics><msub><mi>N</mi><mi>f</mi></msub><annotation encoding="application/x-tex">N_{f}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">561</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">mean ears per plant</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m6" class="ltx_Math" display="inline" alttext="\mu_{E}"><semantics><msub><mi>&#x3BC;</mi><mi>E</mi></msub><annotation encoding="application/x-tex">\mu_{E}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">3</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">partial stock replacement prob</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m7" class="ltx_Math" alttext="p_{m}" display="inline"><semantics><msub><mi>p</mi><mi>m</mi></msub><annotation encoding="application/x-tex">p_{m}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">0.02</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">mean proportion stock replaced</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m8" class="ltx_Math" display="inline" alttext="r_{m}"><semantics><msub><mi>r</mi><mi>m</mi></msub><annotation encoding="application/x-tex">r_{m}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">0.2</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">pollen migration distance</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m9" class="ltx_Math" display="inline" alttext="\sigma_{p}"><semantics><msub><mi>&#x3C3;</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\sigma_{p}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">0 km</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">seed replacement distance</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m10" class="ltx_Math" alttext="\sigma_{s}" display="inline"><semantics><msub><mi>&#x3C3;</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\sigma_{s}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">50 km</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">distance between demes</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m11" class="ltx_Math" display="inline" alttext="a"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">15 km</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">width of altitudinal cline</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m12" class="ltx_Math" alttext="w" display="inline"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">62km</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">deleterious selection coefficient</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m13" class="ltx_Math" alttext="s_{d}" display="inline"><semantics><msub><mi>s</mi><mi>d</mi></msub><annotation encoding="application/x-tex">s_{d}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">varies</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">beneficial selection coefficient</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m14" class="ltx_Math" alttext="s_{b}" display="inline"><semantics><msub><mi>s</mi><mi>b</mi></msub><annotation encoding="application/x-tex">s_{b}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">varies</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">slope of selection gradient</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m15" class="ltx_Math" alttext="\alpha" display="inline"><semantics><mi>&#x3B1;</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m16" class="ltx_Math" alttext="(s_{d}+s_{b})/w" display="inline"><semantics><mrow><mrow><mo>(</mo><mrow><msub><mi>s</mi><mi>d</mi></msub><mo>+</mo><msub><mi>s</mi><mi>b</mi></msub></mrow><mo>)</mo></mrow><mo>/</mo><mi>w</mi></mrow><annotation encoding="application/x-tex">(s_{d}+s_{b})/w</annotation></semantics></math></td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">variance in offspring number</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m17" class="ltx_Math" alttext="\xi^{2}" display="inline"><semantics><msup><mi>&#x3BE;</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\xi^{2}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">varies</td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">maize population density</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m18" class="ltx_Math" alttext="\rho" display="inline"><semantics><mi>&#x3C1;</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m19" class="ltx_Math" display="inline" alttext="5\times 10^{3}"><semantics><mrow><mn>5</mn><mo>&#xD7;</mo><msup><mn>10</mn><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">5\times 10^{3}</annotation></semantics></math></td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_l" align="center">area of highland habitat</td>
<td class="ltx_td ltx_align_left" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m20" class="ltx_Math" display="inline" alttext="A"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_r" align="left">500 km<math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m21" class="ltx_Math" display="inline" alttext="{}^{2}"><semantics><msup><mi/><mn>2</mn></msup><annotation encoding="application/x-tex">{}^{2}</annotation></semantics></math></td></tr>
<tr class="ltx_tr">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l" align="center">mean dispersal distance</td>
<td class="ltx_td ltx_align_left ltx_border_b" align="left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.T2.m22" class="ltx_Math" display="inline" alttext="\sigma"><semantics><mi>&#x3C3;</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" align="left">1.8 km</td></tr>
</tbody>
</table>
<div class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table&#xA0;2: </span>Parameter estimates used in calculations, and other notation.

</div>
</div>
</div>
<div id="S1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">1.2 </span>Math</h3>

<div id="S1.SS2.p1" class="ltx_para">
<p class="ltx_p">The generating function of a Poisson with mean <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS2.p1.m1" class="ltx_Math" alttext="\lambda" display="inline"><semantics><mi>&#x3BB;</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math> is <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS2.p1.m2" class="ltx_Math" display="inline" alttext="\phi(u;\lambda)=\exp(\lambda(u-1))"><semantics><mrow><mrow><mi>&#x3D5;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>;</mo><mi>&#x3BB;</mi></mrow><mo>)</mo></mrow></mrow><mo>=</mo><mrow><mi>exp</mi><mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mi>&#x3BB;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\phi(u;\lambda)=\exp(\lambda(u-1))</annotation></semantics></math>,
and the generating function of a Poisson(<math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS2.p1.m3" class="ltx_Math" alttext="\mu" display="inline"><semantics><mi>&#x3BC;</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>) sum of Poisson(<math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS2.p1.m4" class="ltx_Math" display="inline" alttext="\lambda"><semantics><mi>&#x3BB;</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>) values is <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS2.p1.m5" class="ltx_Math" alttext="\phi(\phi(u;\lambda);\mu)" display="inline"><semantics><mrow><mi>&#x3D5;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mrow><mi>&#x3D5;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>;</mo><mi>&#x3BB;</mi></mrow><mo>)</mo></mrow></mrow><mo>;</mo><mi>&#x3BC;</mi></mrow><mo>)</mo></mrow></mrow><annotation encoding="application/x-tex">\phi(\phi(u;\lambda);\mu)</annotation></semantics></math>.
Therefore, the generating function for the diploid process, ignoring spatial structure,
is</p>
<table id="S4.EGx3" class="ltx_equationgroup ltx_eqn_align">

<tr id="S1.E5" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E5.m1" class="ltx_Math" display="inline" alttext="\displaystyle\Phi(u)"><semantics><mrow><mi mathvariant="normal">&#x3A6;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mi>u</mi><mo>)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\Phi(u)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E5.m2" class="ltx_Math" alttext="\displaystyle=\begin{aligned}&amp;\displaystyle p_{e}\phi(u;m_{g}(1+s))\\&#10;&amp;\displaystyle{}+\left\{(1-p_{e})(1-p_{m})\phi(u;(1+s)(1-m_{g}))\phi(\phi(u;(1%&#10;+s)N/N_{f});N_{f}/N)\right.\\&#10;&amp;\displaystyle\left.{}+(1-p_{e})p_{m}\phi(u;(1+s)(1-r_{m})(1-m_{g}))\phi(\phi(%&#10;u;(1+s)N/N_{f});(1-r_{m})N_{f}/N)\right\}\\&#10;&amp;\displaystyle{}\times\left\{p_{e}/(1-p_{e})\phi(u;1+s)\phi(\phi(u;(1+s)N_{f}/%&#10;N);N_{f}/N)\right.\\&#10;&amp;\displaystyle\left.{}+p_{m}\phi(u;(1+s)(r_{m}(1-p_{e})(1-m_{g})+m_{g}))\right%&#10;.\\&#10;&amp;\displaystyle\left.{}\times\phi(\phi(u;(1+s)N/N_{f});r_{m}N_{f}/N)\right.\\&#10;&amp;\displaystyle\left.{}+(1-p_{e}/(1-p_{e})-p_{m})\phi(u;m_{g}(1+s))\right\}\end%&#10;{aligned}" display="inline"><semantics><mrow><mi/><mo>=</mo><mtable columnspacing="0.4em" rowspacing="0.2ex"><mtr><mtd/><mtd columnalign="left"><mrow><msub><mi>p</mi><mi>e</mi></msub><mo>&#x2062;</mo><mi>&#x3D5;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>;</mo><mrow><msub><mi>m</mi><mi>g</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mo>+</mo><mrow><mo>{</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub><mo>)</mo></mrow><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>m</mi></msub><mo>)</mo></mrow><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub><mo>)</mo></mrow><mo>)</mo></mrow><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mi>N</mi><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub><mo>)</mo></mrow><mo>;</mo><msub><mi>N</mi><mi>f</mi></msub><mo>/</mo><mi>N</mi><mo>)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mo>+</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub><mo>)</mo></mrow><msub><mi>p</mi><mi>m</mi></msub><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>r</mi><mi>m</mi></msub><mo>)</mo></mrow><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub><mo>)</mo></mrow><mo>)</mo></mrow><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mi>N</mi><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub><mo>)</mo></mrow><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>r</mi><mi>m</mi></msub><mo>)</mo></mrow><msub><mi>N</mi><mi>f</mi></msub><mo>/</mo><mi>N</mi><mo>)</mo></mrow><mo>}</mo></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mo>&#xD7;</mo><mrow><mo>{</mo><msub><mi>p</mi><mi>e</mi></msub><mo>/</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub><mo>)</mo></mrow><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><msub><mi>N</mi><mi>f</mi></msub><mo>/</mo><mi>N</mi><mo>)</mo></mrow><mo>;</mo><msub><mi>N</mi><mi>f</mi></msub><mo>/</mo><mi>N</mi><mo>)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mo>+</mo><mrow><msub><mi>p</mi><mi>m</mi></msub><mo>&#x2062;</mo><mi>&#x3D5;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>;</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mrow><msub><mi>r</mi><mi>m</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>+</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mi/><mo>&#xD7;</mo><mrow><mi>&#x3D5;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mrow><mi>&#x3D5;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>;</mo><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mi>N</mi></mrow><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub></mrow></mrow><mo>)</mo></mrow></mrow><mo>;</mo><mrow><mrow><msub><mi>r</mi><mi>m</mi></msub><mo>&#x2062;</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><mo>/</mo><mi>N</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mo>+</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub><mo>/</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub><mo>)</mo></mrow><mo>-</mo><msub><mi>p</mi><mi>m</mi></msub><mo>)</mo></mrow><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><msub><mi>m</mi><mi>g</mi></msub><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mo>)</mo></mrow><mo>}</mo></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\displaystyle=\begin{aligned}&amp;\displaystyle p_{e}\phi(u;m_{g}(1+s))\\
&amp;\displaystyle{}+\left\{(1-p_{e})(1-p_{m})\phi(u;(1+s)(1-m_{g}))\phi(\phi(u;(1%
+s)N/N_{f});N_{f}/N)\right.\\
&amp;\displaystyle\left.{}+(1-p_{e})p_{m}\phi(u;(1+s)(1-r_{m})(1-m_{g}))\phi(\phi(%
u;(1+s)N/N_{f});(1-r_{m})N_{f}/N)\right\}\\
&amp;\displaystyle{}\times\left\{p_{e}/(1-p_{e})\phi(u;1+s)\phi(\phi(u;(1+s)N_{f}/%
N);N_{f}/N)\right.\\
&amp;\displaystyle\left.{}+p_{m}\phi(u;(1+s)(r_{m}(1-p_{e})(1-m_{g})+m_{g}))\right%
.\\
&amp;\displaystyle\left.{}\times\phi(\phi(u;(1+s)N/N_{f});r_{m}N_{f}/N)\right.\\
&amp;\displaystyle\left.{}+(1-p_{e}/(1-p_{e})-p_{m})\phi(u;m_{g}(1+s))\right\}\end%
{aligned}</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(5)</span></td></tr>
<tr id="S1.E6" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"/>
<td class="ltx_td ltx_align_left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E6.m2" class="ltx_Math" alttext="\displaystyle=\begin{aligned}&amp;\displaystyle\phi(u;m_{g}(1+s))\big(\;p_{e}\big.%&#10;\\&#10;&amp;\displaystyle{}+\left\{(1-p_{e})(1-p_{m})\phi(u;(1+s)(1-m_{g}))\phi(\phi(u;(1%&#10;+s)N/N_{f});N_{f}/N)\right.\\&#10;&amp;\displaystyle\left.{}+(1-p_{e})p_{m}\phi(u;(1+s)(1-r_{m})(1-m_{g}))\phi(\phi(%&#10;u;(1+s)N/N_{f});(1-r_{m})N_{f}/N)\right\}\\&#10;&amp;\displaystyle{}\times\left\{p_{e}/(1-p_{e})\phi(u;(1+s)(1-m_{g}))\phi(\phi(u;%&#10;(1+s)N_{f}/N);N_{f}/N)\right.\\&#10;&amp;\displaystyle{}+p_{m}\phi(u;(1+s)r_{m}(1-m_{g}))\\&#10;&amp;\displaystyle{}\times\phi(\phi(u;(1+s)N/N_{f});r_{m}N_{f}/N)\\&#10;&amp;\displaystyle\left.{}+(1-p_{e}/(1-p_{e})-p_{m})\right\}\big)\end{aligned}" display="inline"><semantics><mrow><mi/><mo>=</mo><mtable columnspacing="0.4em" rowspacing="0.2ex"><mtr><mtd/><mtd columnalign="left"><mrow><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><msub><mi>m</mi><mi>g</mi></msub><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mo>)</mo></mrow><mrow><mo rspace="2.777778pt" mathsize="1.1em">(</mo><msub><mi>p</mi><mi>e</mi></msub><mo mathsize="1.1em">.</mo></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mo>+</mo><mrow><mo>{</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub><mo>)</mo></mrow><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>m</mi></msub><mo>)</mo></mrow><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub><mo>)</mo></mrow><mo>)</mo></mrow><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mi>N</mi><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub><mo>)</mo></mrow><mo>;</mo><msub><mi>N</mi><mi>f</mi></msub><mo>/</mo><mi>N</mi><mo>)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mo>+</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub><mo>)</mo></mrow><msub><mi>p</mi><mi>m</mi></msub><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>r</mi><mi>m</mi></msub><mo>)</mo></mrow><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub><mo>)</mo></mrow><mo>)</mo></mrow><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mi>N</mi><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub><mo>)</mo></mrow><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>r</mi><mi>m</mi></msub><mo>)</mo></mrow><msub><mi>N</mi><mi>f</mi></msub><mo>/</mo><mi>N</mi><mo>)</mo></mrow><mo>}</mo></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mo>&#xD7;</mo><mrow><mo>{</mo><msub><mi>p</mi><mi>e</mi></msub><mo>/</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub><mo>)</mo></mrow><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub><mo>)</mo></mrow><mo>)</mo></mrow><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>&#x3D5;</mi><mrow><mo>(</mo><mi>u</mi><mo>;</mo><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><msub><mi>N</mi><mi>f</mi></msub><mo>/</mo><mi>N</mi><mo>)</mo></mrow><mo>;</mo><msub><mi>N</mi><mi>f</mi></msub><mo>/</mo><mi>N</mi><mo>)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mo>+</mo><mrow><msub><mi>p</mi><mi>m</mi></msub><mo>&#x2062;</mo><mi>&#x3D5;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>;</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><msub><mi>r</mi><mi>m</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mi/><mo>&#xD7;</mo><mrow><mi>&#x3D5;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mrow><mi>&#x3D5;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>;</mo><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mi>N</mi></mrow><mo>/</mo><msub><mi>N</mi><mi>f</mi></msub></mrow></mrow><mo>)</mo></mrow></mrow><mo>;</mo><mrow><mrow><msub><mi>r</mi><mi>m</mi></msub><mo>&#x2062;</mo><msub><mi>N</mi><mi>f</mi></msub></mrow><mo>/</mo><mi>N</mi></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mrow><mo>+</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub><mo>/</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub><mo>)</mo></mrow><mo>-</mo><msub><mi>p</mi><mi>m</mi></msub><mo>)</mo></mrow><mo>}</mo></mrow><mo mathsize="1.1em">)</mo></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\displaystyle=\begin{aligned}&amp;\displaystyle\phi(u;m_{g}(1+s))\big(\;p_{e}\big.%
\\
&amp;\displaystyle{}+\left\{(1-p_{e})(1-p_{m})\phi(u;(1+s)(1-m_{g}))\phi(\phi(u;(1%
+s)N/N_{f});N_{f}/N)\right.\\
&amp;\displaystyle\left.{}+(1-p_{e})p_{m}\phi(u;(1+s)(1-r_{m})(1-m_{g}))\phi(\phi(%
u;(1+s)N/N_{f});(1-r_{m})N_{f}/N)\right\}\\
&amp;\displaystyle{}\times\left\{p_{e}/(1-p_{e})\phi(u;(1+s)(1-m_{g}))\phi(\phi(u;%
(1+s)N_{f}/N);N_{f}/N)\right.\\
&amp;\displaystyle{}+p_{m}\phi(u;(1+s)r_{m}(1-m_{g}))\\
&amp;\displaystyle{}\times\phi(\phi(u;(1+s)N/N_{f});r_{m}N_{f}/N)\\
&amp;\displaystyle\left.{}+(1-p_{e}/(1-p_{e})-p_{m})\right\}\big)\end{aligned}</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(6)</span></td></tr>
</table>
<p class="ltx_p">To get the generating function for a haploid, replace every instance of <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS2.p1.m6" class="ltx_Math" display="inline" alttext="1+s"><semantics><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">1+s</annotation></semantics></math> by <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS2.p1.m7" class="ltx_Math" alttext="(1+s)/2" display="inline"><semantics><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>/</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">(1+s)/2</annotation></semantics></math>.</p>
</div>
<div id="S1.SS2.p2" class="ltx_para">
<p class="ltx_p">As a quick check,
the mean total number of offspring of a diploid is</p>
<table id="S4.EGx4" class="ltx_equationgroup ltx_eqn_align">

<tr id="S1.E7" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"/>
<td class="ltx_td ltx_align_left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E7.m2" class="ltx_Math" display="inline" alttext="\displaystyle\begin{aligned}\displaystyle(1+s)\big(m_{g}+&amp;\displaystyle(1-p_{e%&#10;})\left\{(1-p_{m})((1-m_{g})+1)+p_{m}((1-r_{m})(1-m_{g})+(1-r_{m}))\right\}\\&#10;&amp;\displaystyle+\left\{p_{e}((1-m_{g})+1)+p_{m}(1-p_{e})(r_{m}(1-m_{g})+r_{m})%&#10;\right\}\big)\end{aligned}"><semantics><mtable columnspacing="0.4em" rowspacing="0.2ex"><mtr><mtd columnalign="right"><mrow><mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi>s</mi><mo>)</mo></mrow><mrow><mo mathsize="1.1em">(</mo><msub><mi>m</mi><mi>g</mi></msub><mo>+</mo></mrow></mrow></mtd><mtd columnalign="left"><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>{</mo><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>m</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow><mo>+</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>p</mi><mi>m</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>r</mi><mi>m</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>r</mi><mi>m</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>}</mo></mrow></mrow></mtd></mtr><mtr><mtd/><mtd columnalign="left"><mrow><mo>+</mo><mrow><mo>{</mo><msub><mi>p</mi><mi>e</mi></msub><mrow><mo>(</mo><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub><mo>)</mo></mrow><mo>+</mo><mn>1</mn><mo>)</mo></mrow><mo>+</mo><msub><mi>p</mi><mi>m</mi></msub><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub><mo>)</mo></mrow><mrow><mo>(</mo><msub><mi>r</mi><mi>m</mi></msub><mrow><mo>(</mo><mn>1</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub><mo>)</mo></mrow><mo>+</mo><msub><mi>r</mi><mi>m</mi></msub><mo>)</mo></mrow><mo>}</mo></mrow><mo mathsize="1.1em">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\displaystyle\begin{aligned}\displaystyle(1+s)\big(m_{g}+&amp;\displaystyle(1-p_{e%
})\left\{(1-p_{m})((1-m_{g})+1)+p_{m}((1-r_{m})(1-m_{g})+(1-r_{m}))\right\}\\
&amp;\displaystyle+\left\{p_{e}((1-m_{g})+1)+p_{m}(1-p_{e})(r_{m}(1-m_{g})+r_{m})%
\right\}\big)\end{aligned}</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(7)</span></td></tr>
<tr id="S1.E8" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"/>
<td class="ltx_td ltx_align_left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E8.m2" class="ltx_Math" display="inline" alttext="\displaystyle\qquad=(1+s)\big(m_{g}+(1-p_{e})(2-m_{g})(1-p_{m}r_{m})+(p_{e}(2-%&#10;m_{g})+p_{m}r_{m}(1-p_{e})(2-m_{g}))\big)"><semantics><mrow><mi>&#x2001;&#x2001;</mi><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><msub><mi>m</mi><mi>g</mi></msub><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>2</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mrow><msub><mi>p</mi><mi>m</mi></msub><mo>&#x2062;</mo><msub><mi>r</mi><mi>m</mi></msub></mrow></mrow><mo>)</mo></mrow></mrow><mo>+</mo><mrow><mo>(</mo><mrow><mrow><msub><mi>p</mi><mi>e</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>2</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>+</mo><mrow><msub><mi>p</mi><mi>m</mi></msub><mo>&#x2062;</mo><msub><mi>r</mi><mi>m</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>2</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\qquad=(1+s)\big(m_{g}+(1-p_{e})(2-m_{g})(1-p_{m}r_{m})+(p_{e}(2-%
m_{g})+p_{m}r_{m}(1-p_{e})(2-m_{g}))\big)</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(8)</span></td></tr>
<tr id="S1.E9" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"/>
<td class="ltx_td ltx_align_left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E9.m2" class="ltx_Math" display="inline" alttext="\displaystyle\qquad=(1+s)\big(m_{g}+(2-m_{g})((1-p_{e})(1-p_{m}r_{m})+p_{e}+p_%&#10;{m}r_{m}(1-p_{e}))\big)"><semantics><mrow><mi>&#x2001;&#x2001;</mi><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><msub><mi>m</mi><mi>g</mi></msub><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mn>2</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><mrow><msub><mi>p</mi><mi>m</mi></msub><mo>&#x2062;</mo><msub><mi>r</mi><mi>m</mi></msub></mrow></mrow><mo>)</mo></mrow></mrow><mo>+</mo><msub><mi>p</mi><mi>e</mi></msub><mo>+</mo><mrow><msub><mi>p</mi><mi>m</mi></msub><mo>&#x2062;</mo><msub><mi>r</mi><mi>m</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\qquad=(1+s)\big(m_{g}+(2-m_{g})((1-p_{e})(1-p_{m}r_{m})+p_{e}+p_%
{m}r_{m}(1-p_{e}))\big)</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(9)</span></td></tr>
<tr id="S1.E10" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"/>
<td class="ltx_td ltx_align_left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E10.m2" class="ltx_Math" alttext="\displaystyle\qquad=(1+s)\big(m_{g}+(2-m_{g})\big)" display="inline"><semantics><mrow><mi>&#x2001;&#x2001;</mi><mo>=</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><msub><mi>m</mi><mi>g</mi></msub><mo>+</mo><mrow><mo>(</mo><mrow><mn>2</mn><mo>-</mo><msub><mi>m</mi><mi>g</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\qquad=(1+s)\big(m_{g}+(2-m_{g})\big)</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(10)</span></td></tr>
<tr id="S1.E11" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"/>
<td class="ltx_td ltx_align_left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E11.m2" class="ltx_Math" display="inline" alttext="\displaystyle\qquad=2(1+s)."><semantics><mrow><mrow><mi>&#x2001;&#x2001;</mi><mo>=</mo><mrow><mn>2</mn><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>+</mo><mi>s</mi></mrow><mo>)</mo></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\displaystyle\qquad=2(1+s).</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(11)</span></td></tr>
</table>
<p class="ltx_p">Check!</p>
</div>
<div id="S1.SS2.p3" class="ltx_para">
<p class="ltx_p">We show numerically later that the probability of establishment is very close to <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS2.p3.m1" class="ltx_Math" alttext="2s" display="inline"><semantics><mrow><mn>2</mn><mo>&#x2062;</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">2s</annotation></semantics></math> over the variance in reproductive number (as expected).
It is possible to write down an expression for the variance, but it&#x2019;s a big, ugly one that doesn&#x2019;t lend itself to intuition.</p>
</div>
</div>
<div id="S1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">1.3 </span>Migration and spatial structure</h3>

<div id="S1.SS3.p1" class="ltx_para">
<p class="ltx_p">To incorporate spatial structure, suppose that the locations <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS3.p1.m1" class="ltx_Math" alttext="\ell_{k}" display="inline"><semantics><msub><mi mathvariant="normal">&#x2113;</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\ell_{k}</annotation></semantics></math> are arranged in a regular grid, so that <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS3.p1.m2" class="ltx_Math" display="inline" alttext="\ell_{k}=ak"><semantics><mrow><msub><mi mathvariant="normal">&#x2113;</mi><mi>k</mi></msub><mo>=</mo><mrow><mi>a</mi><mo>&#x2062;</mo><mi>k</mi></mrow></mrow><annotation encoding="application/x-tex">\ell_{k}=ak</annotation></semantics></math>.
Recall that <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS3.p1.m3" class="ltx_Math" display="inline" alttext="s_{k}"><semantics><msub><mi>s</mi><mi>k</mi></msub><annotation encoding="application/x-tex">s_{k}</annotation></semantics></math> is the selection coefficient at location <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS3.p1.m4" class="ltx_Math" alttext="k" display="inline"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.
If the total number of offspring produced by an individual at <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS3.p1.m5" class="ltx_Math" display="inline" alttext="\ell_{i}"><semantics><msub><mi mathvariant="normal">&#x2113;</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\ell_{i}</annotation></semantics></math> is Poisson(<math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS3.p1.m6" class="ltx_Math" display="inline" alttext="\lambda_{i}"><semantics><msub><mi>&#x3BB;</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\lambda_{i}</annotation></semantics></math>), with each offspring independently migrating to location <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS3.p1.m7" class="ltx_Math" display="inline" alttext="j"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
with probability <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS3.p1.m8" class="ltx_Math" alttext="m_{ij}" display="inline"><semantics><msub><mi>m</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">m_{ij}</annotation></semantics></math>,
then the number of offspring at <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS3.p1.m9" class="ltx_Math" display="inline" alttext="j"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math> is Poisson(<math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS3.p1.m10" class="ltx_Math" display="inline" alttext="m_{ij}\lambda_{i}"><semantics><mrow><msub><mi>m</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi></mrow></msub><mo>&#x2062;</mo><msub><mi>&#x3BB;</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">m_{ij}\lambda_{i}</annotation></semantics></math>),
and so the generating function is
</p>
<table id="S4.EGx5" class="ltx_equationgroup ltx_eqn_align">

<tr id="S1.E12" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E12.m1" class="ltx_Math" display="inline" alttext="\displaystyle\phi(u;\lambda,m)"><semantics><mrow><mi>&#x3D5;</mi><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mi>u</mi><mo>;</mo><mi>&#x3BB;</mi><mo>,</mo><mi>m</mi></mrow><mo>)</mo></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\phi(u;\lambda,m)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E12.m2" class="ltx_Math" display="inline" alttext="\displaystyle=\prod_{j}\exp(\lambda_{i}m_{ij}(u_{j}-1))"><semantics><mrow><mi/><mo>=</mo><mrow><mstyle displaystyle="true"><munder><mo movablelimits="false">&#x220F;</mo><mi>j</mi></munder></mstyle><mrow><mi>exp</mi><mo>&#x2061;</mo><mrow><mo>(</mo><mrow><msub><mi>&#x3BB;</mi><mi>i</mi></msub><mo>&#x2062;</mo><msub><mi>m</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi></mrow></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><msub><mi>u</mi><mi>j</mi></msub><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\prod_{j}\exp(\lambda_{i}m_{ij}(u_{j}-1))</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(12)</span></td></tr>
<tr id="S1.E13" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"/>
<td class="ltx_td ltx_align_left"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E13.m2" class="ltx_Math" alttext="\displaystyle=\exp\left\{\lambda_{i}\left(\left(\sum_{j}m_{ij}u_{j}\right)-1%&#10;\right)\right\}." display="inline"><semantics><mrow><mrow><mi/><mo>=</mo><mrow><mi>exp</mi><mo>&#x2061;</mo><mrow><mo>{</mo><mrow><msub><mi>&#x3BB;</mi><mi>i</mi></msub><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><mrow><mo>(</mo><mrow><mstyle displaystyle="true"><munder><mo movablelimits="false">&#x2211;</mo><mi>j</mi></munder></mstyle><mrow><msub><mi>m</mi><mrow><mi>i</mi><mo>&#x2062;</mo><mi>j</mi></mrow></msub><mo>&#x2062;</mo><msub><mi>u</mi><mi>j</mi></msub></mrow></mrow><mo>)</mo></mrow><mo>-</mo><mn>1</mn></mrow><mo>)</mo></mrow></mrow><mo>}</mo></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\displaystyle=\exp\left\{\lambda_{i}\left(\left(\sum_{j}m_{ij}u_{j}\right)-1%
\right)\right\}.</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(13)</span></td></tr>
</table>
<p class="ltx_p">We can then substitute this expression into equation (<a href="#S1.E5" title="(5) &#x2023; 1.2 Math &#x2023; 1 Details of the demographic model &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>),
with appropriate migration kernels for pollen and seed dispersal.</p>
</div>
<div id="S1.SS3.p2" class="ltx_para">
<p class="ltx_p">For migration, we need migration rates and migration distances for both wind-blown pollen
and for farmer seed exchange.
The rates are parameterized as above;
we need the typical dispersal distances, however.
One option is to say that the typical distance between villages is <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS3.p2.m1" class="ltx_Math" alttext="d_{v}" display="inline"><semantics><msub><mi>d</mi><mi>v</mi></msub><annotation encoding="application/x-tex">d_{v}</annotation></semantics></math>,
and that villages are discrete demes,
so that pollen stays within the deme (pollen migration distance 0)
and seed is exchanged with others from nearby villages;
on average <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS3.p2.m2" class="ltx_Math" alttext="\sigma_{s}" display="inline"><semantics><msub><mi>&#x3C3;</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\sigma_{s}</annotation></semantics></math> distance away in a random direction.
The number of villages away the seed comes from could be geometric
(including the possibility of coming from the same village).</p>
</div>
</div>
<div id="S1.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">1.4 </span>Dispersal distance</h3>

<div id="S1.SS4.p1" class="ltx_para">
<p class="ltx_p">The dispersal distance
&#x2013; the mean distance between parent and offspring &#x2013;
is the average of the pollen and seed mean dispersal distances.
With the above assumptions, the pollen dispersal distance is zero,
and the seed dispersal distance is the chance of inter-village movement
multiplied by the mean distance moved.
This is
</p>
<table id="S4.EGx6" class="ltx_equationgroup ltx_eqn_align">

<tr id="S1.E14" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.E14.m1" class="ltx_Math" alttext="\displaystyle\sigma=\frac{1}{2}(p_{e}+(1-p_{e})p_{m}r_{m})\sigma_{s}=1.7932%&#10;\text{km}" display="inline"><semantics><mrow><mi>&#x3C3;</mi><mo>=</mo><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>&#x2062;</mo><mrow><mo>(</mo><mrow><msub><mi>p</mi><mi>e</mi></msub><mo>+</mo><mrow><mrow><mo>(</mo><mrow><mn>1</mn><mo>-</mo><msub><mi>p</mi><mi>e</mi></msub></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><msub><mi>p</mi><mi>m</mi></msub><mo>&#x2062;</mo><msub><mi>r</mi><mi>m</mi></msub></mrow></mrow><mo>)</mo></mrow><mo>&#x2062;</mo><msub><mi>&#x3C3;</mi><mi>s</mi></msub></mrow><mo>=</mo><mrow><mn>1.7932</mn><mo>&#x2062;</mo><mtext>km</mtext></mrow></mrow><annotation encoding="application/x-tex">\displaystyle\sigma=\frac{1}{2}(p_{e}+(1-p_{e})p_{m}r_{m})\sigma_{s}=1.7932%
\text{km}</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(14)</span></td></tr>
</table>
<p class="ltx_p">at the parameter values above.</p>
</div>
</div>
<div id="S1.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span class="ltx_tag ltx_tag_subsection">1.5 </span>Results</h3>

<div id="S1.SS5.p1" class="ltx_para">
<p class="ltx_p">Iterating the generating function above finds the probability of establishment as a function of distance along the cline.
This is shown in figure <a href="#S1.F6" title="Figure&#xA0;6 &#x2023; 1.5 Results &#x2023; 1 Details of the demographic model &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
Note that the approximation <math xmlns="http://www.w3.org/1998/Math/MathML" id="S1.SS5.p1.m1" class="ltx_Math" display="inline" alttext="2s"><semantics><mrow><mn>2</mn><mo>&#x2062;</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">2s</annotation></semantics></math> divided by the variance in offspring number is pretty darn close.</p>
</div>
<div id="S1.F6" class="ltx_figure">
<table style="width:100%;">
<tr>
<td class="ltx_subgraphics"><object data="fig/prob-estab-62.svg" id="S1.F6.g1" class="ltx_graphics ltx_centering" width="270" height="270" alt=""/></td>
<td class="ltx_subgraphics"><object data="fig/prob-estab-500.svg" id="S1.F6.g2" class="ltx_graphics ltx_centering" width="270" height="270" alt=""/></td></tr>
</table>
<div class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure&#xA0;6: </span><span class="ltx_text" style="color:#990099;"><em class="ltx_emph ltx_font_script">(make this look better)</em></span> 
Probability of establishment, as a function of distance along and around an altitudinal cline, whise boundaries are marked by the green lines.
<span class="ltx_text ltx_font_bold">(A)</span> The parameters above; with cline width 62km; <span class="ltx_text ltx_font_bold">(B)</span> the same, except with cline width 500km.

</div>
</div>
</div>
</div>
<div id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section"><span class="ltx_tag ltx_tag_section">2 </span>Adaptation by mutation</h2>

<div id="S2.p1" class="ltx_para">
<p class="ltx_p"><em class="ltx_emph ltx_font_script" style="color:#990099;">(just a placeholder for now; to be merged in)</em></p>
</div>
<div id="S2.p2" class="ltx_para">
<p class="ltx_p">First, we&#x2019;d like to compute how difficult is it for the beneficial adaptation to arise by new mutation.
The rate of appearance of mutant alleles is a Poisson process,
and we can assume that each is successful or not independently,
so the time until the new mutant appears and fixes is exponentially distributed,
with rate equal to the mutation rate multiplied by the probability of establishment integrated over the population.
Referring to figure&#xA0;<a href="#S1.F6" title="Figure&#xA0;6 &#x2023; 1.5 Results &#x2023; 1 Details of the demographic model &#x2023; The molecular basis of parallel adaptation to highland climate in domesticated maize" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>,
we see that this is pretty close to ( (area of high altitude) <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p2.m1" class="ltx_Math" alttext="+" display="inline"><semantics><mo>+</mo><annotation encoding="application/x-tex">+</annotation></semantics></math> (<math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p2.m2" class="ltx_Math" alttext="1/2" display="inline"><semantics><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">1/2</annotation></semantics></math> area of altitudial gradient) ) <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p2.m3" class="ltx_Math" display="inline" alttext="\times"><semantics><mo>&#xD7;</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math> (population density) <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p2.m4" class="ltx_Math" display="inline" alttext="\times"><semantics><mo>&#xD7;</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math> (prob of establishment at high altitude).</p>
</div>
<div id="S2.p3" class="ltx_para">
<p class="ltx_p">Let <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p3.m1" class="ltx_Math" display="inline" alttext="A"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math> denote (area of high altitude) plus (<math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p3.m2" class="ltx_Math" display="inline" alttext="1/2"><semantics><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">1/2</annotation></semantics></math> area of altitudial gradient).
The population density <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p3.m3" class="ltx_Math" display="inline" alttext="\rho"><semantics><mi>&#x3C1;</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math> is roughly
0.5&#x2013;5 people per km<math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p3.m4" class="ltx_Math" alttext="{}^{2}" display="inline"><semantics><msup><mi/><mn>2</mn></msup><annotation encoding="application/x-tex">{}^{2}</annotation></semantics></math>
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p3.m5" class="ltx_Math" alttext="\times" display="inline"><semantics><mo>&#xD7;</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math> (0.5 ha field/person)
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p3.m6" class="ltx_Math" display="inline" alttext="\times"><semantics><mo>&#xD7;</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math> (2<math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p3.m7" class="ltx_Math" alttext="\times 10^{4}" display="inline"><semantics><mrow><mi/><mo>&#xD7;</mo><msup><mn>10</mn><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">\times 10^{4}</annotation></semantics></math> plants per field ha)
<math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p3.m8" class="ltx_Math" display="inline" alttext="="><semantics><mo>=</mo><annotation encoding="application/x-tex">=</annotation></semantics></math> (5000&#x2013;50000 plants per km<math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p3.m9" class="ltx_Math" alttext="{}^{2}" display="inline"><semantics><msup><mi/><mn>2</mn></msup><annotation encoding="application/x-tex">{}^{2}</annotation></semantics></math>).
As a check, the other set of numbers was
&#x201C;one village per 15 km&#x201D;; i.e.&#xA0;per square with 15km on a side,
which is 0.444 people per km<math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p3.m10" class="ltx_Math" alttext="{}^{2}" display="inline"><semantics><msup><mi/><mn>2</mn></msup><annotation encoding="application/x-tex">{}^{2}</annotation></semantics></math>.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p class="ltx_p">Since the probability of establishment at high altitude is approximately <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p4.m1" class="ltx_Math" alttext="2s_{b}/\xi^{2}" display="inline"><semantics><mrow><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>b</mi></msub></mrow><mo>/</mo><msup><mi>&#x3BE;</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">2s_{b}/\xi^{2}</annotation></semantics></math>,
with <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p4.m2" class="ltx_Math" display="inline" alttext="\xi^{2}"><semantics><msup><mi>&#x3BE;</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\xi^{2}</annotation></semantics></math> the variance in offspring number,
the rate of appearance is just</p>
<table id="S4.EGx7" class="ltx_equationgroup ltx_eqn_align">

<tr id="S2.Ex1" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.Ex1.m1" class="ltx_Math" alttext="\displaystyle\lambda_{\text{mut}}=2\rho As_{b}\mu/\xi^{2}." display="inline"><semantics><mrow><mrow><msub><mi>&#x3BB;</mi><mtext>mut</mtext></msub><mo>=</mo><mrow><mrow><mn>2</mn><mo>&#x2062;</mo><mi>&#x3C1;</mi><mo>&#x2062;</mo><mi>A</mi><mo>&#x2062;</mo><msub><mi>s</mi><mi>b</mi></msub><mo>&#x2062;</mo><mi>&#x3BC;</mi></mrow><mo>/</mo><msup><mi>&#x3BE;</mi><mn>2</mn></msup></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\displaystyle\lambda_{\text{mut}}=2\rho As_{b}\mu/\xi^{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/></tr>
</table>
<p class="ltx_p">At the values above, with <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p4.m3" class="ltx_Math" display="inline" alttext=".1\leq s_{b}\leq.001"><semantics><mrow><mn>.1</mn><mo>&#x2264;</mo><msub><mi>s</mi><mi>b</mi></msub><mo>&#x2264;</mo><mn>.001</mn></mrow><annotation encoding="application/x-tex">.1\leq s_{b}\leq.001</annotation></semantics></math>, the factor <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p4.m4" class="ltx_Math" display="inline" alttext="2\rho As_{b}/\xi^{2}"><semantics><mrow><mrow><mn>2</mn><mo>&#x2062;</mo><mi>&#x3C1;</mi><mo>&#x2062;</mo><mi>A</mi><mo>&#x2062;</mo><msub><mi>s</mi><mi>b</mi></msub></mrow><mo>/</mo><msup><mi>&#x3BE;</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">2\rho As_{b}/\xi^{2}</annotation></semantics></math> multiplying the mutation rate
varies between <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p4.m5" class="ltx_Math" alttext="10^{2}" display="inline"><semantics><msup><mn>10</mn><mn>2</mn></msup><annotation encoding="application/x-tex">10^{2}</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p4.m6" class="ltx_Math" alttext="10^{5}" display="inline"><semantics><msup><mn>10</mn><mn>5</mn></msup><annotation encoding="application/x-tex">10^{5}</annotation></semantics></math>,
implying that a single-base mutation with <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p4.m7" class="ltx_Math" alttext="\mu=10^{-8}" display="inline"><semantics><mrow><mi>&#x3BC;</mi><mo>=</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>8</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mu=10^{-8}</annotation></semantics></math> would have to wait between <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p4.m8" class="ltx_Math" alttext="10^{4}" display="inline"><semantics><msup><mn>10</mn><mn>4</mn></msup><annotation encoding="application/x-tex">10^{4}</annotation></semantics></math> and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p4.m9" class="ltx_Math" display="inline" alttext="10^{6}"><semantics><msup><mn>10</mn><mn>6</mn></msup><annotation encoding="application/x-tex">10^{6}</annotation></semantics></math> generations to fix,
but a mutation with a larger target, say <math xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p4.m10" class="ltx_Math" alttext="\mu=10^{-5}" display="inline"><semantics><mrow><mi>&#x3BC;</mi><mo>=</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\mu=10^{-5}</annotation></semantics></math>, would fix in tens to thousands of generations, depending on the selection coefficient.</p>
</div>
</div>
<div id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section"><span class="ltx_tag ltx_tag_section">3 </span>Adaptation by migration</h2>

<div id="S3.p1" class="ltx_para">
<p class="ltx_p">As we show in the theory paper,
the rate of adaptation by diffusive migration is roughly</p>
<table id="S4.EGx8" class="ltx_equationgroup ltx_eqn_align">

<tr id="S3.Ex2" class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"/>
<td class="ltx_td ltx_align_right"><math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.Ex2.m1" class="ltx_Math" alttext="\displaystyle\lambda_{\text{mig}}=\rho\frac{s_{b}\sqrt{2s_{m}}}{2\xi^{2}}\exp%&#10;\left(-\frac{\sqrt{2s_{m}}R}{\sigma}\right)." display="inline"><semantics><mrow><mrow><msub><mi>&#x3BB;</mi><mtext>mig</mtext></msub><mo>=</mo><mrow><mi>&#x3C1;</mi><mo>&#x2062;</mo><mstyle displaystyle="true"><mfrac><mrow><msub><mi>s</mi><mi>b</mi></msub><mo>&#x2062;</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>m</mi></msub></mrow></msqrt></mrow><mrow><mn>2</mn><mo>&#x2062;</mo><msup><mi>&#x3BE;</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mo>&#x2062;</mo><mrow><mi>exp</mi><mo>&#x2061;</mo><mrow><mo>(</mo><mrow><mo>-</mo><mstyle displaystyle="true"><mfrac><mrow><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>m</mi></msub></mrow></msqrt><mo>&#x2062;</mo><mi>R</mi></mrow><mi>&#x3C3;</mi></mfrac></mstyle></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo>.</mo></mrow><annotation encoding="application/x-tex">\displaystyle\lambda_{\text{mig}}=\rho\frac{s_{b}\sqrt{2s_{m}}}{2\xi^{2}}\exp%
\left(-\frac{\sqrt{2s_{m}}R}{\sigma}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_pad"/></tr>
</table>
<p class="ltx_p">We can talk about this more and give some simulations.
But for now, let&#x2019;s interpret.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p class="ltx_p">First note that for <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m1" class="ltx_Math" alttext="10^{-1}\leq s_{m}\leq 10^{-4}" display="inline"><semantics><mrow><msup><mn>10</mn><mrow><mo>-</mo><mn>1</mn></mrow></msup><mo>&#x2264;</mo><msub><mi>s</mi><mi>m</mi></msub><mo>&#x2264;</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">10^{-1}\leq s_{m}\leq 10^{-4}</annotation></semantics></math>, the value <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m2" class="ltx_Math" alttext="1/\sqrt{2s_{m}}" display="inline"><semantics><mrow><mn>1</mn><mo>/</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>m</mi></msub></mrow></msqrt></mrow><annotation encoding="application/x-tex">1/\sqrt{2s_{m}}</annotation></semantics></math> is between 2 and 70 &#x2013;
so the exponential decay of the chance of migration fallws off on a scale of between 2 and 70 times the dispersal distance.
Above we have estimated the dispersal distance to be <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m3" class="ltx_Math" alttext="\sigma\approx 2" display="inline"><semantics><mrow><mi>&#x3C3;</mi><mo>&#x2248;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\sigma\approx 2</annotation></semantics></math> km,
and far below the mean distance <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m4" class="ltx_Math" alttext="\sigma_{s}" display="inline"><semantics><msub><mi>&#x3C3;</mi><mi>s</mi></msub><annotation encoding="application/x-tex">\sigma_{s}</annotation></semantics></math> to the field that a farmer replants seed from, when this happens,
which we have as <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m5" class="ltx_Math" alttext="\sigma_{s}=50" display="inline"><semantics><mrow><msub><mi>&#x3C3;</mi><mi>s</mi></msub><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">\sigma_{s}=50</annotation></semantics></math> km.
Taking <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m6" class="ltx_Math" alttext="\sigma=2" display="inline"><semantics><mrow><mi>&#x3C3;</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\sigma=2</annotation></semantics></math> km, we have that <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m7" class="ltx_Math" alttext="4\leq\sigma/\sqrt{2s_{m}}\leq 150" display="inline"><semantics><mrow><mn>4</mn><mo>&#x2264;</mo><mrow><mi>&#x3C3;</mi><mo>/</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>m</mi></msub></mrow></msqrt></mrow><mo>&#x2264;</mo><mn>150</mn></mrow><annotation encoding="application/x-tex">4\leq\sigma/\sqrt{2s_{m}}\leq 150</annotation></semantics></math> km.
A very conservative upper bound might be <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m8" class="ltx_Math" display="inline" alttext="\sigma\leq\sigma_{s}/20"><semantics><mrow><mi>&#x3C3;</mi><mo>&#x2264;</mo><mrow><msub><mi>&#x3C3;</mi><mi>s</mi></msub><mo>/</mo><mn>20</mn></mrow></mrow><annotation encoding="application/x-tex">\sigma\leq\sigma_{s}/20</annotation></semantics></math> (if farmers replaced 10% of their seed with long-distance seed every year).
At this upper bound, we would have <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m9" class="ltx_Math" alttext="5\leq\sigma/\sqrt{2s_{m}}\leq 175" display="inline"><semantics><mrow><mn>5</mn><mo>&#x2264;</mo><mrow><mi>&#x3C3;</mi><mo>/</mo><msqrt><mrow><mn>2</mn><mo>&#x2062;</mo><msub><mi>s</mi><mi>m</mi></msub></mrow></msqrt></mrow><mo>&#x2264;</mo><mn>175</mn></mrow><annotation encoding="application/x-tex">5\leq\sigma/\sqrt{2s_{m}}\leq 175</annotation></semantics></math> km,
which is not very different.
This makes the exponential term very small since <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p2.m10" class="ltx_Math" alttext="R" display="inline"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math> is on the order of 1,000 km.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p class="ltx_p">Taking <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p3.m1" class="ltx_Math" display="inline" alttext="\sigma=2"><semantics><mrow><mi>&#x3C3;</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\sigma=2</annotation></semantics></math> km
and <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p3.m2" class="ltx_Math" alttext="s_{m}=10^{-4}" display="inline"><semantics><mrow><msub><mi>s</mi><mi>m</mi></msub><mo>=</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">s_{m}=10^{-4}</annotation></semantics></math> (very weak selection in the lowlands), then for <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p3.m3" class="ltx_Math" display="inline" alttext="R=1,000"><semantics><mrow><mi>R</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mn>000</mn></mrow></mrow><annotation encoding="application/x-tex">R=1,000</annotation></semantics></math> km, the migration rate is <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p3.m4" class="ltx_Math" alttext="\lambda_{\text{mig}}\leq 10^{-5}" display="inline"><semantics><mrow><msub><mi>&#x3BB;</mi><mtext>mig</mtext></msub><mo>&#x2264;</mo><msup><mn>10</mn><mrow><mo>-</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\lambda_{\text{mig}}\leq 10^{-5}</annotation></semantics></math>,
i.e.&#xA0;it would take on the order of 100,000 generations (years) to get a successful migrant only 1,000 km away,
under this model of undirected, diffusive dispersal.
For larger <math xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p3.m5" class="ltx_Math" alttext="s_{m}" display="inline"><semantics><msub><mi>s</mi><mi>m</mi></msub><annotation encoding="application/x-tex">s_{m}</annotation></semantics></math>, the migration rate is much smaller.</p>
</div>
</div>
<div id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section"><span class="ltx_tag ltx_tag_section">4 </span>Conclusion</h2>

<div id="S4.p1" class="ltx_para">
<p class="ltx_p">It seems unlikely that any alleles that are adaptive in the highlands and deleterious at all in the lowlands
would have transited central America by undirected (diffusive) sharing of seed.
The conclusions could change if we drastically underestimate the rate of very long distance sharing of seed,
e.g.&#xA0;if sharing across hundreds of kilometers was common at some point.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p class="ltx_p">Both calculations are very pessimistic about the chance of shared single-base changes through either migration or independent mutation.
However, independent mutations could be expected in kilobase-size targets,
suggesting there might be signal for genes that share adaptive changes.</p>
</div>
</div>
</div>
</div>
<div class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Oct 20 10:22:29 2013 by <a href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"/></a></div></div>
</div>
</body>
</html>
